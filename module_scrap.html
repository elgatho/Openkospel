Thanks to IscreaMan for scraping page from internet module
<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"/>
    <meta http-equiv="Pragma" content="no-cache"/>
    <meta http-equiv="Expires" content="0"/>
    <link rel="stylesheet" href="css/themes/kospel.min.css" />
    <link rel="stylesheet" href="css/themes/jquery.mobile.icons.min.css" />
    <link rel="stylesheet" href="js/jquery-mobile/jquery.mobile.structure-1.4.5.min.css" />
    <script src="js/jquery/external/jquery/jquery.js"></script>
    <script src="js/jquery-mobile/jquery.mobile-1.4.5.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
  </head>
<body>
  <!-- Start of first page: #one -->
  <div data-role="page" id="start">
    <div data-role="header">
      <h1><a id="m_start__title" href="#about" onclick="showLoadingSpinner()" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">KOSPEL</a></h1>
      <a onclick="window.location.href = window.location.protocol + '//' + window.location.hostname + '/mdevs';" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" >&nbsp;</a>
      <a onclick="showLoadingSpinner()" href="#m_start__mode" class="ui-btn ui-shadow ui-corner-all ui-icon-bars ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
    </div>

    <div role="main" class="ui-body" id="win_index">
      <div><?xml version="1.0" standalone="yes"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<?xml version="1.0" encoding="UTF-8" standalone="no"??>
<html><body><svg xmlns:osb="http://www.openswatchbook.org/uri/2009/osb" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:cc="http://creativecommons.org/ns#" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" viewbox="0 0 1700.7874 2200" id="svg2" version="1.1" inkscape:version="0.92.2 (5c3e80d, 2017-08-06)" sodipodi:docname="master.svg"><defs id="defs4"><lineargradient id="linearGradient5609" osb:paint="gradient"><stop style="stop-color:#000000;stop-opacity:1;" offset="0" id="stop5611"/><stop style="stop-color:#000000;stop-opacity:0;" offset="1" id="stop5613"/></lineargradient><style id="style2" type="text/css"><![CDATA[<![CDATA[
    .domek_s0 {stroke:#262626;stroke-width:5.82186}
    .domek_f1 {fill:none}
    .domek_f2 {fill:#262626}
    .domek_f0 {fill:#EF7B00;fill-rule:nonzero}
   ]]]]><![CDATA[>]]></style><style id="style2-8" type="text/css"><![CDATA[<![CDATA[
    .zbiornik_s0 {stroke:#262626;stroke-width:5.15621}
    .zbiornik_f2 {fill:none}
    .zbiornik_f1 {fill:#262626}
    .zbiornik_f0 {fill:#2D4191;fill-rule:nonzero}
   ]]]]><![CDATA[>]]></style><style id="style2-2" type="text/css"><![CDATA[<![CDATA[
    .termometr_f0 {fill:#434242;fill-rule:nonzero}
   ]]]]><![CDATA[>]]></style></defs><namedview id="base" pagecolor="#ffffff" bordercolor="#666666" borderopacity="1.0" inkscape:pageopacity="0.0" inkscape:pageshadow="2" inkscape:zoom="0.50000004" inkscape:cx="1205.3552" inkscape:cy="167.41471" inkscape:document-units="px" inkscape:current-layer="svg2" showgrid="true" inkscape:snap-text-baseline="true" inkscape:window-width="1920" inkscape:window-height="1018" inkscape:window-x="-8" inkscape:window-y="-8" inkscape:window-maximized="1" objecttolerance="10000" guidetolerance="10000" inkscape:snap-grids="true" units="mm"><grid type="xygrid" id="grid3335" dotted="true" spacingx="10" spacingy="9.9999998"/></namedview><metadata id="metadata7"><rdf><work rdf:about=""><format>image/svg+xml</format><type rdf:resource="http://purl.org/dc/dcmitype/StillImage"/><title/></work></rdf></metadata><g inkscape:label="Layer 1" inkscape:groupmode="layer" id="layer1" transform="translate(0,1137.1098)"><rect id="rect3341" width="640" height="520" x="560" y="-518.98962" style="fill:none;stroke:none;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1"/><rect style="fill:none;stroke:none;stroke-width:1;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="rect5587" width="360" height="440" x="340" y="-218.9895"/><flowroot xml:space="preserve" id="flowRoot912" style="font-style:normal;font-weight:normal;font-size:40px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none"><flowregion id="flowRegion914"><rect id="rect916" width="882.12195" height="81.250046" x="-250" y="1375.9843"/></flowregion><flowpara id="flowPara918"/></flowroot></g><g id="error_" style="fill:#ececec" transform="translate(0,-338.23801)"><polygon transform="matrix(2.7487473,0,0,2.6430262,24.738728,1533.6655)" points="75,121 75,113 61,113 61,85 73,85 73,76 61,76 61,52 74,52 74,43 51,43 51,121 " id="polygon9"/><path d="m 305.11095,1708.1052 c 0,0 0,0 -2.74874,0 -8.24625,0 -16.49249,5.2861 -21.98998,13.2152 l -2.74875,-10.5721 h -24.73873 v 142.7234 h 27.48748 v -95.149 c 0,-21.1442 5.49749,-26.4302 24.73872,-26.4302 v 0 z" id="path20" inkscape:connector-curvature="0"/><path d="m 371.08089,1708.1052 c 0,0 -2.74875,0 -2.74875,0 -10.99499,0 -16.49248,5.2861 -24.73873,13.2152 v -10.5721 h -24.73872 v 142.7234 h 24.73872 v -95.149 c 0,-21.1442 8.24625,-26.4302 27.48748,-26.4302 v 0 z" id="path22" inkscape:connector-curvature="0"/></g><path id="radiator_" style="opacity:1;fill:#ececec" d="m 223.82657,91.25823 h 11.04407 c 7.36272,0 11.04408,2.98777 11.04408,8.96331 v 188.22943 c 0,5.97554 -3.68136,8.96331 -11.04408,8.96331 h -11.04407 c -7.36272,0 -11.04408,-2.98777 -11.04408,-8.96331 V 100.22154 c 0,-5.97554 3.68136,-8.96331 11.04408,-8.96331 z m 47.85765,0 h 11.04408 c 7.36271,0 11.04407,2.98777 11.04407,8.96331 v 188.22943 c 0,5.97554 -3.68136,8.96331 -11.04407,8.96331 h -11.04408 c -7.36271,0 -11.04407,-2.98777 -11.04407,-8.96331 V 100.22154 c 0,-5.97554 3.68136,-8.96331 11.04407,-8.96331 z m 44.1763,0 h 14.72543 c 3.68136,0 11.04407,2.98777 11.04407,8.96331 v 0 l 29.45087,11.95108 v 11.95107 l -29.45087,11.95108 v 152.3762 c 0,5.97554 -7.36271,8.96331 -11.04407,8.96331 h -14.72543 c -3.68136,0 -11.04408,-2.98777 -11.04408,-8.96331 V 100.22154 c 0,-5.97554 7.36272,-8.96331 11.04408,-8.96331 z m -139.89161,0 h 11.04408 c 7.36271,0 14.72543,2.98777 14.72543,8.96331 v 188.22943 c 0,5.97554 -7.36272,8.96331 -14.72543,8.96331 h -11.04408 c -7.36271,0 -11.04407,-2.98777 -11.04407,-8.96331 V 100.22154 c 0,-5.97554 3.68136,-8.96331 11.04407,-8.96331 z" inkscape:connector-curvature="0"/><g id="tap_" style="fill:#ececec" transform="translate(0,104.72998)"><path d="m 291.27855,305.94505 c 33.25097,0 59.85175,16.27548 79.80234,37.97611 l -39.90117,16.27548 C 324.52952,343.92116 304.57894,338.496 291.27855,338.496 h -46.55137 v 97.65287 H 164.92484 V 338.496 316.79537 c 0,-5.42516 6.6502,-10.85032 13.30039,-10.85032 h 66.50195 z" id="path25" inkscape:connector-curvature="0"/><path d="m 164.92484,295.09473 h 79.80234 v -27.1258 l 46.55137,-16.27547 c 19.95058,0 19.95058,-10.85032 13.30039,-21.70064 -39.90117,10.85032 -79.80234,21.70064 -126.35371,27.1258 -13.30039,0 -13.30039,5.42516 -13.30039,10.85031 z" id="path27" inkscape:connector-curvature="0"/><path d="m 351.1303,371.04696 c 6.6502,5.42516 13.30039,10.85032 19.95059,21.70064 0,5.42516 0,5.42516 0,10.85031 0,10.85032 -6.6502,16.27548 -19.95059,16.27548 -6.65019,0 -19.95058,-5.42516 -19.95058,-16.27548 0,-5.42515 6.65019,-5.42515 6.65019,-10.85031 6.6502,-10.85032 6.6502,-16.27548 13.30039,-21.70064 z" id="path29" inkscape:connector-curvature="0"/></g><path style="fill:#ececec" id="clock_" d="m 268.00286,578.1866 c 26.88992,0 53.77984,13.44485 71.70645,31.3713 17.92662,17.92645 31.37158,44.8161 31.37158,71.70575 0,26.8898 -13.44496,53.7796 -31.37158,71.70615 -17.92661,17.9266 -44.81653,31.3716 -71.70645,31.3716 -26.88992,0 -53.77983,-13.445 -71.70645,-31.3716 -17.92661,-17.92655 -31.37157,-44.81635 -31.37157,-71.70615 0,-26.88965 13.44496,-53.7793 31.37157,-71.70575 17.92662,-17.92645 44.81653,-31.3713 71.70645,-31.3713 z m 58.2615,94.11385 c 4.48165,0 8.9633,4.48165 8.9633,8.9632 0,4.4817 -4.48165,8.96325 -8.9633,8.96325 h -58.2615 c -4.48165,0 -8.9633,-4.48155 -8.9633,-8.96325 v -76.1874 c 0,-4.48155 4.48165,-4.48155 8.9633,-4.48155 4.48166,0 8.96331,0 8.96331,4.48155 v 67.2242 z m 4.48165,-53.77935 c -17.92661,-17.9264 -40.33488,-26.88965 -62.74315,-26.88965 -22.40826,0 -44.81653,8.96325 -62.74314,26.88965 -17.92661,17.92645 -26.88992,40.33455 -26.88992,62.74255 0,22.4081 8.96331,44.8163 26.88992,62.7429 17.92661,17.92655 40.33488,26.88985 62.74314,26.88985 22.40827,0 44.81654,-8.9633 62.74315,-26.88985 17.92661,-17.9266 26.88992,-40.3348 26.88992,-62.7429 0,-22.408 -8.96331,-44.8161 -26.88992,-62.74255 z" inkscape:connector-curvature="0"/><path style="opacity:0;fill:#ececec" inkscape:connector-curvature="0" id="glass_" d="m 164.92484,1572.5402 h 206.15605 l -87.21987,106.8262 v 74.9659 l 55.50355,18.7415 v 5.6224 H 204.57023 v -5.6224 l 55.50355,-18.7415 v -74.9659 z"/><g id="turbo_" inkscape:label="#turbo_" style="fill:#ececec" transform="translate(0,-15.27002)"><path d="m 290.91584,1183.9197 a 21.768922,21.756389 0 0 1 -21.76893,21.7564 21.768922,21.756389 0 0 1 -21.76892,-21.7564 21.768922,21.756389 0 0 1 21.76892,-21.7564 21.768922,21.756389 0 0 1 21.76893,21.7564 z" id="circle7" inkscape:connector-curvature="0"/><path d="m 267.9985,1101.1984 24.44645,30.5404 -17.15195,36.2546 -7.2945,-1.7734 z" id="path76" inkscape:connector-curvature="0"/><path d="m 350.40674,1183.3621 -30.55808,24.6294 -36.47255,-17.3391 1.77434,-7.2903 z" id="polygon11" inkscape:connector-curvature="0"/><path d="m 267.9985,1265.7229 -24.44647,-30.5405 17.15195,-36.4515 7.29452,1.7733 z" id="polygon13" inkscape:connector-curvature="0"/><path d="m 185.59025,1183.3621 30.55808,-24.4324 36.47254,17.1421 -1.77433,7.2903 z" id="polygon15" inkscape:connector-curvature="0"/><path d="m 326.15742,1125.2367 -4.14013,38.816 -37.85258,13.5954 -4.14013,-6.3051 z" id="polygon17" inkscape:connector-curvature="0"/><path d="m 326.15742,1241.4876 -38.83834,-4.1378 -13.60327,-37.8308 6.30877,-4.1377 z" id="polygon19" inkscape:connector-curvature="0"/><path d="m 209.83956,1241.4876 4.14013,-38.816 37.85259,-13.5954 4.14013,6.3051 z" id="polygon21" inkscape:connector-curvature="0"/><path d="m 209.83956,1125.2367 38.83834,4.1377 13.60327,37.8308 -6.30876,4.1378 z" id="polygon23" inkscape:connector-curvature="0"/><path inkscape:connector-curvature="0" id="path44" d="m 267.80134,1080.7067 c -56.58173,0 -102.51743,45.9092 -102.51743,102.6554 0,56.7462 45.9357,102.8525 102.51743,102.8525 56.97604,0 102.91174,-46.1063 102.91174,-102.8525 0,-56.7462 -45.9357,-102.6554 -102.91174,-102.6554 z m 0.19716,184.8192 c -45.34425,0 -82.2111,-36.6486 -82.2111,-82.1638 0,-45.3181 36.86685,-82.1637 82.2111,-82.1637 45.34425,0 82.21109,36.8456 82.21109,82.1637 0,45.5152 -36.86684,82.1638 -82.21109,82.1638 z"/></g><g id="pump_" transform="matrix(0.28777264,0,0,0.28777264,164.92484,1014.5684)" style="fill:#ececec"><path d="m 358.19258,-670.38524 c 93.44154,0 186.88309,46.72077 249.17745,109.01513 62.29436,62.29436 109.01513,155.73591 109.01513,249.17745 0,93.44154 -46.72077,186.88308 -109.01513,249.177447 C 545.07567,-0.72085151 451.63412,45.99992 358.19258,45.99992 264.75104,45.99992 171.3095,-0.72085151 109.01513,-63.015213 46.720771,-125.30958 0,-218.75112 0,-312.19266 0,-405.6342 46.720771,-499.07575 109.01513,-561.37011 171.3095,-623.66447 264.75104,-670.38524 358.19258,-670.38524 Z m -140.16231,124.58872 404.91335,233.60386 -404.91335,218.030266 z m 358.19258,15.57359 c -62.29436,-62.29436 -140.16232,-93.44154 -218.03027,-93.44154 -77.86795,0 -155.7359,31.14718 -218.03027,93.44154 -62.294358,62.29436 -93.441539,140.16232 -93.441539,218.03027 0,77.86795 31.147181,155.7359 93.441539,218.030266 62.29437,62.294362 140.16232,93.44154249 218.03027,93.44154249 77.86795,0 155.73591,-31.14718049 218.03027,-93.44154249 62.29436,-62.294366 93.44154,-140.162316 93.44154,-218.030266 0,-77.86795 -31.14718,-155.73591 -93.44154,-218.03027 z" id="path45" inkscape:connector-curvature="0"/></g><g id="hand_" transform="translate(6.5284583,-55.82495)" style="opacity:0;fill:#ececec"><path d="m 236.5005,1755.8745 c -1.35191,1.5947 -50.0192,-36.6771 -55.42669,-41.4611 -14.87044,-7.9734 -16.22235,7.9732 -5.40737,17.5413 25.68543,23.9198 48.66717,51.0292 75.70463,73.3544 18.92615,12.7572 31.09291,23.9199 55.42656,25.5146 14.87057,1.5947 22.98174,1.5947 32.44482,3.1892 5.40749,0 9.46307,3.1894 12.16675,-6.3785 6.7594,-20.7307 16.22248,-60.5973 12.16689,-78.1384 0,-3.1894 -5.40749,-4.7841 -6.75939,-7.9734 -2.70369,-11.1626 -5.4075,-25.5145 -10.81486,-38.2718 -5.40749,-12.7574 -12.16689,-27.1093 -18.92615,-35.0826 -6.7594,-6.3786 -9.46308,-9.568 -25.68556,-22.3253 -10.81498,-6.3786 -16.22247,-17.5412 -20.27806,-14.3519 -9.46307,14.3519 2.70381,30.2986 16.22248,41.4612 8.11117,6.3786 21.62984,27.1092 2.70368,15.9465 -14.87057,-9.5679 -25.68542,-15.9465 -41.9079,-27.1091 -12.16676,-9.568 -31.09291,-20.7306 -44.61158,-28.7039 -21.62996,-12.7573 -28.38923,3.1893 -13.51879,14.3519 8.1113,7.9733 55.42669,41.4611 59.48228,46.2452 8.11117,11.1627 -13.51867,-4.7841 -13.51867,-4.7841 l -41.90789,-30.2985 c -10.81499,-7.9733 -35.14863,-27.1092 -40.55612,-14.3519 -5.4075,12.7573 14.87057,23.9199 28.38923,35.0825 14.87057,11.1626 25.68555,20.7306 40.55612,31.8932 25.68542,19.136 16.22235,19.136 -6.7594,0 -14.87057,-7.9732 -25.68555,-19.1359 -39.20421,-28.7038 -6.75927,-4.7841 -22.98174,-19.136 -27.03733,-7.9734 -4.05559,9.568 4.05559,17.5413 17.57425,28.704 2.70381,1.5947 21.62997,17.5413 36.50053,30.2984 13.51867,11.1627 24.33352,20.7308 22.98175,22.3253 z" id="path43" inkscape:connector-curvature="0"/></g><g id="g4798" inkscape:label="#tray" transform="matrix(0.9,0,0,0.9,102.71276,36.61755)"><g transform="translate(0,13.307129)" id="g4765"><g id="tray" transform="translate(0,161.42285)"><g transform="matrix(2.18265,0,0,1.9256169,647.478,891.6311)" id="g5816" style="clip-rule:evenodd;fill-rule:evenodd;image-rendering:optimizeQuality;shape-rendering:geometricPrecision;text-rendering:geometricPrecision"><g id="Warstwa_x0020_1-9" transform="translate(0,-174.75624)"><metadata id="CorelCorpID_0Corel-Layer-7"/><path class="zbiornik_f0" d="M 55.772261,587 H 267.70685 c 15.33738,0 29.28044,-6.27438 39.04059,-16.73168 9.76014,-9.76014 16.03452,-23.70321 16.03452,-39.04058 v -9.76015 h 25.09752 V 497.76438 H 322.78196 V 267.00665 h 25.09752 v -24.40036 h -25.09752 v -9.063 c 0,-15.33737 -6.27438,-29.28043 -16.03452,-39.73773 -9.76015,-9.76015 -23.70321,-16.03453 -39.04059,-16.03453 H 55.772261 c -15.337371,0 -29.280437,6.27438 -39.737736,16.03453 C 6.2743794,204.26286 0,218.20592 0,233.54329 v 297.68445 c 0,15.33737 6.2743794,29.28044 16.034525,39.04058 C 26.491824,580.72562 40.43489,587 55.772261,587 Z M 291.41007,531.22774 c 0,13.24591 -10.4573,24.40036 -23.70322,24.40036 H 55.772261 c -13.943065,0 -24.400364,-11.15445 -24.400364,-24.40036 V 233.54329 c 0,-13.94306 10.457299,-24.40036 24.400364,-24.40036 H 267.70685 c 13.24592,0 23.70322,10.4573 23.70322,24.40036 z" id="path17" inkscape:connector-curvature="0" style="fill:#2d4191;fill-rule:nonzero;stroke-width:0.69715327"/><line class="zbiornik_f2 zbiornik_s0" x1="46.70927" y1="387.45102" x2="278.8613" y2="387.45102" id="line25" style="fill:none;stroke:#262626;stroke-width:3.59466863"/></g></g><text inkscape:label="#temp_boil_sett_" id="temp_boil_sett_" y="1595.8273" x="998.99286" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;line-height:0%;font-family:Arial;-inkscape-font-specification:'Arial, Normal';text-align:start;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:start;fill:#004693;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" xml:space="preserve"><tspan style="font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;font-size:236.3547821px;line-height:125%;font-family:Arial;-inkscape-font-specification:'Arial, Bold';text-align:center;writing-mode:lr-tb;text-anchor:middle;fill:#004693;fill-opacity:1" y="1595.8273" x="998.99286" id="temp_zas" sodipodi:role="line">--&#xB0;</tspan></text><text inkscape:label="#temp_boil_" id="temp_boil_" y="1204.7821" x="1015.155" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;line-height:0%;font-family:Arial;-inkscape-font-specification:'Arial, Normal';text-align:start;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:start;fill:#434343;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" xml:space="preserve"><tspan style="font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;font-size:138.84609985px;line-height:125%;font-family:Arial;-inkscape-font-specification:'Arial, Bold';text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#434343;fill-opacity:1" y="1204.7821" x="1015.155" id="temp_zas_nas" sodipodi:role="line">--&#xB0;</tspan></text><path id="temp_zas_konf_" d="m 825.34698,1128.3517 -21.2127,-21.074 11.1562,-11.3233 21.3699,21.074 z m -11.942,44.8214 -29.8549,0.1573 -0.1571,-15.8841 30.012,-0.1573 z m 23.2554,40.2607 -21.0556,21.3884 -11.3135,-11.3233 21.0557,-21.2312 z m 44.9395,12.1096 v 29.8809 h -15.8702 l -0.1572,-29.8809 z m 40.0685,-23.2757 21.3698,21.074 -11.3134,11.3232 -21.2127,-21.0739 z m 12.099,-44.9787 29.855,-0.1573 0.1571,16.0414 h -30.0121 z m -23.2553,-40.2606 21.0555,-21.2313 11.3134,11.1661 -21.0555,21.2312 z m -44.9396,-11.9524 -0.1571,-30.0383 h 16.0274 l 0.1571,29.881 z m 8.0137,10.5369 c 27.3408,0 49.6534,22.1749 49.6534,49.6968 0,27.3647 -22.3126,49.6967 -49.6534,49.6967 -27.3408,0 -49.6534,-22.332 -49.6534,-49.6967 0,-27.5219 22.3126,-49.6968 49.6534,-49.6968 z" class="fil0" style="fill:#434343;clip-rule:evenodd;opacity:0;fill-rule:evenodd;stroke-width:0.15719964;image-rendering:optimizeQuality;shape-rendering:geometricPrecision;text-rendering:geometricPrecision" inkscape:connector-curvature="0"/><polygon id="temp_zas_pzam_" points="-3294,2512 -3159,2481 -3090,2781 -2870,2908 -2870,2652 -3093,2444 -2999,2342 -2870,2462 -2871,2257 -2733,2257 -2733,2465 -2601,2342 -2507,2444 -2732,2654 -2732,2907 -2510,2779 -2442,2482 -2307,2513 -2347,2684 -2169,2581 -2100,2701 -2280,2805 -2109,2857 -2149,2989 -2443,2899 -2663,3027 -2441,3154 -2149,3065 -2109,3197 -2277,3249 -2099,3351 -2168,3471 -2348,3367 -2308,3542 -2442,3573 -2512,3273 -2732,3146 -2731,3402 -2508,3610 -2602,3711 -2731,3591 -2731,3797 -2868,3797 -2869,3589 -3000,3711 -3094,3610 -2869,3400 -2869,3146 -3091,3275 -3160,3572 -3294,3541 -3255,3370 -3432,3473 -3502,3353 -3321,3249 -3493,3196 -3453,3064 -3158,3154 -2939,3027 -3161,2899 -3452,2988 -3492,2856 -3324,2805 -3502,2703 -3434,2583 -3253,2687 " class="fil1" style="clip-rule:evenodd;opacity:0;fill-rule:evenodd;image-rendering:optimizeQuality;shape-rendering:geometricPrecision;text-rendering:geometricPrecision" transform="matrix(0.12857202,0,0,0.11713412,1233.6522,810.66602)"/><g transform="matrix(65.527444,0,0,60.456252,-7270.3377,-5842.8309)" style="opacity:0;fill:#000000" id="temp_zas_ekon_"><metadata id="metadata98-0"/><path inkscape:connector-curvature="0" style="fill:#434343;" id="path100-3" d="m 125.646,116.738 c -0.1781,0.2715 -0.439,0.4741 -0.7369,0.5829 -0.2905,0.1062 -0.6165,0.1232 -0.9356,0.0284 -0.395,-0.1174 -0.7051,-0.384 -0.8869,-0.7198 -0.1817,-0.3356 -0.2355,-0.7407 -0.1182,-1.1353 0.0928,-0.3124 0.2789,-0.5715 0.5187,-0.7562 0.2461,-0.1895 0.5492,-0.3007 0.8662,-0.3103 0.0446,-0.001 0.0817,0.0339 0.0829,0.0785 9e-4,0.0325 -0.0175,0.061 -0.0449,0.0746 v 0 c -0.1443,0.0711 -0.2739,0.1716 -0.3791,0.2962 -0.1011,0.1197 -0.1798,0.2619 -0.2273,0.4216 -0.0923,0.3106 -0.05,0.6295 0.093,0.8936 0.1429,0.2638 0.3866,0.4733 0.6968,0.5655 0.1657,0.0493 0.3336,0.0602 0.4942,0.0381 0.1666,-0.0229 0.3257,-0.0818 0.4664,-0.1704 0.0377,-0.0238 0.0876,-0.0124 0.1114,0.0253 0.0173,0.0275 0.0159,0.0616 -8e-4,0.0872 z" class="fil0"/></g></g></g></g><g id="temp" transform="translate(172,29.84406)"><g transform="matrix(10.526364,0,0,10.526364,935.56494,-17.556822)" id="g5951" style="clip-rule:evenodd;fill-rule:evenodd;image-rendering:optimizeQuality;shape-rendering:geometricPrecision;text-rendering:geometricPrecision"><g id="Warstwa_x0020_1-1" transform="matrix(0.27273979,0,0,0.27273979,0,0.08987073)"><path class="termometr_f0" d="m 15,0 c 2,0 4,1 6,3 v 0 c 2,1 3,4 3,6 v 26 c 1,1 3,2 4,4 1,2 1,4 1,7 0,4 -1,8 -4,10 -3,3 -6,4 -10,4 C 11,60 7,59 4,56 2,54 0,50 0,46 0,43 1,41 2,39 3,37 4,36 5,35 V 9 C 5,7 6,4 8,3 v 0 c 2,-2 4,-3 7,-3 z m 2,24 v 15 c 3,1 5,4 5,7 0,4 -3,7 -7,7 -4,0 -8,-3 -8,-7 0,-3 3,-6 5,-7 V 24 Z M 18,6 C 17,5 16,4 15,4 13,4 12,5 11,6 10,7 10,8 10,9 V 37 H 9 c -2,1 -3,3 -4,4 0,1 -1,3 -1,5 0,3 1,5 3,7 v 0 c 2,2 5,3 8,3 2,0 5,-1 7,-3 2,-2 3,-4 3,-7 0,-2 0,-4 -1,-5 -1,-1 -2,-3 -3,-4 H 20 V 9 C 20,8 19,7 18,6 Z" id="path7-4" inkscape:connector-curvature="0" style="fill:#434242;fill-rule:nonzero"/></g></g><text inkscape:label="#temp_outside_" id="temp_outside_" y="153.98416" x="1028" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;font-size:15.97200012px;line-height:0%;font-family:Arial;-inkscape-font-specification:'Arial, Normal';text-align:start;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:start;fill:#434343;fill-opacity:1;stroke:none;stroke-width:1.33099997px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" xml:space="preserve"><tspan style="font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;font-size:160.76916504px;line-height:125%;font-family:Arial;-inkscape-font-specification:'Arial, Bold';text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#434343;fill-opacity:1;stroke-width:1.33099997px" y="153.98416" x="1028" id="temp_out" sodipodi:role="line">-00.0&#xB0;</tspan></text></g><g id="home" transform="matrix(0.9,0,0,0.9,100.56736,185.99687)"><g id="g948" inkscape:label="#home"><g style="clip-rule:evenodd;fill-rule:evenodd;image-rendering:optimizeQuality;shape-rendering:geometricPrecision;text-rendering:geometricPrecision" id="g5753" transform="matrix(1.7237296,0,0,1.7237297,548.3786,-23.62108)"><g transform="translate(0,-259.48759)" id="Warstwa_x0020_1"><metadata id="CorelCorpID_0Corel-Layer"/><path style="fill:#ef7b00;fill-rule:nonzero;stroke-width:0.65829766" inkscape:connector-curvature="0" id="path7" d="M 0,510.62081 262.00246,260.4677 530.5879,509.30421 v 50.68892 l -23.69871,-22.38212 v 180.37356 c 0,12.50765 -5.26638,24.35701 -14.48255,32.91488 -8.55787,8.55787 -21.06552,13.82425 -34.88977,13.82425 H 73.071039 c -13.824251,0 -26.331906,-5.26638 -34.889775,-13.82425 -9.216167,-8.55787 -14.482549,-20.40723 -14.482549,-32.91488 V 538.26931 L 0,560.65143 Z m 473.31601,-1.3166 -200.78078,-188.93142 c -5.92468,-5.26638 -14.48255,-5.26638 -20.40723,0 L 57.271895,509.96251 v 205.38887 c 0,7.24127 7.241275,14.48255 15.140846,14.48255 H 458.17516 c 5.92468,0 15.14085,-8.55787 15.14085,-14.48255 z" class="domek_f0"/><line style="opacity:0;fill:none;stroke:#262626;stroke-width:3.83251667" id="line30" y2="560.61115" x2="460.80835" y1="560.61115" x1="69.779549" class="domek_f1 domek_s0"/></g></g><text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;line-height:0%;font-family:Arial;-inkscape-font-specification:'Arial, Normal';text-align:center;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:middle;fill:#e87b1e;fill-opacity:1;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter;stroke-opacity:1" x="1003.8903" y="726.68951" id="temp_room_"><tspan sodipodi:role="line" id="temp_room" x="1003.8903" y="726.68951" style="font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;font-size:235.79478455px;line-height:125%;font-family:Arial;-inkscape-font-specification:'Ubuntu, Bold';text-align:center;writing-mode:lr-tb;text-anchor:middle;fill:#e87b1e;fill-opacity:1">---,-&#xB0;</tspan></text><text xml:space="preserve" style="font-style:normal;font-variant:normal;font-weight:normal;font-stretch:normal;line-height:0%;font-family:Arial;-inkscape-font-specification:'Arial, Normal';text-align:start;letter-spacing:0px;word-spacing:0px;writing-mode:lr-tb;text-anchor:start;opacity:0;fill:#434343;stroke:none;stroke-width:1px;stroke-linecap:butt;stroke-linejoin:miter" x="996.60541" y="463.7402" id="temp_room_sett_" inkscape:label="#temp_room_sett_"><tspan sodipodi:role="line" id="temp_prog" x="976.60541" y="463.7402" style="font-style:normal;font-variant:normal;font-weight:bold;font-stretch:normal;font-size:138.84609985px;line-height:125%;font-family:Arial;-inkscape-font-specification:'Arial, Bold';text-align:start;writing-mode:lr-tb;text-anchor:start;fill:#434343;fill-opacity:1">--,-&#xB0;</tspan></text><path inkscape:connector-curvature="0" style="fill:#434343;clip-rule:evenodd;opacity:0;fill-rule:evenodd;stroke-width:0.15719961;image-rendering:optimizeQuality;shape-rendering:geometricPrecision;text-rendering:geometricPrecision" class="fil0" d="m 835.65479,340.49625 -21.2127,-21.07393 11.1563,-11.32333 21.3698,21.07394 z m -11.942,44.82139 -29.8549,0.15727 -0.1571,-15.88408 30.012,-0.15728 z m 23.2554,40.26063 -21.0555,21.38848 -11.3135,-11.32333 21.0556,-21.23121 z m 44.9396,12.10958 v 29.88102 h -15.8702 l -0.1572,-29.88102 z m 40.0685,-23.27564 21.3698,21.07394 -11.3135,11.32332 -21.2127,-21.07393 z m 12.099,-44.97866 29.855,-0.15727 0.157,16.04136 h -30.012 z m -23.2554,-40.26062 21.0556,-21.23121 11.3134,11.16606 -21.0555,21.2312 z m -44.9395,-11.95241 -0.1571,-30.03819 h 16.0274 l 0.1571,29.88092 z m 8.0137,10.53697 c 27.3408,0 49.6534,22.17484 49.6534,49.6967 0,27.36468 -22.3126,49.69669 -49.6534,49.69669 -27.3409,0 -49.6535,-22.33201 -49.6535,-49.69669 0,-27.52186 22.3126,-49.6967 49.6535,-49.6967 z" id="room_conf_"/><path inkscape:connector-curvature="0" style="fill:#434343;clip-rule:evenodd;opacity:0;fill-rule:evenodd;stroke-width:0.16020121;image-rendering:optimizeQuality;shape-rendering:geometricPrecision;text-rendering:geometricPrecision" class="fil0" d="m 883.89399,327.71319 c 27.3944,0 49.6624,22.26795 49.6624,49.66237 0,27.39442 -22.268,49.66236 -49.6624,49.66236 -27.3944,0 -49.6624,-22.26794 -49.6624,-49.66236 0,-27.39442 22.268,-49.66237 49.6624,-49.66237 z m -48.2205,12.81607 -21.3068,-21.14653 11.2141,-11.21411 21.3068,20.98639 z m -12.0151,44.85638 -29.9576,0.16015 V 369.5257 h 29.9576 z m 23.2292,40.21046 -20.9864,21.30676 -11.3743,-11.21411 21.1466,-21.30676 z m 45.0165,12.01508 v 29.95769 h -15.8599 l -0.1603,-29.95769 z m 40.2105,-23.22919 21.1466,20.98639 -11.054,11.37424 -21.3067,-21.14652 z m 12.0151,-44.85629 29.9576,-0.16023 v 15.85994 l -29.9576,0.16023 z m -68.2458,-52.38578 -0.1601,-29.79745 16.0201,-0.16014 0.1602,29.95759 z m 45.0166,12.01509 20.9864,-21.14653 11.2141,11.21401 -20.9864,21.14662 z m -8.01,56.23063 -57.9928,0.16015 V 369.5257 h 57.8326 z" id="room_confm_"/><path class="fil0" d="m 883.81559,327.61649 c 27.4264,0 49.6808,22.25448 49.6808,49.68075 0,27.42627 -22.2544,49.68075 -49.6808,49.68075 -27.4262,0 -49.6807,-22.25448 -49.6807,-49.68075 0,-27.42627 22.2545,-49.68075 49.6807,-49.68075 z m -60.181,57.67355 -29.9338,0.15678 v -15.98561 l 29.7771,-0.15677 z m 23.1947,40.27744 -21.0006,21.31415 -11.284,-11.28395 21.0007,-21.31413 z m 44.9792,12.06757 0.1567,29.93382 h -15.9855 l -0.1569,-29.93382 z m 40.2774,-23.3515 21.1574,21.1574 -11.1271,11.28396 -21.3143,-21.15743 z m 12.0676,-44.97911 h 29.7771 l 0.1567,15.82887 -29.9338,0.15677 z m -23.3516,-40.12073 21.0007,-21.31413 11.284,11.12722 -21.0007,21.31415 z m -44.9791,-12.06754 -0.1567,-29.93384 h 15.9856 l 0.1568,29.93384 z m -40.2774,23.19478 -21.1574,-21.0007 11.1273,-11.28395 21.314,21.00067 z m 56.1063,7.99279 0.1568,21.0007 h 21.0006 v 15.9856 h -21.0006 v 21.00068 h -15.8289 l -0.1568,-21.00068 h -20.844 l -0.1568,-15.82888 h 21.0008 v -21.00071 z" id="room_confp_" inkscape:connector-curvature="0" style="clip-rule:evenodd;opacity:0;fill:#434343;fill-rule:evenodd;stroke-width:0.15672158;image-rendering:optimizeQuality;shape-rendering:geometricPrecision;text-rendering:geometricPrecision" inkscape:label="#room_confp_"/><polygon transform="matrix(0.12857202,0,0,0.11713412,1243.96,22.810613)" style="fill:#434343;clip-rule:evenodd;opacity:0;fill-rule:evenodd;image-rendering:optimizeQuality;shape-rendering:geometricPrecision;text-rendering:geometricPrecision" class="fil1" points="-3294,2512 -3159,2481 -3090,2781 -2870,2908 -2870,2652 -3093,2444 -2999,2342 -2870,2462 -2871,2257 -2733,2257 -2733,2465 -2601,2342 -2507,2444 -2732,2654 -2732,2907 -2510,2779 -2442,2482 -2307,2513 -2347,2684 -2169,2581 -2100,2701 -2280,2805 -2109,2857 -2149,2989 -2443,2899 -2663,3027 -2441,3154 -2149,3065 -2109,3197 -2277,3249 -2099,3351 -2168,3471 -2348,3367 -2308,3542 -2442,3573 -2512,3273 -2732,3146 -2731,3402 -2508,3610 -2602,3711 -2731,3591 -2731,3797 -2868,3797 -2869,3589 -3000,3711 -3094,3610 -2869,3400 -2869,3146 -3091,3275 -3160,3572 -3294,3541 -3255,3370 -3432,3473 -3502,3353 -3321,3249 -3493,3196 -3453,3064 -3158,3154 -2939,3027 -3161,2899 -3452,2988 -3492,2856 -3324,2805 -3502,2703 -3434,2583 -3253,2687 " id="room_anti_"/><g id="room_econ_" style="opacity:0;fill:#434343;" transform="matrix(65.527444,0,0,60.456252,-7260.0299,-6630.6863)"><metadata id="metadata98"/><path class="fil0" d="m 125.646,116.738 c -0.1781,0.2715 -0.439,0.4741 -0.7369,0.5829 -0.2905,0.1062 -0.6165,0.1232 -0.9356,0.0284 -0.395,-0.1174 -0.7051,-0.384 -0.8869,-0.7198 -0.1817,-0.3356 -0.2355,-0.7407 -0.1182,-1.1353 0.0928,-0.3124 0.2789,-0.5715 0.5187,-0.7562 0.2461,-0.1895 0.5492,-0.3007 0.8662,-0.3103 0.0446,-0.001 0.0817,0.0339 0.0829,0.0785 9e-4,0.0325 -0.0175,0.061 -0.0449,0.0746 v 0 c -0.1443,0.0711 -0.2739,0.1716 -0.3791,0.2962 -0.1011,0.1197 -0.1798,0.2619 -0.2273,0.4216 -0.0923,0.3106 -0.05,0.6295 0.093,0.8936 0.1429,0.2638 0.3866,0.4733 0.6968,0.5655 0.1657,0.0493 0.3336,0.0602 0.4942,0.0381 0.1666,-0.0229 0.3257,-0.0818 0.4664,-0.1704 0.0377,-0.0238 0.0876,-0.0124 0.1114,0.0253 0.0173,0.0275 0.0159,0.0616 -8e-4,0.0872 z" id="path100" style="fill:#434343;" inkscape:connector-curvature="0"/></g><g id="room_hand_" transform="matrix(1.7011096,0,0,1.1867536,793.76971,287.18232)" style="opacity:0;fill:#434343;"><metadata id="metadata110"/><g id="g9" style="fill:#434343;"><path class="fil0" d="m 106,111 v 0 -4 -39 -44 c 0,-3 -2,-6 -5,-6 h -5 c -3,0 -6,3 -6,6 V 68 H 88 V 13 C 88,9 85,6 81,6 h -6 c -3,0 -6,3 -6,7 V 68 H 67 V 6 C 67,3 64,0 60,0 H 55 C 51,0 48,3 48,6 V 68 H 46 V 13 C 46,9 43,6 39,6 h -6 c -3,0 -6,3 -6,7 V 68 91 L 15,66 C 14,63 11,62 8,63 l -5,2 c -3,2 -4,5 -2,8 l 26,54 c 0,0 0,0 0,0 6,15 21,25 38,25 23,0 41,-18 41,-41 z M 27,91 v 2 z" id="path112" inkscape:connector-curvature="0" style="fill:#434343;"/></g></g><g style="opacity:0" transform="translate(1585.0519,171.25981)" id="boiler"><rect style="opacity:1;fill:#ffffff;fill-opacity:1;stroke:#808080;stroke-width:20;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:4;stroke-dasharray:none;stroke-opacity:1" id="rect945" width="120" height="170" x="-638.15088" y="121.15529" ry="28.4748"/><rect style="opacity:1;fill:#808080;fill-opacity:1;stroke:#808080;stroke-width:2.73973894;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:0;stroke-dasharray:none;stroke-opacity:1;paint-order:markers fill stroke" id="rect949" width="17.260262" height="19.56967" x="-663.43573" y="151.37047" ry="2.1744077"/><rect ry="2.1744077" y="243.37047" x="-663.43573" height="19.56967" width="17.260262" id="rect951" style="opacity:1;fill:#808080;fill-opacity:1;stroke:#808080;stroke-width:2.73973894;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:0;stroke-dasharray:none;stroke-opacity:1;paint-order:markers fill stroke"/><rect ry="2.1744077" y="151.37047" x="-510.93573" height="19.56967" width="17.260262" id="rect953" style="opacity:1;fill:#808080;fill-opacity:1;stroke:#808080;stroke-width:2.73973894;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:0;stroke-dasharray:none;stroke-opacity:1;paint-order:markers fill stroke"/><rect style="opacity:1;fill:#808080;fill-opacity:1;stroke:#808080;stroke-width:2.73973894;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:0;stroke-dasharray:none;stroke-opacity:1;paint-order:markers fill stroke" id="rect955" width="17.260262" height="19.56967" x="-510.93573" y="243.37047" ry="2.1744077"/></g></g></g><path style="opacity:0;fill:#ececec;fill-rule:nonzero;stroke-width:1.68466187" id="suitcase_" d="m 184.71587,1616.4438 h 8.2463 v 162.2524 h -8.2463 c -11.54474,0 -19.79103,-9.5442 -19.79103,-22.9062 v -116.44 c 0,-13.362 8.24629,-22.9062 19.79103,-22.9062 z m 31.33579,0 h 13.19397 v -20.9974 c 0,-13.362 8.24614,-22.9062 19.79088,-22.9062 h 37.93285 c 9.89536,0 19.79088,9.5442 19.79088,22.9062 v 20.9974 h 13.19397 v 162.2524 H 216.05166 Z m 126.99205,0 H 351.29 c 9.89552,0 19.79088,9.5442 19.79088,22.9062 v 116.44 c 0,13.362 -9.89536,22.9062 -19.79088,22.9062 h -8.24629 z m -94.0072,0 h 37.93285 v -20.9974 h -37.93285 z" inkscape:connector-curvature="0"/><rect style="opacity:0;fill:#000000;fill-opacity:1;stroke-width:1.07570624" id="rect922" width="347.94922" height="351.18454" x="-828.25165" y="1324.1379"/><g id="parameters_btn" transform="matrix(0.83385904,0,0,0.83385904,-258.11216,2097.0335)" onclick=""><g id="g1030" transform="translate(166.07806)"><text id="parameters_lbl" y="66.630646" x="521.53003" style="font-style:normal;font-weight:bold;font-size:80px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#808080;fill-opacity:1;stroke:none" xml:space="preserve"><tspan style="font-size:80px;text-align:center;text-anchor:middle" y="66.630646" x="521.53003" id="parameters_lbl__" sodipodi:role="line">parameters</tspan></text><g style="fill:#808080" transform="matrix(0.34766901,0,0,0.34766901,352.75471,-340.82861)" id="g1016"><path style="fill:#808080" inkscape:connector-curvature="0" d="m 960.9,820.2 c 18,18 29.1,42.9 29.1,70.3 0,54.9 -44.5,99.5 -99.4,99.5 -27.5,0 -52.3,-11.1 -70.3,-29.1 v 0 L 609.6,750.2 c -59.2,35 -128,55.4 -201.8,55.4 C 188.1,805.6 10,627.5 10,407.8 10,188.1 188.1,10 407.8,10 c 219.7,0 397.8,178.1 397.8,397.8 0,73.7 -20.4,142.6 -55.4,201.8 z M 407.8,109.4 C 243,109.4 109.4,243 109.4,407.8 109.4,572.6 243,706.1 407.7,706.1 572.4,706.1 706,572.5 706,407.8 706.1,243 572.6,109.4 407.8,109.4 Z" id="path1014"/></g></g></g><g id="g1071"><text xml:space="preserve" style="font-style:normal;font-weight:bold;font-size:66.70872498px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#808080;fill-opacity:1;stroke:none;stroke-width:0.83385903" x="1406.0402" y="2157.019" id="configuration_lbl"><tspan sodipodi:role="line" id="configuration_lbl__" x="1406.0402" y="2157.019" style="font-size:66.70872498px;text-align:center;text-anchor:middle;stroke-width:0.83385903">configuration_lbl</tspan></text><g id="settings_img-4" transform="matrix(10.312426,0,0,10.312426,1240.2552,1817.4598)" style="fill:#808080"><path d="m 17.601,12.297 c 0.556,-0.371 1.212,-0.529 1.854,-0.457 L 26.769,4.524 22.673,0.428 15.358,7.744 c 0.074,0.65 -0.09,1.314 -0.476,1.877 z" id="path2-3" inkscape:connector-curvature="0"/><polygon points="9.486,16.561 4.842,21.207 4.577,20.942 3.19,22.063 0.854,25.744 1.452,26.342 5.136,24.006 6.256,22.623 5.99,22.354 10.642,17.701 " id="polygon4"/><path d="m 12.949469,8.307 c 0.537,-1.92 0.05,-4.066 -1.457,-5.576 C 9.9904672,1.235 7.8694672,0.744 5.9604672,1.262 l 3.233,3.232 -0.848,3.166 -3.17,0.848 -3.2320002,-3.23 c -0.516,1.908 -0.026,4.029 1.4730002,5.529 1.571,1.572 3.835,2.033 5.815,1.389 l 0.018,0.018 13.2990018,13.299 c 0.526,0.525 1.216,0.791 1.905,0.791 0.69,0 1.378,-0.266 1.906,-0.791 1.051,-1.049 1.051,-2.754 0,-3.811 z m 11.736,16.754 c -0.566,0 -1.025,-0.461 -1.025,-1.029 0,-0.57 0.459,-1.029 1.025,-1.029 0.57,0 1.031,0.459 1.031,1.029 0.001,0.568 -0.46,1.029 -1.031,1.029 z" id="path6-8" inkscape:connector-curvature="0"/></g></g><rect style="opacity:0;fill:#dc1c1c;fill-opacity:0.52985074;stroke:#6e4f4f;stroke-width:5.43268871;stroke-opacity:1" id="rect919" width="500" height="366.17911" x="64.577423" y="1815.759" rx="0" ry="31.803436" onclick="location.href = '#params'; showLoadingSpinnerWithDelay();"/><rect style="opacity:0;fill:#dc1c1c;fill-opacity:0.52985074;stroke:#6e4f4f;stroke-width:5.43268871;stroke-opacity:1" id="rect919-1" width="500.00003" height="366.17911" x="1150" y="1815.759" rx="0" ry="31.803436" onclick="location.href = '#m_index__config_pass'"/><rect style="opacity:0;fill:#dc1c1c;fill-opacity:0.52985074;stroke:#6e4f4f;stroke-width:5.43268871;stroke-opacity:1" id="rect919-6" width="500.00003" height="366.17911" x="607.28882" y="1815.759" rx="0" ry="31.803436" onclick="location.href = '#settings'; showLoadingSpinnerWithDelay();"/><rect style="opacity:0;fill:#dc1c1c;fill-opacity:0.52985074;stroke:#6e4f4f;stroke-width:5.43268871;stroke-opacity:1" id="rectError1" width="270" height="260" x="150" y="1300" rx="0" ry="31.803436"/><g style="fill:#434343;" inkscape:label="#rp_indicator" id="rp_indicator" transform="matrix(1.6,0,0,1.6,383,237)"><line fill="none" stroke="#434343" stroke-width="10" stroke-linecap="round" x1="440.945" y1="279.2" x2="440.945" y2="299.478" id="line120"/><line fill="none" stroke="#434343" stroke-width="10" stroke-linecap="round" x1="336.968" y1="383.141" x2="357.733" y2="383.141" id="line122"/><g id="g130"><g id="g128"><line fill="none" stroke="#434343" stroke-width="10" x1="307.36" y1="249.843" x2="342.72" y2="283.879" id="line124"/><polygon points="317.04,282.705 341.025,282.247 340.564,258.266 350.931,268.245 351.388,292.223 327.407,292.684    " id="polygon126"/></g></g><g id="g136"><path stroke="#434343" stroke-width="5" d="M386.889,336.025h2.341h11.308c3.486,0,6.19,1.044,8.165,3.131                 c1.987,2.088,2.984,4.963,2.984,8.611c0,3.76-1.07,6.69-3.191,8.812c-0.999,1.011-2.206,1.796-3.596,2.335                 c1.536,0.234,2.658,0.775,3.388,1.584c1.049,1.178,1.756,3.523,2.133,7.061c0.292,2.76,0.572,5.107,0.815,7.015l0.27,2.011                 c0.22,1.402,0.403,2.492,0.587,3.277c0.157,0.774,0.353,1.426,0.558,1.953h-2.473h-2.498c-0.316-1.224-0.61-2.738-0.864-4.479                 c-0.281-1.764-0.585-4.154-0.94-7.219l-0.207-1.907c-0.29-2.538-0.912-4.312-1.875-5.345c-0.951-1.021-2.449-1.549-4.474-1.549                 h-7.738v20.531h-2.328h-2.363V336.025z M391.581,356.119h8.165c2.304,0,4.082-0.605,5.352-1.853                 c1.267-1.224,1.888-2.974,1.888-5.22c0-2.762-0.671-4.748-1.998-5.984c-1.342-1.233-3.499-1.84-6.484-1.84h-6.922V356.119z" id="path132"/><path stroke="#434343" stroke-width="5" d="M418.835,336.025h2.34h10.139c3.607,0,6.459,1.155,8.506,3.469                 c2.049,2.313,3.096,5.512,3.096,9.576c0,4.152-1.047,7.418-3.096,9.777c-2.047,2.367-4.898,3.546-8.506,3.546h-7.773v19.454h-2.34                 h-2.365V336.025z M423.541,357.207h7.773c2.17,0,3.877-0.719,5.094-2.121c1.195-1.404,1.803-3.39,1.803-5.938                 c0-2.526-0.607-4.469-1.803-5.85c-1.217-1.391-2.924-2.076-5.094-2.076h-7.773V357.207z" id="path134"/></g><path fill="none" stroke="#434343" stroke-width="11" stroke-linecap="round" d="M336.968,382.406             c0-56.996,46.216-103.207,103.217-103.207" id="path138"/><line fill="none" stroke="#434343" stroke-width="10" stroke-linecap="round" x1="367.171" y1="309.496" x2="381.857" y2="324.181" id="line140"/><line fill="none" stroke="#434343" stroke-width="10" stroke-linecap="round" x1="345.596" y1="341.752" x2="364.784" y2="349.698" id="line142"/><line fill="none" stroke="#434343" stroke-width="10" stroke-linecap="round" x1="398.955" y1="287.316" x2="406.705" y2="306.059" id="line144"/></g><g id="settings_btn"><text xml:space="preserve" style="font-style:normal;font-weight:bold;font-size:66.70872498px;line-height:1.25;font-family:sans-serif;letter-spacing:0px;word-spacing:0px;fill:#000000;fill-opacity:1;stroke:none;stroke-width:0.83385903" x="864.32355" y="2154.7451" id="settings_lbl"><tspan sodipodi:role="line" id="settings_lbl__" x="864.32355" y="2154.7451" style="font-size:66.70872498px;text-align:center;text-anchor:middle;fill:#808080;stroke-width:0.83385903">settings</tspan></text><g style="fill:#808080" transform="matrix(0.29843076,0,0,0.29843076,716.02373,1805.1561)" id="g1017"><g style="fill:#808080" id="g985"><path style="fill:#808080" inkscape:connector-curvature="0" d="m 965.7,408.8 -87.5,-10.5 c -8.9,-33.4 -22,-64.9 -38.9,-94.1 l 54.4,-69.1 c 8.3,-10.6 7.4,-27.1 -2.3,-36.6 l -90.1,-90.2 c -9.5,-9.5 -26,-10.5 -36.6,-2.2 l -69.2,54.4 C 666.4,143.7 634.9,130.6 601.6,121.7 L 591.1,34.2 C 589.5,20.8 577.1,9.9 563.7,9.9 H 436.2 c -13.5,0 -25.8,10.9 -27.4,24.3 l -10.5,87.5 c -33.3,8.9 -64.9,22 -94,38.8 l -69.2,-54.4 c -10.6,-8.3 -27,-7.3 -36.6,2.2 l -90.2,90.2 c -9.5,9.5 -10.5,26 -2.1,36.6 l 54.3,69.1 c -16.8,29.2 -29.9,60.7 -38.8,94.1 L 34.3,408.8 C 21,410.5 10,422.8 10,436.4 v 127.5 c 0,13.5 10.9,25.8 24.3,27.4 l 87.5,10.5 c 8.9,33.2 22,64.8 38.8,93.9 l -54.3,69.2 C 98,775.5 99,792 108.5,801.5 l 90,90.2 c 9.5,9.5 26,10.5 36.6,2.2 l 69.2,-54.5 c 29.2,16.8 60.7,30 94,38.8 l 10.5,87.4 c 1.6,13.4 13.9,24.3 27.4,24.3 h 127.5 c 13.5,0 25.8,-10.9 27.4,-24.3 l 10.5,-87.4 c 33.3,-8.9 64.9,-22 94,-38.8 l 69.2,54.4 c 10.6,8.3 27.1,7.3 36.6,-2.2 l 90.1,-90.2 c 9.6,-9.5 10.6,-26 2.2,-36.6 l -54.4,-69.1 c 16.9,-29.2 29.9,-60.7 38.9,-94 l 87.4,-10.5 c 13.4,-1.6 24.3,-13.9 24.3,-27.4 V 436.3 C 990,422.7 979.1,410.4 965.7,408.8 Z M 500,745 C 364.7,745 255,635.3 255,500 255,364.7 364.7,255 500,255 c 135.3,0 245,109.7 245,245 0,135.3 -109.6,245 -245,245 z" id="path983"/></g><g style="fill:#808080" id="g987"/><g style="fill:#808080" id="g989"/><g style="fill:#808080" id="g991"/><g style="fill:#808080" id="g993"/><g style="fill:#808080" id="g995"/><g style="fill:#808080" id="g997"/><g style="fill:#808080" id="g999"/><g style="fill:#808080" id="g1001"/><g style="fill:#808080" id="g1003"/><g style="fill:#808080" id="g1005"/><g style="fill:#808080" id="g1007"/><g style="fill:#808080" id="g1009"/><g style="fill:#808080" id="g1011"/><g style="fill:#808080" id="g1013"/><g style="fill:#808080" id="g1015"/></g></g><rect style="opacity:0;fill:#ff0000;fill-opacity:1;stroke:none;stroke-width:12.90994453;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:0;stroke-dasharray:none;stroke-opacity:1;paint-order:markers fill stroke" id="configuration_lbl_" width="500" height="400" x="1138" y="1800" ry="2.8992136" onclick="location.href = '#m_index__config_pass';"/><rect ry="2.8992136" y="1800" x="605" height="400" width="500" id="settings_lbl_" style="opacity:0;fill:#ff0000;fill-opacity:1;stroke:none;stroke-width:12.90994453;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:0;stroke-dasharray:none;stroke-opacity:1;paint-order:markers fill stroke" onclick="location.href = '#settings'; showLoadingSpinnerWithDelay();"/><rect style="opacity:0;fill:#ff0000;fill-opacity:1;stroke:none;stroke-width:12.90994453;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:0;stroke-dasharray:none;stroke-opacity:1;paint-order:markers fill stroke" id="parameters_lbl_" width="500" height="400" x="67.599998" y="1800" ry="2.8992136" onclick="location.href = '#params'; showLoadingSpinnerWithDelay();"/></svg></body></html>
</div>
    </div>
  </div>
  <!-- /page one -->

  <!-- /validation error -->
  <div data-role="dialog" id="validation_error">
    <div data-role="header"><h1>błąd</h1></div>
    <div data-role="content">
      <label for="setting_party_time">Błędnie wprowadzone dane, proszę poprawić wartości.</label>
      <a href="#" data-role="button" data-theme="c" data-rel="back">zamknij okno</a>
    </div>
  </div>


  <!-- /party -->
  <div data-role="dialog" id="start_mode">
    <div data-role="header"><h1>tryb party</h1></div>
    <div data-role="content">
      <ul data-role="listview" data-inset="true">
        <li class="ui-body">
        </li>
      </ul>
      <a href="#" data-role="button" data-theme="c" data-rel="back" onclick="endPVH();">wyłącz tryb party</a>
    </div>
  </div>

  <!-- /turbo -->
  <div data-role="dialog" id="start_turbo_on_off_dlg">
    <div data-role="header"><h1>tryb turbo</h1></div>
    <div data-role="content">
      <a href="#" class="sure-do" data-role="button" data-theme="b" data-rel="back" onclick="setTurbo(true);">tak</a>
      <a href="#" data-role="button" data-theme="c" data-rel="back" onclick="setTurbo(false);">nie</a>
    </div>
  </div>

  <div data-role="dialog" id="m_index__config_pass" data-close-btn="right">
    <div data-role="header"><h1>hasło</h1></div>
    <div data-role="content">
      <input id="m_index__config_pass__pass" data-clear-btn="false" name="setting_hand_temp" type="password">
      <table width="100%">
        <tr>
          <td><a href="#" data-role="button" data-theme="b" onclick="m_index__pass();">zatwierdź</a></td>
        </tr>
      </table>
    </div>
  </div>

<script>
const COLOR_ACTIVE   = "#858585";
const COLOR_ENABLED  = "#e9e9e9";
const COLOR_DISABLED = "#e9e9e9";

$(document).on("pagechange", function ()
{
    if ($("#start").is(":visible"))
    {
		showLoadingSpinner();
        ref_start();
        $("#rectError1").attr("onclick","errorMessageHandler()");        
		setTimeout(function() 
		{
			hideLoadingSpinner();
		}, 1000);
    }
});

$("#m_index__config_pass").off("pagehide").on("pagehide",function(){
    if ($("#start").is(":visible"))
    {
		showLoadingSpinner();
    }
});

$("#parameters_lbl_").on("mousedown", function (event) { highlightRect(event, $("#path1014").attr("id"), false); });
$("#parameters_lbl_").on("touchstart", function (event) { highlightRect(event, $("#path1014").attr("id"), true); });
$("#parameters_lbl_").on("mouseup", function (){ unHighlightRect( $("#path1014").attr("id")); });
$("#parameters_lbl_").on("mouseout", function (){ unHighlightRect( $("#path1014").attr("id")); });
$("#configuration_lbl_").on("mousedown", function (event) { highlightRect(event, $("#settings_img-4").attr("id"), false); });
$("#configuration_lbl_").on("touchstart", function (event) { highlightRect(event, $("#settings_img-4").attr("id"), true); });
$("#configuration_lbl_").on("mouseup", function (){ unHighlightRect( $("#settings_img-4").attr("id")); });
$("#configuration_lbl_").on("mouseout", function (){ unHighlightRect( $("#settings_img-4").attr("id")); });
$("#settings_lbl_").on("mousedown", function (event) { highlightRect(event, $("#path983").attr("id"), false); });
$("#settings_lbl_").on("touchstart", function (event) { highlightRect(event, $("#path983").attr("id"), true); });
$("#settings_lbl_").on("mouseup", function (){ unHighlightRect( $("#path983").attr("id")); });
$("#settings_lbl_").on("mouseout", function (){ unHighlightRect( $("#path983").attr("id")); });  
$("#rectError1").on("mousedown", function (event) { highlightError(event, false); });
$("#rectError1").on("touchstart", function (event) { highlightError(event, true); });
$("#rectError1").on("mouseup", function (){ unHighlightError(); });
$("#rectError1").on("mouseout", function (){ unHighlightError(); });

function highlightError(event, mouseleft){
    if ($("#start").is(":visible") && (event.which == 1 || touchClick))
    {
        $("#polygon9").css("fill","#ffc0c0");
        $("#path20").css("fill","#ffc0c0");
        $("#path22").css("fill","#ffc0c0");
    }
}

function unHighlightError(){
	if ($("#start").is(":visible"))
    {
		setTimeout(function() 
		{
            $("#polygon9").css("fill","red");
            $("#path20").css("fill","red");
            $("#path22").css("fill","red");
		}, 200);
    }
}


function highlightRect(event, rectId, mouseleft){
	if ($("#start").is(":visible") && (event.which == 1 || touchClick))
    {
		document.getElementById(rectId).style["fill"] = "#cccccc";
    }
}

function unHighlightRect(rectId){
	if ($("#start").is(":visible"))
    {
		setTimeout(function() 
		{
			document.getElementById(rectId).style["fill"] = "#808080";
		}, 10);
    }
}

var  m_start__mode__vis = false;

$(function(){
	$("<a id='error_fire' onclick='showLoadingSpinner();' data-rel='dialog' data-transition='pop' href='#error' ></a>").insertAfter("#path22");
	$("#rectError1").attr("onclick","errorMessageHandler()");   
}); 

function errorMessageHandler(){
    $("#rectError1").attr("onclick","");
	var tempReg = getReg("0b52", "1");
	var errorCode = regToInt(tempReg['0b52']);
	if(errorCode != 0){
        setTimeout(function() 
		{
            document.getElementById('error_fire').click();
            getErrorInfo(errorCode); 
		}, 300)
	}
}

$( document ).on( "mobileinit", function() {
  $.mobile.loader.prototype.options.text = "loading";
  $.mobile.loader.prototype.options.textVisible = false;
  $.mobile.loader.prototype.options.theme = "a";
  $.mobile.loader.prototype.options.html = "";
});

$.mobile.loading( "show", {
  text: "foo",
  textVisible: true,
  theme: "z",
  html: ""
});

/* globalny identyfikator otwartego urządzenia */
var uri = window.location.pathname.split('/');
if(uri.length === 2) { id = uri[1]; } else { id = uri[2]; }

function m_start__mode_set() {
  off    = $("#m_start__mode_off").prop("checked");
  summer = $("#m_start__mode_summer").prop("checked");
  winter = $("#m_start__mode_winter").prop("checked");

  reg = regToInt(getReg("0b55", "1")["0b55"]);
  if(off)    { reg = setBit(reg, 3, false); reg = setBit(reg, 5, false); }
  if(summer) { reg = setBit(reg, 3, true);  reg = setBit(reg, 5, false); }
  if(winter) { reg = setBit(reg, 3, false); reg = setBit(reg, 5, true);  }
  setReg("0b55", regToHex(reg));
}

$(function () {
  setInterval(refresh,  10000);
  $("#settings_lbl__").text("ustawienia");
  $("#parameters_lbl__").text("parametry");
  $("#configuration_lbl__").text("konfiguracja");
  $("#m_start__title").text(getDevType()); 
})

/**
 *  @brief          refresh()
 *  @description    Funkcja odswiezajaca kontrolki.
 */
function refresh() {
  if($("#win_index").is(":visible") == true ) {
    ref_start();
  }
}

function ref_start() {
  var reg  = getReg("0b2f", "30");
  
  // pobranie wartosci flag
  var error      = regToInt(reg['0b52']);
  var r_flagi_2  = regToInt(reg['0b50']);
  var r_flagi_1  = regToInt(reg['0b51']);
  var rw_flagi_2 = regToInt(reg['0b54']);
  var rw_flagi_1 = regToInt(reg['0b55']);  
  
  /* Ustawienie temperatur w kontrolkach */
  setTemp(reg['0b4b'], "temp_room"   , 1, rw_flagi_1);
  setTemp(reg['0b31'], "temp_prog"   , 1, rw_flagi_1);
  setTemp(reg['0b4c'], "temp_out"    , 1, rw_flagi_1);
  setTemp(reg['0b2f'], "temp_zas_nas", 0, rw_flagi_1);
  setTemp(reg['0b4a'], "temp_zas"    , 0, rw_flagi_1);

  if(getBit(regToInt(reg["0b50"]), 12)) {
    $("#line30").css("opacity", "1"); 
    $("#temp_room_sett_").css("opacity", "0"); 
    $("#room_econ_").css("opacity", "0"); 
    $("#room_anti_").css("opacity" , "0");
    $("#room_conf_").css("opacity" , "0");
    $("#room_confm_").css("opacity", "0");
    $("#room_confp_").css("opacity", "0");
    $("#room_hand_").css("opacity" , "0");
    $("#boiler").css("opacity" , "1");
  } else {
    $("#boiler").css("opacity" , "0");
    
    /* Ustawienie ikony trybu parcy kotla */
    if(regToInt(getReg("0b8a", "1")['0b8a']) == 0) {
      $("#line30").css("opacity", "1"); 
      $("#temp_room_sett_").css("opacity", "1"); 
      if(regToInt(reg['0b32']) == 0)  { $("#room_econ_").css("opacity" , "1"); } else { $("#room_econ_").css("opacity", "0");  }
      if(regToInt(reg['0b32']) == 1)  { $("#room_anti_").css("opacity" , "1"); } else { $("#room_anti_").css("opacity" , "0"); }
      if(regToInt(reg['0b32']) == 2)  { $("#room_conf_").css("opacity" , "1"); } else { $("#room_conf_").css("opacity" , "0"); }
      if(regToInt(reg['0b32']) == 3)  { $("#room_confm_").css("opacity", "1"); } else { $("#room_confm_").css("opacity", "0"); }
      if(regToInt(reg['0b32']) == 4)  { $("#room_confp_").css("opacity", "1"); } else { $("#room_confp_").css("opacity", "0"); }
      if(regToInt(reg['0b32']) == 64) { $("#room_hand_").css("opacity" , "1"); } else { $("#room_hand_").css("opacity" , "0"); }
    } else {
      /* ukrycie ikon */
      $("#line30").css("opacity", "0"); 
      $("#temp_room_sett_").css("opacity", "0"); 
      $("#room_econ_").css("opacity", "0"); 
      $("#room_anti_").css("opacity" , "0");
      $("#room_conf_").css("opacity" , "0");
      $("#room_confm_").css("opacity", "0");
      $("#room_confp_").css("opacity", "0");
      $("#room_hand_").css("opacity" , "0");
    }
  }

  /* Ustawienie ikony trybu pracy zasobnika */
  if(regToInt(reg['0b30']) == 0) { $("#temp_zas_ekon_").css("opacity" , "1"); } else { $("#temp_zas_ekon_").css("opacity", "0"); }
  if(regToInt(reg['0b30']) == 1) { $("#temp_zas_pzam_").css("opacity" , "1"); } else { $("#temp_zas_pzam_").css("opacity" , "0"); }
  if(regToInt(reg['0b30']) == 2) { $("#temp_zas_konf_").css("opacity" , "1"); } else { $("#temp_zas_konf_").css("opacity" , "0"); }

  if(getBit(rw_flagi_1, 4)) {
    $('#tray').attr("style", "opacity: 1.0;");
    $('#home').attr("transform", "translate(0,120)");
    $('#temp').attr("transform", "translate(200,50)");
    $("#rp_indicator").attr("transform", "matrix(1.6,0,0,1.6,383,-33)");    
  } else {
    $('#tray').attr("style", "opacity: 0.0;");
    $('#home').attr("transform", "translate(0,400)");
    $('#temp').attr("transform", "translate(200,320)");
    $("#rp_indicator").attr("transform", "matrix(1.6,0,0,1.6,383,237)");
  }

  /* fast mode */
  if(getBit(rw_flagi_1, 9) ||  getBit(rw_flagi_1, 6) || getBit(rw_flagi_1, 7)) {
    if(getBit(rw_flagi_1, 9)) { $('#glass_').attr("style", "opacity: 0.0;"); $('#suitcase_').attr("style", "opacity: 0.0;"); $('#hand_').attr("style", "opacity: 0.5;"); }
    if(getBit(rw_flagi_1, 6)) { $('#glass_').attr("style", "opacity: 0.5;"); $('#suitcase_').attr("style", "opacity: 0.0;"); $('#hand_').attr("style", "opacity: 0.0;"); }
    if(getBit(rw_flagi_1, 7)) { $('#glass_').attr("style", "opacity: 0.0;"); $('#suitcase_').attr("style", "opacity: 0.5;"); $('#hand_').attr("style", "opacity: 0.0;"); }
  } else {
    $('#glass_').attr("style", "opacity: 0.0;");
    $('#suitcase_').attr("style", "opacity: 0.0;");
    $('#hand_').attr("style", "opacity: 0.0;");
  }

  /* czujnik zewnętrzny */
  if (getBit(rw_flagi_1, 1)){
      $("#temp_room_sett_").css("opacity", "0"); 
      $("#room_econ_").css("opacity", "0"); 
      $("#room_anti_").css("opacity" , "0");
      $("#room_conf_").css("opacity" , "0");
      $("#room_confm_").css("opacity", "0");
      $("#room_confp_").css("opacity", "0");
      $("#room_hand_").css("opacity" , "0");
      $("#boiler").css("opacity" , "0");
      
      if (document.getElementById("temp_room").style.visibility == "hidden"){
          $("#line30").css("opacity", "0"); 
      }
          
      if (getBit(r_flagi_1, 4)){
          $("#rp_indicator").css("opacity" , "1");
          $("#line30").css("opacity", "1"); 
      }else{
          $("#rp_indicator").css("opacity" , "0");
      }           
  }else{
    $("#rp_indicator").css("opacity" , "0");   
  }
       
  /* TURBO */
  if(getBit(r_flagi_2, 1) && getBit(r_flagi_2, 6)) { $("#turbo_").css("fill", COLOR_ACTIVE); } else { $("#turbo_").css("fill", COLOR_DISABLED); }
  
  /* ERROR */
  if(error !== 0) {
        if ((getBit((rw_flagi_1), 14)) == false){
            if (error == 32){ 
                $("#error_").css("fill" , COLOR_DISABLED);
                $("#polygon9").css("fill" , COLOR_DISABLED);
                $("#path20").css("fill" , COLOR_DISABLED);
                $("#path22").css("fill" , COLOR_DISABLED);
                $("#rectError1").hide();
            }else{
                $("#error_").css("fill" , "red"); 
                $("#polygon9").css("fill" , "red");
                $("#path20").css("fill" , "red");
                $("#path22").css("fill" , "red");
                $("#rectError1").show();   
            } 
        }else{
           $("#error_").css("fill" , "red"); 
           $("#polygon9").css("fill" , "red");
           $("#path20").css("fill" , "red");
           $("#path22").css("fill" , "red");
           $("#rectError1").show();
        }  
  } else {
      $("#error_").css("fill" , COLOR_DISABLED);
      $("#polygon9").css("fill" , COLOR_DISABLED);
      $("#path20").css("fill" , COLOR_DISABLED);
      $("#path22").css("fill" , COLOR_DISABLED);
      $("#rectError1").hide();
  }

  /* sterowanie kontrolkami sygnalizacyjnymi */
  if(getBit(rw_flagi_1, 9) ||  getBit(rw_flagi_1, 6) || getBit(rw_flagi_1, 7)) { $("#clock_").css("fill", COLOR_DISABLED); } else { $("#clock_").css("fill", COLOR_ACTIVE); } /* Praca wg kalendarza */

  co         = getBit(r_flagi_1, 7);
  cwu        = getBit(r_flagi_1, 8);
  lato       = getBit(rw_flagi_1, 3);
  zima       = getBit(rw_flagi_1, 5);
  co_yes_no  = getBit(rw_flagi_1, 4);
  moc        = regToInt(reg["0b46"]);

  if(lato) {
    if(cwu) { $("#tap_").css("fill", "#ff0000"); } else { $("#tap_").css("fill", "#00aa00"); }
    $("#radiator_").css("fill", "#ececec");
  }

  if(zima) {
    if(co_yes_no) {
      if(cwu && (moc != 0)) { $("#tap_").css("fill", "#ff0000"); } else { $("#tap_").css("fill", "#00aa00"); }
    } else {
      $("#tap_").css("fill", "#ececec");
    }
    if(co && (moc != 0))  { $("#radiator_").css("fill", "#ff0000"); } else { $("#radiator_").css("fill", "#00aa00"); }
  }

  if(!lato && !zima) {
    $("#tap_").css("fill", "#ececec"); 
    $("#radiator_").css("fill", "#ececec"); 
  }

  if(getBit(r_flagi_1, 0)) { $("#pump_").css("fill", COLOR_ACTIVE); } else { $("#pump_").css("fill", COLOR_DISABLED); } /* Pompa CO wl/wyl     */

  // opacity
  $("#radiator_").css("opacity" , "1");
}

function m_index__pass() {   
  if($("#m_index__config_pass__pass").val() == "987") { window.location.href = "#config"; showLoadingSpinner();}
}




/**
 *  @brief          setTemp(temp, name, decPoint)
 *  @description    Funkcja przetwarzajaca i wyswietlajaca temperature. (analiza znaku).
 *
 *  @param          temp [string], [HEX] wartosc temperatury (lite endian).
 *  @param          name [string], nazwa pojemnika.
 *  @param          decPoint [int], liczba definiujaca, ile cyfr po przecinku ma byc wyswietlane.
 */
function setTemp(temp, name, decPoint, flagi)
{
  var _temp = parseInt(temp.substring(2) + temp.substring(-2, 2), 16);
  if((_temp & 0x8000) > 0) { _temp = _temp - 0x10000; }
  
  if(_temp > -1000) { 
        $("#"+name).text((_temp / 10).toFixed(decPoint) + "°");
        $("#"+name).css("fill","rgb(67, 67, 67)");
        if (name == "temp_room" ){
            $("#"+name).css("font-size","200px");
            $("#"+name).css("fill","rgb(232, 123, 30)");
        }
        if (name == "temp_prog" ){
            $("#"+name).css("font-size","130px");
        }
        if (name == "temp_out" ){
            $("#"+name).css("font-size","150px");
        }
    }
    else { 
        $("#"+name).text("Serwis");
        $("#"+name).css("fill","rgb(232, 123, 30)");
        if (name == "temp_room" ){
            $("#"+name).css("font-size","130px");
        }
        if (name == "temp_prog" ){
            $("#"+name).css("font-size","100px");
        }
        if (name == "temp_out" ){
            $("#"+name).css("font-size","100px");
        }
    }
  if(name == "temp_room" || name == "temp_out"){
      if (getBit(flagi, 1)){
        if (_temp <= -1000){
           if (name == "temp_out"){
            $("#temp").css("visibility" , "hidden");
            $("#g5951").css("visibility" , "hidden");
            $("#temp_outside_").css("visibility" , "hidden");
           }     
           $("#"+name).css("visibility" , "hidden");   
        }else{
           if (name == "temp_out"){
            $("#temp").css("visibility" , "visible");
            $("#g5951").css("visibility" , "visible");
            $("#temp_outside_").css("visibility" , "visible");
           }     
           $("#"+name).css("visibility" , "visible");    
        }
      }else{
          //nastawa co man auto
        if ((getBit(flagi, 14)) == false){
            if (name == "temp_out"){
                if (_temp <= -1000){
                    $("#temp").css("visibility" , "hidden");
                    $("#g5951").css("visibility" , "hidden");
                    $("#temp_outside_").css("visibility" , "hidden");                    
                    $("#"+name).css("visibility" , "hidden"); 
                }else{
                    $("#temp").css("visibility" , "visible");
                    $("#g5951").css("visibility" , "visible");
                    $("#temp_outside_").css("visibility" , "visible");
                    $("#"+name).css("visibility" , "visible"); 
                }
            }
        }else{
                    $("#temp").css("visibility" , "visible");
                    $("#g5951").css("visibility" , "visible");
                    $("#temp_outside_").css("visibility" , "visible");
                    $("#"+name).css("visibility" , "visible"); 
        }
     }
  }
}

/**
 *  @brief        edian(_hex_)
 *  @description  Funkcja zamiany miejscami postaci binarnej flag i bĹ�edĂłw
 *  @param        _hex_ <string>, ciÄ�g zero-jedynkowy reprezentujÄ�cy flagi lub bĹ�Ä�dy (16 bitĂłw)
 *  @result       <string>, ciąg zero-jedynkowy po zmianie.
 *  @date         2017-10-31 12:46
 *  @author       A.K.
 */
function edian(_hex_) { return _hex_.substring(8,16) + _hex_.substring(0,8); }

function minutesToTime(val) {
  var hour   = ('0' + Math.trunc(val / 60)).slice(-2);
  var minute = ('0' + (val % 60)).slice(-2);

  if(hour > 23)   { return false; }
  if(minute > 59) { return false; }

  return hour + ":" + minute;
}

function intToHex(val) {
 return (val + 0x10000).toString(16).substr(-4);
}

function hexToUInt(val, endian) {
  if(endian) { return parseInt(val, 16); }
        else { return parseInt(reg.substring(2) + reg.substring(-2, 2), 16); }
}

function regToInt(reg) {
    var temp = parseInt(reg.substring(2) + reg.substring(-2, 2), 16);
    if((temp & 0x8000) > 0) { temp = temp - 0x10000; }
    return temp;
}

function regToHex(reg, endian) {
  hex = (reg + 0x10000).toString(16).substr(-4);
  if(endian) {
    return hex;
  } else {
    return hex.substring(2) + hex.substring(-2, 2); 
  }
}

function setValid(ctrl, status) {
  if(status) { 
    ctrl.attr("style", "color: red; font-weight: bold;");
  } else { 
    ctrl.attr("style", "color: black; font-weight: normal;"); 
  }
}

function dec2bin(dec){
  return (dec >>> 0).toString(2);
}


/**
 *  @brief          setBit(val, bit)
 *  @description    Funkcja ustawiajaca lub kasująca bit.
 *
 *  @param          reg [integer], korygowana liczba.
 *  @param          bit [integer], nr ustawianego bitu.
 *  @param          val [boolean], stan ustawianego bitu.
 */
function setBit(reg, bit, val) {
  if(val) { reg |= (1 << bit); } else { reg &= ~(1 << bit); }
  return reg;
}

/**
 *  @brief          getBit(val, bit)
 *  @description    Funkcja pobierająca bit.
 *
 *  @param          reg [integer], rejestr.
 *  @param          bit [integer], nr czytanego bitu.
 */
function getBit(reg, bit) {
  return (reg & (1 << bit)) != 0;
}



/**
 *  @brief          setRegBit(reg, bit, val)
 *  @description    Funkcja ustawiajaca bit w danym rejestrze.
 *
 *  @param          reg [string], [HEX] rejestr (lite endian).
 *  @param          bit [integer], nr ustawianego bitu.
 *  @param          val [boolean], stan ustawianego bitu.
 */
function setRegBit(reg, bit, val) {
  $.ajax({
    beforeSend: function() {}, //$.mobile.showPageLoadingMsg(); }, //Show spinner
    complete: function() {}, //$.mobile.hidePageLoadingMsg() }, //Hide spinner    type: 'GET',
    url: "api/dev/" + id + "/" + reg,
    timeout: 500,
    dataType: 'json',
    async: false,
    success: function(data) {
      value = parseInt(data['regs'][reg].substring(2) + data['regs'][reg].substring(-2, 2), 16);
      if(val) { value |= (1 << bit); } else { value &= ~(1 << bit); }
        $.ajax({
          type: 'POST',
          url: "api/dev/" + id + "/" + reg,
          timeout: 500,
          dataType: 'json',
          data: regToHex(value)
        });
      },
    error: function() {
//      alert('HTML Error');
    }
  });
}

/**
 *  @brief          getRegBit(reg, bit)
 *  @description    Funkcja pobierajaca bit z danego rejestru.
 *
 *  @param          reg [string], [HEX] rejestr (lite endian).
 *  @param          bit [integer], nr ustawianego bitu.
 *  @param          val [boolean], stan ustawianego bitu.
 */
function getRegBit(reg, bit) {
  var result;
  $.ajax({
    beforeSend: function() { }, //$.mobile.showPageLoadingMsg(); }, //Show spinner
    complete: function() { },//$.mobile.hidePageLoadingMsg() }, //Hide spinner    type: 'GET',
    type: 'GET',
    url: "api/dev/" + id + "/" + reg,
    timeout: 1000,
    dataType: 'json',
    async: false,
    success: function(data) {
      value = parseInt(data['regs'][reg].substring(2) + data['regs'][reg].substring(-2, 2), 16);
      result = (value & (1 << bit)) != 0;
    },
    error: function() {
//      alert('HTML Error');
    }
  });
  return result;
}

function getReg(reg, cnt) {
  var result;
  $.ajax({
    type: 'GET',
    url: "api/dev/" + id + "/" + reg + "/" + cnt,
    timeout: 1000,
    dataType: 'json',
    async: false,
    success: function(data) {
      result = data["regs"];
    },
    error: function() {}
  });
  return result;
}

function setReg(reg, val) {
  $.ajax({
    type: 'POST',
    url: "api/dev/" + id + "/" + reg,
    timeout: 1000,
    dataType: 'json',
    data: val,
    async: false,
    error: function() {
//      alert('HTML Error');
    }
  });
}

/**
 *  @brief          validate(ctrl, min, max, chars)
 *  @description    Funkcja walidujaca kontrolkę.
 *
 *  @param          ctrl  [handle],  uchwyt do obiektu DOM.
 *  @param          min   [integer], wartosc minimalna zakresu walidacji
 *  @param          max   [boolean], wartosc maksymalna zakresu walidacji
 *  @param          chars [array],   tablica zmienianych znakow
 *                  przyklad: replaceChars={ "#":"" , "_":" " }; 
 *
 *  @todo           zweryfikowac parametr chars!!!
 */
function validate(ctrl, min, max, chars) {
  var val = ctrl.val();
  var status = ((parseInt(val*10) >= parseInt(min*10)) && (parseInt(val*10) <= parseInt(max*10))); 

  if(status) { 
    ctrl.attr("style", "color: black; font-weight: normal;");
    ctrl.css("background-color", "transparent");
    ctrl.css("border","2px solid transparent");
  } else {
    ctrl.attr("style", "color: black; font-weight: bold;");
    ctrl.css("background-color","#FF9999");
    ctrl.css("border","2px solid red");
  }

  //console.log(val);

  return status;
}

/**
 *  @brief          countDecimals(value)
 *  @description    Funkcja zwracająca ilość cyfr po przecinku.
 *
 *  @param          value [float], wartość zmiennoprzecinkowa.
 */
function countDecimals(value) {
    if(Math.floor(value) == value) return 0;
    return value.toString().split(".")[1].length || 0;
}

function getDevType() {
  var type;

  $.ajax({
    type: 'GET',
    url: "api/dev/" + id + "/info",
    timeout: 500,
    dataType: 'json',
    async: false,
    success: function(data) {
      type = data["info"]["id"];
      id = data["info"]["moduleID"];
    },
    error: function() {
    }
  });

  switch(type) {
    case 18: name = "EKD.M3 (" + (id - 64) + ")";  break;
    case 19: name = "EKCO.M3 (" + (id - 64) + ")"; break;
    default: name = "";
  }
  return name;
}

/**
 *  @brief          getMinute(ctrl)
 *  @description    Funkcja pobierająca wartość minut z kontrolki.
 *
 *  @param          ctrl [handle)], uchwyt do kontrolki.
 */
function getMinute(ctrl) {
  var data = document.getElementById(ctrl).value.split(":");
  return (parseInt(data[0]) * 60) + parseInt(data[1]);
}

function nodot(evt) {
    var keycode = evt.charCode || evt.keyCode;
    if(keycode = 44) { return false; }
    if(keycode = 46) { return false; }
}

function showLoadingSpinner(){
	$("#spinnerBackground").show();
	$("#spinnerWheel").show();
}

function showLoadingSpinnerWithDelay(){
	setTimeout(function() 
	{
		$("#spinnerBackground").show();
		$("#spinnerWheel").show();
	}, 150);	
}

function showLoadingSpinnerWithCustomDelay(delay){
	setTimeout(function() 
	{
		$("#spinnerBackground").show();
		$("#spinnerWheel").show();
	}, delay);	
}

function hideLoadingSpinner(){
	$("#spinnerWheel").hide();
	$("#spinnerBackground").hide();
}	

function hideLoadingSpinnerWithDelay(){
	setTimeout(function() 
	{
		$("#spinnerWheel").hide();
		$("#spinnerBackground").hide();
	}, 150);	
}

function hideLoadingSpinnerWithCustomDelay(delay){
	setTimeout(function() 
	{
		$("#spinnerWheel").hide();
		$("#spinnerBackground").hide();
	}, delay);	
}
</script>

<div class="loading_background" id="spinnerBackground"></div>

<div  class="spinnerWheel_params" id="spinnerWheel">
    <div class="spinnerWheel_loader"></div>	 
</div>

<style>
	.loading_background {
		display: none;
		position: relative;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		background-color: #fff;
		opacity: 0.9;
		z-index: 95;
	}

	.spinnerWheel_params {
		display: none;
		position: absolute;
		top: 0;
		left: 0;
		width: 100%;
		height: 100%;
		background-color: #fff;
		opacity: 1.0;
		z-index: 100;
	}
	
	.spinnerWheel_loader {
		width: auto;
		height: 100%;
		background: url("img/spinnerWheel.gif") no-repeat center center transparent;
		background-size: 20% auto;
		position: relative;
		top: 0%;
		z-index: 100;
	}
</style>
<!-- /start mode -->
<div data-role="dialog" id="m_start__mode" data-close-btn="right">
  <div data-role="header"><h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">tryb pracy</a></h1></div>
  <div data-role="content">
    <div data-role="controlgroup">
      <input name="radio-choice-v-2" id="m_start__mode_off" type="radio" value="0" data-iconpos="right">
      <label for="m_start__mode_off">postojowy</label>
      <input name="radio-choice-v-2" id="m_start__mode_summer" type="radio" value="1" data-iconpos="right">
      <label for="m_start__mode_summer">lato</label>
      <input name="radio-choice-v-2" id="m_start__mode_winter" type="radio" value="2" data-iconpos="right">
      <label for="m_start__mode_winter">zima</label>
    </div>
    <br>
    <div data-role="controlgroup">
      <input id="m_start__mode_party" onclick="window.location.href = '#m_start__mode_party_dlg'; showLoadingSpinner();" name="radio-choice-v-3" type="radio" data-iconpos="right">
      <label for="m_start__mode_party">party</label>
      <input id="m_start__mode_vacation" onclick="window.location.href = '#m_start__mode_vacation_dlg'; showLoadingSpinner();" name="radio-choice-v-3" type="radio" data-iconpos="right">
      <label for="m_start__mode_vacation">wakacje</label>
      <input id="m_start__mode_manual" onclick="window.location.href = '#m_start__mode_manual_dlg'; showLoadingSpinner();" name="radio-choice-v-3" type="radio" data-iconpos="right">
      <label for="m_start__mode_manual">ręczny</label>
    </div>
  </div>
</div>
<!-- /start mode: end -->

<script>$(document).on("pagechange", function () { if($("#m_start__mode").is(":visible")) 
{ 
    m_start__get_mode(); 
	hideLoadingSpinner();
}});

$("#m_start__mode").off("pagehide").on("pagehide",function(){
    if ($("#start").is(":visible"))
    {
		showLoadingSpinner();
    }
});

/* stany checkboxów przy wyborze trybów */
	var off_last_checked = false;
	var summer_last_checked = false;
	var winter_last_checked = false;

/* eventy na zmianę checkboxów i aktualizacja wyświetlania i ich stanów */	
$("#m_start__mode_off").on("change", function(){
    if ($("#m_start__mode").is(":visible")){
		if ($("#m_start__mode_off").prop("checked") && !off_last_checked){
			off_last_checked = true;
			summer_last_checked = false;
			winter_last_checked = false;
			
			m_start__refresh_modes_display(summer_last_checked,winter_last_checked);	
			m_index__mode_set(off_last_checked,summer_last_checked,winter_last_checked);				
		}
	}
});

$("#m_start__mode_summer").on("change", function(){
    if ($("#m_start__mode").is(":visible")){	
		if ($("#m_start__mode_summer").prop("checked") && !summer_last_checked){
			off_last_checked = false;
			summer_last_checked = true;
			winter_last_checked = false;
			
			m_start__refresh_modes_display(summer_last_checked,winter_last_checked);	
			m_index__mode_set(off_last_checked,summer_last_checked,winter_last_checked);
		}
	}
});

$("#m_start__mode_winter").on("change", function(){
    if ($("#m_start__mode").is(":visible")){	
		if ($("#m_start__mode_winter").prop("checked") && !winter_last_checked){
			off_last_checked = false;
			summer_last_checked = false;
			winter_last_checked = true;
			
			m_start__refresh_modes_display(summer_last_checked,winter_last_checked);	
			m_index__mode_set(off_last_checked,summer_last_checked,winter_last_checked);
		}
	}
});

/* funkcja zmieniająca na sterowniku aktualny tryb */
function m_index__mode_set(off, summer, winter) {  
  reg = regToInt(getReg("0b55", "1")["0b55"]);
  if(off)    { reg = setBit(reg, 3, false); reg = setBit(reg, 5, false); }
  else if(summer) { reg = setBit(reg, 3, true);  reg = setBit(reg, 5, false); }
  else if(winter) { reg = setBit(reg, 3, false); reg = setBit(reg, 5, true);  }
  setReg("0b55", regToHex(reg));
}

/* pobranie aktualnego trybu */
function m_start__get_mode() {
  var reg           = regToInt(getReg("0b55", "1")["0b55"]);
  var stat_party    = getBit(reg, 6);
  var stat_vacation = getBit(reg, 7);
  var stat_manual   = getBit(reg, 9);
  var winter = getBit(reg, 5);
  var summer = getBit(reg, 3);

  $("#m_start__mode_off").prop("checked", false).checkboxradio("refresh");
  $("#m_start__mode_summer").prop("checked", false).checkboxradio("refresh");
  $("#m_start__mode_winter").prop("checked", false).checkboxradio("refresh");  
  
  if(getBit(reg, 4)) {
    if(summer) { $("#m_start__mode_summer").prop("checked", true).checkboxradio("refresh");}  
    $("#m_start__mode_summer").parent().show();
  } else { 
    $("#m_start__mode_summer").parent().hide();
  }

  if(winter) { $("#m_start__mode_winter").prop("checked", winter).checkboxradio("refresh"); }
  if(!summer && !winter) { $("#m_start__mode_off").prop("checked", true).checkboxradio("refresh"); }  
  
  var ctrl_party    = $("#m_start__mode_party");
  var ctrl_vacation = $("#m_start__mode_vacation");
  var ctrl_manual   = $("#m_start__mode_manual");

  if(stat_party)    { ctrl_party.prop("checked", true).checkboxradio("refresh");    } else { ctrl_party.prop("checked", false).checkboxradio("refresh");    }
  if(stat_vacation) { ctrl_vacation.prop("checked", true).checkboxradio("refresh"); } else { ctrl_vacation.prop("checked", false).checkboxradio("refresh"); }
  if(stat_manual)   { ctrl_manual.prop("checked", true).checkboxradio("refresh");   } else { ctrl_manual.prop("checked", false).checkboxradio("refresh");   }

  ctrl_party.checkboxradio('enable').checkboxradio("refresh");
  ctrl_vacation.checkboxradio('enable').checkboxradio("refresh");
  ctrl_manual.checkboxradio('enable').checkboxradio("refresh");
  
  m_start__refresh_modes_display($("#m_start__mode_summer").prop("checked"),$("#m_start__mode_winter").prop("checked"), reg);
}

/* aktualizacja trybu w zależności od wybranego trybu */
function m_start__refresh_modes_display(summer, winter, register){
    if (register != null){
        var reg           = register;
    }else{
        var reg           = regToInt(getReg("0b55", "1")["0b55"]);
    }
    
    var stat_party    = getBit(reg, 6);
    var stat_vacation = getBit(reg, 7);
    var stat_manual   = getBit(reg, 9);

    if (summer){
        $("#m_start__mode_manual").parent().hide();
        if (stat_party){
            $("#m_start__mode_party").parent().show();
            $("#m_start__mode_vacation").parent().hide();
        }else if (stat_vacation){
            $("#m_start__mode_party").parent().hide();
            $("#m_start__mode_vacation").parent().show();
        }else{
            $("#m_start__mode_party").parent().show();
            $("#m_start__mode_vacation").parent().show();       
        }              
    }
    else if (winter){
        if (stat_party){
            $("#m_start__mode_party").parent().show();
            $("#m_start__mode_vacation").parent().hide();
            $("#m_start__mode_manual").parent().hide();
        }else if (stat_vacation){
            $("#m_start__mode_party").parent().hide();
            $("#m_start__mode_vacation").parent().show();
            $("#m_start__mode_manual").parent().hide();
        }else if (stat_manual){
            $("#m_start__mode_party").parent().hide();
            $("#m_start__mode_vacation").parent().hide();
            $("#m_start__mode_manual").parent().show();
        }else{
            $("#m_start__mode_party").parent().show();
            $("#m_start__mode_vacation").parent().show();
            $("#m_start__mode_manual").parent().show();        
        }         
    }else{
		$("#m_start__mode_party").parent().hide();
		$("#m_start__mode_vacation").parent().hide();
		$("#m_start__mode_manual").parent().hide();        
    }
}


function m_start__mode_change() {
//  var ctrl_party    = $("#m_start__mode_party");
//  var ctrl_vacation = $("#m_start__mode_vacation");
//  var ctrl_manual   = $("#m_start__mode_manual");

//  var mode_party    = ctrl_party.prop("checked");
//  var mode_vacation = ctrl_vacation.prop("checked");
//  var mode_manual   = ctrl_manual.prop("checked");

//  if(!mode_party)    { ctrl_party.checkboxradio("disable").checkboxradio("refresh");    }
//  if(!mode_vacation) { ctrl_vacation.checkboxradio("disable").checkboxradio("refresh"); }
//  if(!mode_manual)   { ctrl_manual.checkboxradio("disable").checkboxradio("refresh");   }

//  if(mode_party)     { window.location.href = '#m_start__mode_party_dlg';    }
//  if(mode_vacation)  { window.location.href = '#m_start__mode_vacation_dlg'; }
//  if(mode_manual)    { window.location.href = '#m_start__mode_manual_dlg';   }
}



</script>

<!-- /party -->
<div data-role="dialog" id="m_start__mode_party_dlg" data-close-btn="right">
  <div data-role="header"><h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">tryb party</a></h1></div>
  <div data-role="content">
    <ul data-role="listview" data-inset="true">
      <li class="ui-body" id="m_index_mode_party_time_li">
            <label id="m_index_mode_party_time_lbl" for="m_index_mode_party_time"><h1>czas trwania</h1></label>
			<label id="m_index_mode_party_time_info_1" style="display:none;">zakres: </label>
            <input data-clear-btn="false" id="m_index_mode_party_time" value="1" type="number">
      </li>
      <li class="ui-body" id="m_index_mode_party_time_off" style="display:none;">
        <table>
          <tr>
            <td><label><h1>czas zakończenia:</h1></label></td>
            <td><div id="m_index_mode_party_time_off_lbl">---</div></td>
          </tr>
        </table>
      </li>
      <li class="ui-body">
        <label><input name="checkbox-a" type="checkbox" id="m_index_mode_party_notice">Do odwołania</label>
      </li>
    </ul>
    <a id="m_index_mode_mod_btn" style="display:none;" data-role="button" onclick="m_start__mode_party_set(true);">modyfikuj</a>
    <a id="m_index_mode_set_btn" style="display:none;" data-role="button" onclick="m_start__mode_party_set(true);">uruchom</a>
    <a id="m_index_mode_clr_btn" data-role="button" onclick="m_start__mode_party_set(false);">zakończ</a>
  </div>
</div>

<script>$(document).on("pagechange", function () { if($("#m_start__mode_party_dlg").is(":visible")) { m_start__mode_party_show(); hideLoadingSpinner();}});

/* zmienne parametryczne */
var m_start__mode_party_stat_party     = false;
var m_start__mode_party_stat_vacation  = false;
var m_start__mode_party_stat_manual    = false;

var m_start__mode_party_minute         = 0;
var m_start__mode_party_hour           = 0;
var m_start__mode_party_day            = 0;
var m_start__mode_party_month          = 0;
var m_start__mode_party_year           = 0;

/* zmienne walidacyjne */
var m_start__mode_party_time_min = 1;
var m_start__mode_party_time_max = 24;
var m_start__mode_party_last_time = 1;

/* eventy na inputach - wyświetlanie zakresu oraz dynamiczna walidacja, reakcje interfejsu */	
$("#m_index_mode_party_time").on("focusin", function(){
    if ($("#m_start__mode_party_dlg").is(":visible")){
	$("#m_index_mode_party_time_info_1").show();
    }
});

$("#m_index_mode_party_time").on("focusout", function(){
    if ($("#m_start__mode_party_dlg").is(":visible")){
	$("#m_index_mode_party_time_info_1").hide();
    }
});

$("#m_index_mode_party_notice").change(function(){
    if ($("#m_start__mode_party_dlg").is(":visible")){
		if ($("#m_index_mode_party_notice").prop("checked")){
			$("#m_index_mode_party_time_info_1").hide();
			$("#m_index_mode_party_time_lbl").hide();
			$("#m_index_mode_party_time").parent().hide();
			$("#m_index_mode_party_time_li").css("display","none");
			$("#m_index_mode_set_btn").css("background-color","");
			$("#m_index_mode_set_btn").css("color","#000000");
			$("#m_index_mode_mod_btn").css("background-color","");
			$("#m_index_mode_mod_btn").css("color","#000000");
		}else{
			$("#m_index_mode_party_time").parent().show();
			$("#m_index_mode_party_time_lbl").show();
			$("#m_index_mode_party_time_li").css("display","");
			
			if (!validate($("#m_index_mode_party_time"), m_start__mode_party_time_min,  m_start__mode_party_time_max,  {})){
				$("#m_index_mode_set_btn").css("background-color","#CCCCCC");
				$("#m_index_mode_set_btn").css("color","#D9D9D9");
				$("#m_index_mode_mod_btn").css("background-color","#CCCCCC");
				$("#m_index_mode_mod_btn").css("color","#D9D9D9");
			}else{
				$("#m_index_mode_set_btn").css("background-color","");
				$("#m_index_mode_set_btn").css("color","#000000");
				$("#m_index_mode_mod_btn").css("background-color","");
				$("#m_index_mode_mod_btn").css("color","#000000");
			}
		}
    }
});

$("#m_index_mode_party_time").on("input", function(){
    if ($("#m_start__mode_party_dlg").is(":visible")){
		if (!validate($("#m_index_mode_party_time"), m_start__mode_party_time_min,  m_start__mode_party_time_max,  {})){
			$("#m_index_mode_set_btn").css("background-color","#CCCCCC");
			$("#m_index_mode_set_btn").css("color","#D9D9D9");
			$("#m_index_mode_mod_btn").css("background-color","#CCCCCC");
			$("#m_index_mode_mod_btn").css("color","#D9D9D9");
		}else{
			$("#m_index_mode_set_btn").css("background-color","");
			$("#m_index_mode_set_btn").css("color","#000000");
			$("#m_index_mode_mod_btn").css("background-color","");
			$("#m_index_mode_mod_btn").css("color","#000000");
		}
    }
});

/* ustawianie parametrów w trybie party po ich walidacji i powrót do panelu menu */
function m_start__mode_party_set(param) {
  var validation = true;
  if(!validate($("#m_index_mode_party_time"), m_start__mode_party_time_min,  m_start__mode_party_time_max,  {})) { validation = false; }	
	var notice = $('#m_index_mode_party_notice').prop("checked");
	
	var time   = $("#m_index_mode_party_time").val()
	var reg_time = getReg("0af6", "7");
	var reg_stat = regToInt(getReg("0b55", "1")["0b55"]);
	var timer    = "ffff,ffff,ffff,ffff,ffff,ffff";
	
	var year     = regToInt(reg_time['0afc']) + 2000;
	var month    = regToInt(reg_time['0afb']);
	var day      = regToInt(reg_time['0afa']);
	var hour     = regToInt(reg_time['0af8']); 
	var minute   = regToInt(reg_time['0af7']); 
	var second   = regToInt(reg_time['0af6']); 
	var date     = new Date(year, month, day, hour, minute, second, 0);
	
	if(validation && !notice && param){
		var date_new = new Date(date.valueOf() + (((parseInt(time) * 60) * 60000)));
		timer        = regToHex(date_new.getMinutes()) + ',' + regToHex(date_new.getHours()) + ',' + regToHex(date_new.getDate()) + ',' + regToHex(date_new.getMonth()) + ',' + regToHex(date_new.getFullYear() - 2000);
		setReg("0b6c", timer);
		setReg("0b55", regToHex(setBit(reg_stat, 6, param)));	
		m_start__mode_party_last_time = $("#m_index_mode_party_time").val();
		window.location.href = "#start";
		showLoadingSpinner();
	}else if (notice && param){
		timer = "0000,0000,0000,0000,0000";
		setReg("0b6c", timer);
		setReg("0b55", regToHex(setBit(reg_stat, 6, param)));	
		window.location.href = "#start";
		showLoadingSpinner();
	}else if (!param){
		var date_new = new Date(date.valueOf());
		timer        = regToHex(date_new.getMinutes()) + ',' + regToHex(date_new.getHours()) + ',' + regToHex(date_new.getDate()) + ',' + regToHex(date_new.getMonth()) + ',' + regToHex(date_new.getFullYear() - 2000);
		setReg("0b6c", timer);
		setReg("0b55", regToHex(setBit(reg_stat, 6, param)));	
		window.location.href = "#start";
		showLoadingSpinner();
	}
}

/* załadowanie parametrów trybu party  i ich wyświetlenie  */
function m_start__mode_party_show() {
  var reg_stat                       = regToInt(getReg("0b55", "1")["0b55"]);
  var reg_time                       = getReg("0b6c", "5");
  
  $("#m_index_mode_party_time_info_1").text("zakres: " + " 0 ÷ 24 " + "[godziny]");
  $("#m_index_mode_party_time").val(m_start__mode_party_last_time);
  
  m_start__mode_party_stat_party     = getBit(reg_stat, 6);

  m_start__mode_party_minute         = regToInt(reg_time["0b6c"]);
  m_start__mode_party_hour           = regToInt(reg_time["0b6d"]);
  m_start__mode_party_day            = regToInt(reg_time["0b6e"]);
  m_start__mode_party_month          = regToInt(reg_time["0b6f"]);
  m_start__mode_party_year           = regToInt(reg_time["0b70"]) + 2000;

  m_start__mode_party_refresh();
}

/* odświeżenie parametrów trybu party */
function m_start__mode_party_refresh() {
  var end_date = m_start__mode_party_year                    + '-' + 
                 ('0' + m_start__mode_party_month).slice(-2) + '-' +
                 ('0' + m_start__mode_party_day).slice(-2)   + ' ' +
                 ('0' + m_start__mode_party_hour).slice(-2)  + ':' +
                 ('0' + m_start__mode_party_minute).slice(-2);

  var party_notice       = $('#m_index_mode_party_notice');
  var party_time_li      = $("#m_index_mode_party_time_li");
  var party_time_off     = $("#m_index_mode_party_time_off");
  var party_time_off_lbl = $("#m_index_mode_party_time_off_lbl");
  var party_on_btn       = $("#m_index_mode_set_btn"); // handle to party on btn
  var party_off_btn      = $("#m_index_mode_clr_btn"); // handle to party off btn
  var party_mod_btn      = $("#m_index_mode_mod_btn"); // handle to party modify btn

  /* jezeli aktywny tryb do odwolania */
  if(m_start__mode_party_minute == "0000") {
     party_notice.prop("checked", true).checkboxradio("refresh"); 
  } else {
     party_notice.prop("checked", false).checkboxradio("refresh"); 
  }

  if(m_start__mode_party_stat_party & (m_start__mode_party_minute != "0000")) {
    party_time_off.attr("style", "display:yes");
    party_time_off_lbl.text(end_date);
  } else {
    party_time_off.attr("style", "display:none");
  }

  if(m_start__mode_party_stat_party) {
    party_on_btn.attr("style", "display:none");
    party_mod_btn.attr("style", "display:yes");
    party_off_btn.show();
  } else {
    party_on_btn.attr("style", "display:yes");
    party_mod_btn.attr("style", "display:none");
    party_off_btn.hide();
  }
  
  		if ($("#m_index_mode_party_notice").prop("checked")){
			$("#m_index_mode_party_time_info_1").hide();
			$("#m_index_mode_party_time_lbl").hide();
			$("#m_index_mode_party_time").parent().hide();
			$("#m_index_mode_party_time_li").css("display","none");
			$("#m_index_mode_set_btn").css("background-color","");
			$("#m_index_mode_set_btn").css("color","#000000");
			$("#m_index_mode_mod_btn").css("background-color","");
			$("#m_index_mode_mod_btn").css("color","#000000");
		}else{
			$("#m_index_mode_party_time").parent().show();
			$("#m_index_mode_party_time_lbl").show();
			$("#m_index_mode_party_time_li").css("display","");
			
			if (!validate($("#m_index_mode_party_time"), m_start__mode_party_time_min,  m_start__mode_party_time_max,  {})){
				$("#m_index_mode_set_btn").css("background-color","#CCCCCC");
				$("#m_index_mode_set_btn").css("color","#D9D9D9");
				$("#m_index_mode_mod_btn").css("background-color","#CCCCCC");
				$("#m_index_mode_mod_btn").css("color","#D9D9D9");
			}else{
				$("#m_index_mode_set_btn").css("background-color","");
				$("#m_index_mode_set_btn").css("color","#000000");
				$("#m_index_mode_mod_btn").css("background-color","");
				$("#m_index_mode_mod_btn").css("color","#000000");
			}
		}
}


</script>
<!-- /vacation -->
<div data-role="dialog" id="m_start__mode_vacation_dlg" data-close-btn="right">
  <div data-role="header"><h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">tryb wakacje</a></h1></div>
  <div data-role="content">
    <ul data-role="listview" data-inset="true">
      <li class="ui-body" id="m_index_mode_vacation_li">
        <label id="m_index_mode_vacation_time_time_lbl" for="setting_vacation_time">Czas trwania trybu WAKACJE</label>
		<label id="m_index_mode_vacation_time_time_info_1" style="display:none;">zakres: </label>
        <input id="m_index_mode_vacation_time" data-clear-btn="false" name="setting_vacation_time" value="1" type="number">
      </li>

      <li class="ui-body" id="m_index_mode_vacation_time_off" style="display:none;">
        <table>
          <tr>
            <td><label><h1>czas zakończenia:</h1></label></td>
            <td><div id="m_index_mode_vacation_time_off_lbl">---</div></td>
          </tr>
        </table>
      </li>

      <li class="ui-body">
        <label><input name="checkbox-0 " type="checkbox" id="m_index_mode_vacation_notice">Do odwołania</label>
      </li>
    </ul>
    <a id="m_index_mode_vacation_mod_btn" style="display:none;" data-role="button" onclick="m_start__mode_vacation_set(true);">modyfikuj</a>
    <a id="m_index_mode_vacation_set_btn" style="display:none;" data-role="button" onclick="m_start__mode_vacation_set(true);">uruchom</a>
    <a id="m_index_mode_vacation_clr_btn" data-role="button" onclick="m_start__mode_vacation_set(false);">zakończ</a>
  </div>
</div>

<script>$(document).on("pagechange", function () { if($("#m_start__mode_vacation_dlg").is(":visible")) { m_start__mode_vacation_show(); hideLoadingSpinner();}});

/* zmienne parametryczne */
var m_start__mode_vacation_stat   = false;
var m_start__mode_vacation_minute = 0;
var m_start__mode_vacation_hour   = 0;
var m_start__mode_vacation_day    = 0;
var m_start__mode_vacation_month  = 0;
var m_start__mode_vacation_year   = 0;

/* zmienne walidacyjne */
var m_start__mode_vacation_day_min = 1;
var m_start__mode_vacation_day_max = 60;
var m_start__mode_vacation_last_day = 1;

/* eventy na inputach - wyświetlanie zakresu, dynamiczna walidacja oraz reakcje interfejsowe*/
$("#m_index_mode_vacation_time").on("focusin", function(){
    if ($("#m_start__mode_vacation_dlg").is(":visible")){
	$("#m_index_mode_vacation_time_time_info_1").show();
    }
});

$("#m_index_mode_vacation_time").on("focusout", function(){
    if ($("#m_start__mode_vacation_dlg").is(":visible")){
	$("#m_index_mode_vacation_time_time_info_1").hide();
    }
});

$("#m_index_mode_vacation_notice").change(function(){
    if ($("#m_start__mode_vacation_dlg").is(":visible")){
		if ($("#m_index_mode_vacation_notice").prop("checked")){
			$("#m_index_mode_vacation_time_time_info_1").hide();
			$("#m_index_mode_vacation_time_time_lbl").hide();
			$("#m_index_mode_vacation_time").parent().hide();
			$("#m_index_mode_vacation_li").css("display","none");
			$("#m_index_mode_vacation_set_btn").css("background-color","");
			$("#m_index_mode_vacation_set_btn").css("color","#000000");
			$("#m_index_mode_vacation_mod_btn").css("background-color","");
			$("#m_index_mode_vacation_mod_btn").css("color","#000000");
		}else{
			$("#m_index_mode_vacation_time").parent().show();
			$("#m_index_mode_vacation_time_time_lbl").show();
			$("#m_index_mode_vacation_li").css("display","");
			
			if (!validate($("#m_index_mode_vacation_time"), m_start__mode_vacation_day_min,  m_start__mode_vacation_day_max,  {})){
				$("#m_index_mode_vacation_set_btn").css("background-color","#CCCCCC");
				$("#m_index_mode_vacation_set_btn").css("color","#D9D9D9");
				$("#m_index_mode_vacation_mod_btn").css("background-color","#CCCCCC");
				$("#m_index_mode_vacation_mod_btn").css("color","#D9D9D9");
			}else{
				$("#m_index_mode_vacation_set_btn").css("background-color","");
				$("#m_index_mode_vacation_set_btn").css("color","#000000");
				$("#m_index_mode_vacation_mod_btn").css("background-color","");
				$("#m_index_mode_vacation_mod_btn").css("color","#000000");
			}
		}
    }
});

$("#m_index_mode_vacation_time").on("input", function(){
    if ($("#m_start__mode_vacation_dlg").is(":visible")){
		if (!validate($("#m_index_mode_vacation_time"), m_start__mode_vacation_day_min,  m_start__mode_vacation_day_max,  {})){
			$("#m_index_mode_vacation_set_btn").css("background-color","#CCCCCC");
			$("#m_index_mode_vacation_set_btn").css("color","#D9D9D9");
			$("#m_index_mode_vacation_mod_btn").css("background-color","#CCCCCC");
			$("#m_index_mode_vacation_mod_btn").css("color","#D9D9D9");
		}else{
			$("#m_index_mode_vacation_set_btn").css("background-color","");
			$("#m_index_mode_vacation_set_btn").css("color","#000000");
			$("#m_index_mode_vacation_mod_btn").css("background-color","");
			$("#m_index_mode_vacation_mod_btn").css("color","#000000");
		}
    }
});

/* ustawianie parametrów w trybie wakacyjnym po ich walidacji i powrót do panelu menu */
function m_start__mode_vacation_set(param) {
  var validation = true;
  if(!validate($("#m_index_mode_vacation_time"), m_start__mode_vacation_day_min,  m_start__mode_vacation_day_max,  {})) { validation = false; }	
	var notice = $('#m_index_mode_vacation_notice').prop("checked");
	
	var time   = $("#m_index_mode_vacation_time").val()
	var reg_time = getReg("0af6", "7");
	var reg_stat = regToInt(getReg("0b55", "1")["0b55"]);
	var timer    = "ffff,ffff,ffff,ffff,ffff,ffff";
	
	var year     = regToInt(reg_time['0afc']) + 2000;
	var month    = regToInt(reg_time['0afb']);
	var day      = regToInt(reg_time['0afa']);
	var hour     = regToInt(reg_time['0af8']); 
	var minute   = regToInt(reg_time['0af7']); 
	var second   = regToInt(reg_time['0af6']); 
	var date     = new Date(year, month, day, hour, minute, second, 0);
	
	if(validation && !notice && param){
		var date_new = new Date(date.valueOf() + (parseInt(time) * 86400000) - 86400000);
		timer        = regToHex(59) + ',' + regToHex(23) + ',' + regToHex(date_new.getDate()) + ',' + regToHex(date_new.getMonth()) + ',' + regToHex(date_new.getFullYear() - 2000);
		setReg("0b6c", timer);
		setReg("0b55", regToHex(setBit(reg_stat, 7, param)));	
		m_start__mode_vacation_last_day = $("#m_index_mode_vacation_time").val();
		window.location.href = "#start";
		showLoadingSpinner();
	}else if (notice && param){
		timer = "0000,0000,0000,0000,0000";
		setReg("0b6c", timer);
		setReg("0b55", regToHex(setBit(reg_stat, 7, param)));	
		window.location.href = "#start";
		showLoadingSpinner();
	}else if (!param){
		var date_new = new Date(date.valueOf());
		timer        = regToHex(date_new.getMinutes()) + ',' + regToHex(date_new.getHours()) + ',' + regToHex(date_new.getDate()) + ',' + regToHex(date_new.getMonth()) + ',' + regToHex(date_new.getFullYear() - 2000);
		setReg("0b6c", timer);
		setReg("0b55", regToHex(setBit(reg_stat, 7, param)));	
		window.location.href = "#start";
		showLoadingSpinner();
	}
}

/* załadowanie parametrów trybu wakacyjnego i ich wyświetlenie */
function m_start__mode_vacation_show() {
  var reg_stat                  = regToInt(getReg("0b55", "1")["0b55"]);
  var reg_time                  = getReg("0b6c", "5");

			
  $("#m_index_mode_vacation_time_time_info_1").text("zakres: " + " 1 ÷ 60 " + "[dni]");  
  $("#m_index_mode_vacation_time").val(m_start__mode_vacation_last_day);
  
  m_start__mode_vacation_stat   = getBit(reg_stat, 7);

  m_start__mode_vacation_minute = regToInt(reg_time["0b6c"]);
  m_start__mode_vacation_hour   = regToInt(reg_time["0b6d"]);
  m_start__mode_vacation_day    = regToInt(reg_time["0b6e"]);
  m_start__mode_vacation_month  = regToInt(reg_time["0b6f"]);
  m_start__mode_vacation_year   = regToInt(reg_time["0b70"]) + 2000;

  m_start__mode_vacation_refresh();
}

/* odświeżenie parametrów trybu wakacyjnego */
function m_start__mode_vacation_refresh() {
  var end_date = m_start__mode_vacation_year                    + '-' + 
                 ('0' + m_start__mode_vacation_month).slice(-2) + '-' +
                 ('0' + m_start__mode_vacation_day).slice(-2)   + ' ' +
                 ('0' + m_start__mode_vacation_hour).slice(-2)  + ':' +
                 ('0' + m_start__mode_vacation_minute).slice(-2);

  var vacation_notice       = $('#m_index_mode_vacation_notice');
  var vacation_on_btn       = $("#m_index_mode_vacation_set_btn"); // handle to vacation on btn
  var vacation_off_btn      = $("#m_index_mode_vacation_clr_btn"); // handle to vacation off btn
  var vacation_mod_btn      = $("#m_index_mode_vacation_mod_btn"); // handle to vacation modify btn

  var vacation_time_li      = $("#m_index_mode_vacation_time_li");
  var vacation_time_off     = $("#m_index_mode_vacation_time_off");
  var vacation_time_off_lbl = $("#m_index_mode_vacation_time_off_lbl");

  /* jezeli aktywny tryb do odwolania */
  if(m_start__mode_vacation_hour == "0000") {
     vacation_notice.prop("checked", true).checkboxradio("refresh"); 
  } else {
     vacation_notice.prop("checked", false).checkboxradio("refresh"); 
  }

  if(m_start__mode_vacation_stat & (m_start__mode_vacation_hour != "0000")) {
    vacation_time_off.attr("style", "display:yes");
    vacation_time_off_lbl.text(end_date);
  } else {
    vacation_time_off.attr("style", "display:none");
  }

  if(m_start__mode_vacation_stat) {
    vacation_on_btn.attr("style", "display:none");
    vacation_mod_btn.attr("style", "display:yes");
    vacation_off_btn.show();
  } else {
    vacation_on_btn.attr("style", "display:yes");
    vacation_mod_btn.attr("style", "display:none");
    vacation_off_btn.hide();
  }
  
  	if ($("#m_index_mode_vacation_notice").prop("checked")){
		$("#m_index_mode_vacation_time_time_info_1").hide();
		$("#m_index_mode_vacation_time_time_lbl").hide();
		$("#m_index_mode_vacation_time").parent().hide();
		$("#m_index_mode_vacation_li").css("display","none");
		$("#m_index_mode_vacation_set_btn").css("background-color","");
		$("#m_index_mode_vacation_set_btn").css("color","#000000");
		$("#m_index_mode_vacation_mod_btn").css("background-color","");
		$("#m_index_mode_vacation_mod_btn").css("color","#000000");
	}else{
		$("#m_index_mode_vacation_time").parent().show();
		$("#m_index_mode_vacation_time_time_lbl").show();
		$("#m_index_mode_vacation_li").css("display","");
			
		if (!validate($("#m_index_mode_vacation_time"), m_start__mode_vacation_day_min,  m_start__mode_vacation_day_max,  {})){
			$("#m_index_mode_vacation_set_btn").css("background-color","#CCCCCC");
			$("#m_index_mode_vacation_set_btn").css("color","#D9D9D9");
			$("#m_index_mode_vacation_mod_btn").css("background-color","#CCCCCC");
			$("#m_index_mode_vacation_mod_btn").css("color","#D9D9D9");
		}else{
			$("#m_index_mode_vacation_set_btn").css("background-color","");
			$("#m_index_mode_vacation_set_btn").css("color","#000000");
			$("#m_index_mode_vacation_mod_btn").css("background-color","");
			$("#m_index_mode_vacation_mod_btn").css("color","#000000");
		}
	}  
}


</script>
<!-- /manual -->
<div data-role="dialog" id="m_start__mode_manual_dlg" data-close-btn="right">
  <div data-role="header"><h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">tryb ręczny</a></h1></div>
  <div data-role="content">
    <ul data-role="listview" data-inset="true">
      <li class="ui-body"> 
            <label for="setting_hand_temp">Temperatura: </label>
			
			<label id="setting_hand_temp_info1" style="display:none;">zakres: </label>
			
            <input id="m_start_mode_manual_temp" data-clear-btn="false" name="setting_hand_temp" type="number" step="0.1">
      </li>
    </ul>
    <a id="m_start_mode_manual_set_btn" data-role="button" onclick="m_start__mode_hand_set(true);">uruchom</a>
    <a id="m_start_mode_manual_clr_btn" data-role="button" onclick="m_start__mode_hand_set(false);">zakończ</a>
  </div>
</div>

<script>$(document).on("pagechange", function () { if($("#m_start__mode_manual_dlg").is(":visible")) { m_start__mode_hand_show(); hideLoadingSpinner();}});

/* zmienne walidacyjne */
var mode_manual_temp_min = 0;
var mode_manual_temp_max = 0;

/* eventy na inputach - wyświetlanie zakresu oraz dynamiczna walidacja */	
$("#m_start_mode_manual_temp").on("focusin", function(){
    if ($("#m_start__mode_manual_dlg").is(":visible")){
	$("#setting_hand_temp_info1").show();
    }
});

$("#m_start_mode_manual_temp").on("focusout", function(){
    if ($("#m_start__mode_manual_dlg").is(":visible")){
	$("#setting_hand_temp_info1").hide();
    }
});

$("#m_start_mode_manual_temp").on("input", function(){
    if ($("#m_start__mode_manual_dlg").is(":visible")){
		if (!validate($("#m_start_mode_manual_temp"), mode_manual_temp_min,  mode_manual_temp_max,  {})){
			$("#m_start_mode_manual_set_btn").css("background-color","#CCCCCC");
			$("#m_start_mode_manual_set_btn").css("color","#D9D9D9");
		}else{
			$("#m_start_mode_manual_set_btn").css("background-color","");
			$("#m_start_mode_manual_set_btn").css("color","#000000");
		}
    }
});

/* ustawianie parametrów w trybie ręcznym po ich walidacji i powrót do panelu menu */
function m_start__mode_hand_set(param) {
  var validation = true;

  if(!validate($("#m_start_mode_manual_temp"), mode_manual_temp_min,  mode_manual_temp_max,  {})) { validation = false; }
  
  if(validation && param) {
    var reg_stat = regToInt(getReg("0b55", "1")["0b55"]);
    var temp     = parseInt($('#m_start_mode_manual_temp').val() * 10);
    setReg("0b8d", regToHex(temp));
    setReg("0b55", regToHex(setBit(reg_stat, 9, param))); 
    window.location.href = "#start";
	showLoadingSpinner();
  } else if (!param){
    var reg_stat = regToInt(getReg("0b55", "1")["0b55"]);
    setReg("0b55", regToHex(setBit(reg_stat, 9, param))); 
    window.location.href = "#start";
	showLoadingSpinner();
  }
}

/* załadowanie parametrów trybu ręcznego  i ich wyświetlenie */
function m_start__mode_hand_show() {
  var reg_val = getReg("0bcc", "2");
  mode_manual_temp_min = parseInt(regToInt(reg_val["0bcc"]))/10;
  mode_manual_temp_max = parseInt(regToInt(reg_val["0bcd"]))/10;
	
  var text = "zakres: " + mode_manual_temp_min + " ÷ " + mode_manual_temp_max + " " + "[°C]";
  $("#setting_hand_temp_info1").text(text.replace(/\./g,","));
	
  var reg_stat = regToInt(getReg("0b55", "1")["0b55"]);
  var reg_temp = regToInt(getReg("0b8d", "1")["0b8d"]) / 10;
  var status   = getBit(reg_stat, 9);

  $("#m_start_mode_manual_temp").val(reg_temp.toFixed(1));

  var hand_set_btn = $("#m_start_mode_manual_set_btn"); // handle to hand on btn
  var hand_clr_btn = $("#m_start_mode_manual_clr_btn"); // handle to hand off btn

  if(status) {
	$("#m_start_mode_manual_set_btn").show();
	$("#m_start_mode_manual_clr_btn").show();
	$("#m_start_mode_manual_set_btn").text("modyfikuj");
  } else {
	$("#m_start_mode_manual_set_btn").show();
    $("#m_start_mode_manual_clr_btn").hide();
	$("#m_start_mode_manual_set_btn").text("uruchom");
  }
  
  if (!validate($("#m_start_mode_manual_temp"), mode_manual_temp_min,  mode_manual_temp_max,  {})){
		$("#m_start_mode_manual_set_btn").css("background-color","#CCCCCC");
		$("#m_start_mode_manual_set_btn").css("color","#D9D9D9");
  }else{
		$("#m_start_mode_manual_set_btn").css("background-color","");
		$("#m_start_mode_manual_set_btn").css("color","#000000");
  }
}

function m_start__mode_hand_refresh() {

//  var hand_notice       = $('#m_index_mode_hand_notice');
//  var hand_on_btn       = $("#m_index_mode_hand_set_btn"); // handle to hand on btn
//  var hand_off_btn      = $("#m_index_mode_hand_clr_btn"); // handle to hand off btn
//  var hand_mod_btn      = $("#m_index_mode_hand_mod_btn"); // handle to hand modify btn

//  var hand_time_li      = $("#m_index_mode_hand_time_li");
//  var hand_time_off     = $("#m_index_mode_hand_time_off");
//  var hand_time_off_lbl = $("#m_index_mode_hand_time_off_lbl");

  /* jezeli aktywny tryb do odwolania */
//  if(m_start__mode_hand_hour == "0000") {
//     hand_notice.prop("checked", true).checkboxradio("refresh"); 
//  } else {
//     hand_notice.prop("checked", false).checkboxradio("refresh"); 
//  }

//  if(m_start__mode_hand_stat & (m_start__mode_hand_hour != "0000")) {
//    hand_time_off.attr("style", "display:yes");
//    hand_time_off_lbl.text(end_date);
//  } else {
//    hand_time_off.attr("style", "display:none");
//  }

//  if(m_start__mode_hand_stat) {
//    hand_on_btn.attr("style", "display:none");
//    hand_mod_btn.attr("style", "display:yes");
//    hand_off_btn.removeClass("ui-disabled");
//  } else {
//    hand_on_btn.attr("style", "display:yes");
//    hand_mod_btn.attr("style", "display:none");
//    hand_off_btn.addClass("ui-disabled");
//  }
}


</script>




<!-- page: #settings -->
<div data-role="page" id="settings" data-theme="a">

  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">ustawienia</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
  </div>

  <div role="main" class="ui-body">
    <a onclick="showLoadingSpinner();" id="settings_room_temp_btn" href="#settings_room_temp" style="display:none;" class="ui-btn ui-shadow ui-corner-all">temperatury pokojowe</a>
    <a onclick="showLoadingSpinner();" id="settings_boil_temp_btn" href="#settings_boil_temp" style="display:none;" class="ui-btn ui-shadow ui-corner-all">temperatura cwu</a>
    <a onclick="showLoadingSpinner();" id="settings_prg_co_btn"href="#settings_prg_co" style="display:none;" class="ui-btn ui-shadow ui-corner-all">programator co</a>
    <a onclick="showLoadingSpinner();" id="settings_prg_buffer_btn"href="#settings_prg_co" style="display:none;" class="ui-btn ui-shadow ui-corner-all">programator bufora</a>
    <a onclick="showLoadingSpinner();" id="settings_prg_boil_btn" style="display:none;" href="#settings_prg_boil" class="ui-btn ui-shadow ui-corner-all">programator cwu</a>
    <a onclick="showLoadingSpinner();" id="settings_prg_circ_btn" style="display:none;" href="#settings_prg_circ" class="ui-btn ui-shadow ui-corner-all">programator cyrkulacji</a>
    <a onclick="showLoadingSpinner();" id="settings_disinfection_btn" style="display:none;" href="#settings_disinfection" class="ui-btn ui-shadow ui-corner-all">dezynfekcja zasobnika</a>
    <a id="" href="#settings_date" class="ui-btn ui-shadow ui-corner-all" onclick="set_date_ref(); showLoadingSpinner();">data i czas</a>
    <a onclick="showLoadingSpinner();" id="" href="#settings_system" class="ui-btn ui-shadow ui-corner-all">system</a>
    <!--<a href="#settings_co" class="ui-btn ui-shadow ui-corner-all">Ustawienia regulatora pogodowego</a>-->
  </div>

</div><!-- /page settings -->

<script>$(document).on("pagechange", function () { if($("#settings").is(":visible")) { setSettings(); hideLoadingSpinnerWithDelay(); }});

/* wczytanie menu ustawień */
function setSettings() {
  reg  = getReg("0b54", "2");
  cfg1 = regToInt(reg["0b55"]);
  cfg2 = regToInt(reg["0b54"]);
  buff = regToInt(getReg("0b8a", "1")["0b8a"]);


  if(getBit(cfg1, 4) && !getBit(cfg1, 2)) {
    $("#settings_boil_temp_btn").attr("style", "display:yes;");
    $("#settings_prg_boil_btn").attr("style", "display:yes;"); 
    $("#settings_disinfection_btn").attr("style", "display:yes;"); 
  }

  if(getBit(cfg2, 2)) {
    $("#settings_prg_circ_btn").attr("style", "display:yes;");
  }

  switch(buff) {
    case 0:
      if(!getBit(cfg1, 1)) {
        $("#settings_room_temp_btn").attr("style", "display:yes;");
        $("#settings_prg_co_btn").attr("style", "display:yes;");
      } else {
        $("#settings_room_temp_btn").attr("style", "display:none;");
        $("#settings_prg_co_btn").attr("style", "display:none;");
      }
      break;
    case 1:
      $("#settings_prg_co_btn").attr("style", "display:yes;"); 
      $("#settings_prg_buffer_btn").attr("style", "display:none;");
      $("#settings_room_temp_btn").attr("style", "display:yes;");
      break;
    case 2:
      $("#settings_prg_co_btn").attr("style", "display:none;"); 
      $("#settings_prg_buffer_btn").attr("style", "display:yes;");
      $("#settings_room_temp_btn").attr("style", "display:yes;");
      break;
    default:
      $("#settings_prg_co_btn").attr("style", "display:none;"); 
      $("#settings_prg_buffer_btn").attr("style", "display:none;");
      $("#settings_room_temp_btn").attr("style", "display:none;");
  }
}
</script>

<!-- page: #settings_disinfection -->
<div data-role="page" id="settings_disinfection" data-theme="a">

  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">Dezynfekcja</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#settings" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main">
    <div class="ui-body">
      <ul data-role="listview" data-inset="true">
        <li class="ui-body">
           <label for="settings_disinfection_temp">Temperatura dezynfekcji:</label>
			<label id="sett_dis_info_1" style="display:none;">zakres: </label>
           <input data-clear-btn="false" name="settings_disinfection_temp" id="settings_disinfection_temp" onchange="sett_disinfection_modify = true;" type="number">
        </li>
        <li class="ui-body">
          <label for="settings_disinfection_day">Dzień tygodnia</label>
          <select name="settings_disinfection_day" id="settings_disinfection_day" onchange="sett_disinfection_modify = true;">
            <option value="0">poniedziałek</option>
            <option value="1">wtorek</option>
            <option value="2">Środa</option>
            <option value="3">Czwartek</option>
            <option value="4">piątek</option>
            <option value="5">sobota</option>
            <option value="6">niedziela</option>
          </select>
        </li>
        <li class="ui-body">
          <label for="settings_disinfection_hour">Godzina dezynfekcji</label>
          <input name="settings_disinfection_hour" id="settings_disinfection_hour" type="time" onchange="sett_disinfection_modify = true;">
        </li>
        <li class="ui-body">
           <label for="settings_disinfection_time">Czas trwania dezynfekcji</label>
			<label id="sett_dis_info_2" style="display:none;">zakres: </label>
           <input data-clear-btn="false" name="settings_disinfection_time" id="settings_disinfection_time" onchange="sett_disinfection_modify = true;">
        </li>
        <li class="ui-body">
          <label><input id="settings_disinfection_auto" type="checkbox" onchange="sett_disinfection_modify = true;">Praca automatyczna</label>
        </li>
        <li class="ui-body">
          <label><input id="settings_disinfection_circ" type="checkbox" onchange="sett_disinfection_modify = true;">Z cyrkulacją</label>
        </li>
        <li class="ui-body">
          <label><input id="settings_disinfection_now" type="checkbox" onchange="sett_disinfection_modify = true;">Natychmiastowy start</label>
        </li>
      </ul>

      <a id="sett_disinfection_save" data-direction="reverse" class="ui-btn ui-shadow ui-corner-all ui-btn-b" onclick="setDisinfection();">zapisz i zamknij okno</a>

    </div>
  </div>

</div>

<script>$(document).on("pagechange", function () { if($("#settings_disinfection").is(":visible")) { refSettDis(); hideLoadingSpinner(); }});

/* zmienne walidacyjne */
  var sett_disinfection_modify     = false;
  var sett_disinfection_temp_min   = 0;
  var sett_disinfection_temp_max   = 0;
  var sett_disinfection_time_min   = 0;
  var sett_disinfection_time_max   = 0;

/* eventy na inputach - wyświetlanie zakresu oraz dynamiczna walidacja */
$("#settings_disinfection_temp").on("focusin", function(){
    if ($("#settings_disinfection").is(":visible")){
	$("#sett_dis_info_1").show();
    }
});
  
$("#settings_disinfection_temp").on("focusout", function(){
    if ($("#settings_disinfection").is(":visible")){
	$("#sett_dis_info_1").hide();
    }
});  
  
$("#settings_disinfection_time").on("focusin", function(){
    if ($("#settings_disinfection").is(":visible")){
	$("#sett_dis_info_2").show();
    }
});
  
$("#settings_disinfection_time").on("focusout", function(){
    if ($("#settings_disinfection").is(":visible")){
	$("#sett_dis_info_2").hide();
    }
});  
  
$("#settings_disinfection_temp").on("input", function(){
    if ($("#settings_disinfection").is(":visible")){
		check_validation_sett_dis();
    }
});  
  
$("#settings_disinfection_time").on("input", function(){
    if ($("#settings_disinfection").is(":visible")){
		check_validation_sett_dis();
    }
});  
  
$("#settings_disinfection_hour").on("change", function(){
		check_validation_sett_dis();
});  

/* funckja walidująca poprawność kontrolek */
function check_validation_sett_dis(){
		var validation = true;
		
		if (!validate($("#settings_disinfection_temp"), sett_disinfection_temp_min,  sett_disinfection_temp_max,  {})){
			validation = false;
		}

		if (!validate($("#settings_disinfection_time"), sett_disinfection_time_min,  sett_disinfection_time_max,  {})){
			validation = false;
		}
		
		if ($("#settings_disinfection_hour").val() == ""){
			$("#settings_disinfection_hour").attr("style", "color: black; font-weight: bold;");
			$("#settings_disinfection_hour").css("background-color","#FF9999");
			$("#settings_disinfection_hour").css("border","2px solid red")			
			validation = false;
		}
		else{
			$("#settings_disinfection_hour").attr("style", "color: black; font-weight: normal;");
			$("#settings_disinfection_hour").css("background-color", "transparent");
			$("#settings_disinfection_hour").css("border","2px solid transparent");			
		}

		if (validation){
			$("#sett_disinfection_save").css("background-color","");
			$("#sett_disinfection_save").css("color","#000000");
		}
		else{
			$("#sett_disinfection_save").css("background-color","#CCCCCC");
			$("#sett_disinfection_save").css("color","#D9D9D9");
		}
		
		
		return validation;
}  
  
/* ładowanie zmiennych i zakresów walidacyjnych */
  function refSettDis() {
    /* pobranie dopuszczalnych zakresow dla temperatury i czasu */
    rang = getReg("0bda", "4");
    sett_disinfection_temp_min = parseInt(regToInt(rang["0bda"])/10);
    sett_disinfection_temp_max = parseInt(regToInt(rang["0bdb"])/10);
    sett_disinfection_time_min = regToInt(rang["0bdc"]);
    sett_disinfection_time_max = regToInt(rang["0bdd"]);

    var text = "zakres: " + sett_disinfection_temp_min + " ÷ " + sett_disinfection_temp_max + " " + "[°C]";
    $("#sett_dis_info_1").text(text.replace(/\./g,","));    
    text = "zakres: " + sett_disinfection_time_min + " ÷ " + sett_disinfection_time_max + " " + "[min]";
    $("#sett_dis_info_2").text(text.replace(/\./g,","));    
    
    res  = getReg("0b54", "26");
    $("#settings_disinfection_time").val(regToInt(res['0b79']));

    var hour = res['0b78'];
    hour = parseInt('0x' + hour.substring(2) + hour.substring(-2, 2));
    var H = '0'.repeat(2 - parseInt(hour / 60).toString().length) + parseInt(hour / 60).toString();
    var m = '0'.repeat(2 - (hour % 60).toString().length) + (hour % 60).toString();
    $("#settings_disinfection_hour").val(H+":"+m);

    $("#settings_disinfection_temp").val(parseInt(regToInt(res['0b76']) / 10));
    $("#settings_disinfection_day").val(parseInt(regToInt(res['0b77']))).change();

    $('#settings_disinfection_circ').prop("checked", getRegBit("0b54", 5)).checkboxradio("refresh");
    $('#settings_disinfection_now').prop("checked", getRegBit("0b54", 6)).checkboxradio("refresh");
    $('#settings_disinfection_auto').prop("checked", getRegBit("0b54", 7)).checkboxradio("refresh");
	
    sett_disinfection_modify = false;
	check_validation_sett_dis();
  }
  
/* ustawianie parametrów po dokonaniu walidacji, po sukcesie powrót do menu opcji */
  function setDisinfection() {

    var _temp = parseInt($("#settings_disinfection_temp").val() * 10);
    var _day  = parseInt($("#settings_disinfection_day").val());
    var _hour = (parseInt($("#settings_disinfection_hour").val().split(":")[0]) * 60) + parseInt($("#settings_disinfection_hour").val().split(":")[1]);
    var _time = parseInt($("#settings_disinfection_time").val());
    var _auto = $('#settings_disinfection_auto').prop("checked");
    var _circ = $('#settings_disinfection_circ').prop("checked");
    var _now  = $('#settings_disinfection_now').prop("checked");

    if(check_validation_sett_dis()) {
      param = regToHex(_temp, false) + "," + regToHex(_day, false) + "," + regToHex(_hour, false) + "," + regToHex(_time, false);
      setReg("0b76", param);
      setRegBit("0b54", 5, _circ);
      setRegBit("0b54", 6, _now);
      setRegBit("0b54", 7, _auto);
	  
	  window.location.href = "#settings"; 
    }
  }</script>
<!-- /page settings_disinfection -->

<!-- page: #settings_date -->
<div data-role="page" id="settings_date" data-theme="a">

  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">data i czas</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#settings" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main" id="settings_date_main">
    <div class="ui-body">

      <ul data-role="listview" data-inset="true">
        <li class="ui-body">
          <label for="settings_date_dev">Data i czas w urządzeniu</label>
          <input name="settings_date_dev" id="settings_date_dev" type="datetime" disabled="disabled">
        </li>
        <li class="ui-body">
          <label><input name="checkbox-0 " type="checkbox" id="setting_system_time">automatyczna zmiana czasu</label>
        </li>
      </ul>

      <a id="sett_date_save" data-direction="reverse" class="ui-btn ui-shadow ui-corner-all ui-btn-b" onclick="set_date_save();">zapisz i zamknij okno</a>

    </div>
  </div>

</div>
<script>$(document).on("pagechange", function () { if($("#settings_date").is(":visible")) { set_date_ref();  hideLoadingSpinner();}});

/* odświeżanie kontrolek */
  $(function() {
    setInterval(set_date_ref_timer, 10000);
  });
  
/* aktualizacja kontrolek z timera */
  function set_date_ref_timer() {
    if($("#settings_date").is(":visible") == true ) {
      refresh_date_view();
    }
  };

  function refresh_date_view(){
    var dt      = getReg("0af7", "6"); 
    var m = ('0' + regToInt(dt['0af7'])).slice(-2);
    var H = ('0' + regToInt(dt['0af8'])).slice(-2);
    var d = ('0' + regToInt(dt['0afa'])).slice(-2);
    var M = ('0' + regToInt(dt['0afb'])).slice(-2);
    var Y = parseInt(2000 + regToInt(dt['0afc']));      
    $("#settings_date_dev").val(Y + '-' + M + '-' + d + ' ' + H + ':' + m);  
  }
  
  /**
   *  @description  Funkcja pobierajaca czas z API i aktualizujaca kontrolki.
   */
  function set_date_ref() {
    var config2 = regToInt(getReg("0b54", "1")["0b54"]);
    var tc      = getBit(config2, 3);
    $('#setting_system_time').prop("checked", tc);
    refresh_date_view();
  };

/**
 *  @description  Funkcja zapisujaca i weryfikujaca dane.
 */
function set_date_save() {
		var auto    = $("#setting_system_time").prop("checked");
		var config2 = regToInt(getReg("0b54", "1")["0b54"])
		config2 = setBit(config2, 3, auto);
		setReg("0b54", regToHex(config2));				   
		window.location.href = "#settings"; 
}
</script>
<!-- /page settings_date -->

<!-- page: #settings_system -->
<div data-role="page" id="settings_system" data-theme="a">
  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">system</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#settings" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main">
    <div class="ui-body">

      <br>
      <ul data-role="listview" data-inset="true">
        <li class="ui-body">
          <table width="100%">
            <tr>
              <th>wersja programu MSK:</th>
              <td id="prg_ver" align="right">--</td>
           </tr>
           <tr>
             <th>wersja programu PW: </th>
             <td id="pw_ver" align="right">--</td>
           </tr>
           <tr>
             <th>maksymalna moc kotła: </th>
             <td id="pwr" align="right">--</td>
           </tr>
          </table>
        </li>
        <li class="ui-body">
          <div><a href="#settings_system_reset_dlg" class="ui-btn ui-icon-power ui-btn-icon-left">restart kotła</a></div>
        </li>
      </ul>
    </div>
  </div>
</div>

<div data-role="dialog" id="settings_system_reset_dlg" data-title="Are you sure?">
  <div data-role="header"><h1>restart</h1></div>
  <div data-role="content">
    <p>czy potwierdzasz restart kotła?</p>
    <a href="#" class="sure-do" data-role="button" data-theme="b" data-rel="back" onclick="setRegBit('0b53', 0, true);">tak</a>
    <a href="#" data-role="button" data-theme="c" data-rel="back">nie</a>
  </div>
</div>

<script>$(document).on("pagechange", function () { if($("#settings_system").is(":visible")) { get_system(); hideLoadingSpinner();}});

/* pobranie danych systemowych */
  function get_system() {
	  
	/* power */
    var reg = getReg("0b34", "1");
    var pwr = regToInt(reg["0b34"]) / 10;
    $("#pwr").text(pwr + 'kW');
	
    /* time */
    $('#setting_system_time').prop("checked", getRegBit("0b54", 3)); 
	  
    /* info */
    $.ajax({
      type: 'GET',
      url: "api/dev/" + id + "/info",
      timeout: 5000,
      dataType: 'json',
      async: false,
      success: function(data) {
        console.log(data);
        $("#prg_ver").text(data["info"]["prg_msk_type"] + "." + data["info"]["prg_msk_ver"]);
        $("#pw_ver").text(data["info"]["prg_pw_type"] + "." + data["info"]["prg_pw_ver"]);
      },
      error: function() {
        alert('HTML Error');
      }
    });
	
  }</script>
<!-- /page settings_system -->

<!-- page: #settings_room_temp -->
<div data-role="page" id="settings_room_temp" data-theme="a">
  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">temperatury<br />
pokojowe</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline" href="#settings">&nbsp;</a>
  </div>

  <div role="main">
    <div class="ui-body">
      <ul data-role="listview" data-inset="true">
        <li class="ui-body">
          <table width="100%"><tr>
            <td width="20%"><img src="img/tecon.svg"></td>
            <td width="80%">
			<label for="settings_room_temp_economic">temperatura ekonomiczna</label>
			<label id="sett_room_temp_info_1" style="display:none;">zakres: </label>
			<input data-clear-btn="false" name="settings_room_temp_economic" id="settings_room_temp_economic" type="number" step="0.1"></td>
          </tr></table>
        </li>
        <li class="ui-body">
          <table width="100%"><tr>
            <td width="20%"><img src="img/tconf.svg"></td>
            <td width="80%">
			<label for="settings_room_temp_comfort">temperatura komfortowa</label>
			<label id="sett_room_temp_info_2" style="display:none;">zakres: </label>
			<input data-clear-btn="false" name="settings_room_temp_comfort" id="settings_room_temp_comfort" type="number" step="0.1"></td>
          </tr></table>
        </li>
        <li class="ui-body">
          <table width="100%"><tr>
            <td width="20%"><img src="img/tconfp.svg"></td>
            <td width="80%">
			<label for="settings_room_temp_comfort_plus">temperatura komfortowa +</label>
			<label id="sett_room_temp_info_3" style="display:none;">zakres: </label>
			<input data-clear-btn="false" name="settings_room_temp_comfort_plus" id="settings_room_temp_comfort_plus" type="number" step="0.1"></td>
          </tr></table>
        </li>
        <li class="ui-body">
          <table width="100%"><tr>
            <td width="20%"><img src="img/tconfm.svg"></td>
            <td width="80%">
			<label for="settings_room_temp_comfort_minus">temperatura komfortowa -</label>
			<label id="sett_room_temp_info_4" style="display:none;">zakres: </label>
			<input data-clear-btn="false" name="settings_room_temp_comfort_minus" id="settings_room_temp_comfort_minus" type="number" step="0.1"></td>
          </tr></table>
        </li>
        <li class="ui-body">
          <label for="settings_room_temp_party">temperatura dla trybu party</label>
          <select name="settings_room_temp_party" id="settings_room_temp_party">
            <option value="2">temperatura komfortowa</option>
            <option value="4">temperatura komfortowa +</option>
            <option value="3">temperatura komfortowa -</option>
          </select>
        </li>
        <li class="ui-body">
          <label for="settings_room_temp_vacation">temperatura dla trybu wakacje</label>
          <select name="settings_room_temp_vacation" id="settings_room_temp_vacation">
            <option value="1">temperatura przeciwzamrożeniowa</option>
            <option value="0">temperatura ekonomiczna</option>
          </select>
        </li>
      </ul>
      <p><a id="sett_room_temp_save" data-direction="reverse" class="ui-btn ui-shadow ui-corner-all ui-btn-b" onclick="save_settings_room_temp();">zapisz i zamknij okno</a></p>
    </div>
  </div>
</div>
<!-- /page settings -->

<script>$(document).on("pagechange", function () { if($("#settings_room_temp").is(":visible")) { get_settings_room_temp(); hideLoadingSpinner(); }});

/* zmienne walidacyjne */
  var sett_room_temp_min   = 0;
  var sett_room_temp_max   = 0;

/* eventy na inputach - wyświetlanie zakresu oraz dynamiczna walidacja */	
$("#settings_room_temp_economic").on("focusin", function(){
    if ($("#settings_room_temp").is(":visible")){
		$("#sett_room_temp_info_1").show();
    }
});

$("#settings_room_temp_economic").on("focusout", function(){
    if ($("#settings_room_temp").is(":visible")){
		$("#sett_room_temp_info_1").hide();
    }
});

$("#settings_room_temp_economic").on("input", function(){
    if ($("#settings_room_temp").is(":visible")){
		check_validation_sett_room_temp();
    }
});

$("#settings_room_temp_comfort").on("focusin", function(){
    if ($("#settings_room_temp").is(":visible")){
		$("#sett_room_temp_info_2").show();
    }
});

$("#settings_room_temp_comfort").on("focusout", function(){
    if ($("#settings_room_temp").is(":visible")){
		$("#sett_room_temp_info_2").hide();
    }
});

$("#settings_room_temp_comfort").on("input", function(){
    if ($("#settings_room_temp").is(":visible")){
		check_validation_sett_room_temp();
    }
});

$("#settings_room_temp_comfort_plus").on("focusin", function(){
    if ($("#settings_room_temp").is(":visible")){
		$("#sett_room_temp_info_3").show();
    }
});

$("#settings_room_temp_comfort_plus").on("focusout", function(){
    if ($("#settings_room_temp").is(":visible")){
		$("#sett_room_temp_info_3").hide();
    }
});

$("#settings_room_temp_comfort_plus").on("input", function(){
    if ($("#settings_room_temp").is(":visible")){
		check_validation_sett_room_temp();
    }
});

$("#settings_room_temp_comfort_minus").on("focusin", function(){
    if ($("#settings_room_temp").is(":visible")){
		$("#sett_room_temp_info_4").show();
    }
});

$("#settings_room_temp_comfort_minus").on("focusout", function(){
    if ($("#settings_room_temp").is(":visible")){
		$("#sett_room_temp_info_4").hide();
    }
});

$("#settings_room_temp_comfort_minus").on("input", function(){
    if ($("#settings_room_temp").is(":visible")){
		check_validation_sett_room_temp();
    }
});

/* funkcja odpowiedzialna za walidację kontrolek */
function check_validation_sett_room_temp(){
		var validation = true;
		
		if (!validate($("#settings_room_temp_economic"), sett_room_temp_min,  sett_room_temp_max,  {})){
			validation = false;
		}

		if (!validate($("#settings_room_temp_comfort"), sett_room_temp_min,  sett_room_temp_max,  {})){
			validation = false;
		}
		
		if (!validate($("#settings_room_temp_comfort_plus"), sett_room_temp_min,  sett_room_temp_max,  {})){
			validation = false;
		}
		
		if (!validate($("#settings_room_temp_comfort_minus"), sett_room_temp_min,  sett_room_temp_max,  {})){
			validation = false;
		}

		if (validation){
			$("#sett_room_temp_save").css("background-color","");
			$("#sett_room_temp_save").css("color","#000000");
		}
		else{
			$("#sett_room_temp_save").css("background-color","#CCCCCC");
			$("#sett_room_temp_save").css("color","#D9D9D9");
		}
		
		return validation;
}  
  
  /**
   *  @brief        save_settings_room_temp()
   *  @description  Funkcja zapisujaca zmiany wartosci do kontrolek z walidacja
   */
  function save_settings_room_temp() {
    /* pobranie wartosci z kontrolek */
    var _room_temp_economic          = parseInt($("#settings_room_temp_economic").val().replace(/[°]/, "").replace(/[,]/, ".") * 10);
    var _room_temp_comfort           = parseInt($("#settings_room_temp_comfort").val().replace(/[°]/, "").replace(/[,]/, ".")* 10);
    var _room_temp_comfort_minus     = parseInt($("#settings_room_temp_comfort_minus").val().replace(/[°]/, "").replace(/[,]/, ".")* 10);
    var _room_temp_comfort_plus      = parseInt($("#settings_room_temp_comfort_plus").val().replace(/[°]/, "").replace(/[,]/, ".")* 10);
    var _settings_room_temp_party    = parseInt($("#settings_room_temp_party").val());
    var _settings_room_temp_vacation = parseInt($("#settings_room_temp_vacation").val());

    if(check_validation_sett_room_temp()) {
      setReg("0b63", regToHex(_settings_room_temp_party, false) + ',' + regToHex(_settings_room_temp_vacation));	
      setReg("0b68", regToHex(_room_temp_economic, false) + ',' + regToHex(_room_temp_comfort_minus, false) + ',' + regToHex(_room_temp_comfort, false) + ',' + regToHex(_room_temp_comfort_plus, false));	
      window.location.href = "#settings"; 
    }
  }

  /**
   *  @brief        get_settings_room_temp()
   *  @description  Funkcja pobierajaca wartosci do kontrolek
   */
  function get_settings_room_temp() {
    var reg1 = getReg("0bcc", "2");
    var reg2 = getReg("0b63", "9");

    sett_room_temp_min = parseFloat(regToInt(reg1['0bcc']) / 10).toFixed(1);
    sett_room_temp_max = parseFloat(regToInt(reg1['0bcd']) / 10).toFixed(1);
    
    var text = "zakres: " + sett_room_temp_min + " ÷ " + sett_room_temp_max + " " + "[°C]";
    $("#sett_room_temp_info_1").text(text.replace(/\./g,","));
    $("#sett_room_temp_info_2").text(text.replace(/\./g,",")); 
    $("#sett_room_temp_info_3").text(text.replace(/\./g,","));
    $("#sett_room_temp_info_4").text(text.replace(/\./g,","));        

    $("#settings_room_temp_economic").val((parseFloat(regToInt(reg2['0b68']) / 10)).toFixed(1));
    $("#settings_room_temp_comfort_minus").val((parseFloat(regToInt(reg2['0b69']) / 10)).toFixed(1));
    $("#settings_room_temp_comfort").val((parseFloat(regToInt(reg2['0b6a']) / 10)).toFixed(1));
    $("#settings_room_temp_comfort_plus").val((parseFloat(regToInt(reg2['0b6b']) / 10)).toFixed(1));
    $("#settings_room_temp_party").val(parseInt(reg2['0b63'].substring(-2, 2))).change();
    $("#settings_room_temp_vacation").val(parseInt(reg2['0b64'].substring(-2, 2))).change();
	
	check_validation_sett_room_temp();
  }</script>
<!-- page: #settings_boil_temp -->
<div data-role="page" id="settings_boil_temp" data-theme="a">
  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">temperatura cwu</a></h1>
    <a class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" href="#start" onclick="showLoadingSpinner();">&nbsp;</a>
    <a class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline" href="#settings">&nbsp;</a>
  </div>

  <div role="main">
    <div class="ui-body">
      <ul data-role="listview" data-inset="true">
        <li class="ui-body">
          <table width="100%"><tr>
            <td width="20%"><img src="img/tecon.svg"></td>
            <td width="80%"><label for="settings_boil_temp_economic">temperatura ekonomiczna</label>
			<label id="sett_boil_info_1" style="display:none;">zakres: </label>		
			<input data-clear-btn="false" name="settings_boil_temp_economic" id="settings_boil_temp_economic" type="number"></td>
          </tr></table>
        </li>
        <li class="ui-body">
          <table width="100%"><tr>
            <td width="20%"><img src="img/tconf.svg"></td>
            <td width="80%"><label for="settings_boil_temp_comfort">temperatura komfortowa</label>
			<label id="sett_boil_info_2" style="display:none;">zakres: </label>		
			<input data-clear-btn="false" name="settings_boil_temp_comfort" id="settings_boil_temp_comfort" type="number"></td>
          </tr></table>
        </li>
      </ul>
      <p><a id="sett_boil_save" data-direction="reverse" class="ui-btn ui-shadow ui-corner-all ui-btn-b" onclick="save_settings_boil_temp();">zapisz i zamknij okno</a></p>
    </div>
  </div>
</div>
<!-- /page settings_boil_temp -->

<script>$(document).on("pagechange", function () { if($("#settings_boil_temp").is(":visible")) { get_settings_boil_temp(); hideLoadingSpinner(); }});

/* zakresy walidacyjne */
  var sett_boil_temp_min   = 0;
  var sett_boil_temp_max   = 0;

/* eventy na inputach - wyświetlanie zakresu oraz dynamiczna walidacja */
$("#settings_boil_temp_economic").on("focusin", function(){
    if ($("#settings_boil_temp").is(":visible")){
	$("#sett_boil_info_1").show();
    }
});

$("#settings_boil_temp_economic").on("focusout", function(){
    if ($("#settings_boil_temp").is(":visible")){
	$("#sett_boil_info_1").hide();
    }
});

$("#settings_boil_temp_economic").on("input", function(){
    if ($("#settings_boil_temp").is(":visible")){
		check_validation_sett_boil();
    }
});

$("#settings_boil_temp_comfort").on("focusin", function(){
    if ($("#settings_boil_temp").is(":visible")){
	$("#sett_boil_info_2").show();
    }
});

$("#settings_boil_temp_comfort").on("focusout", function(){
    if ($("#settings_boil_temp").is(":visible")){
	$("#sett_boil_info_2").hide();
    }
});

$("#settings_boil_temp_comfort").on("input", function(){
    if ($("#settings_boil_temp").is(":visible")){
		check_validation_sett_boil();
    }
});

/* funkcja walidująca każdą z kontrolek*/
function check_validation_sett_boil(){
		var validation = true;
		
		if (!validate($("#settings_boil_temp_economic"), sett_boil_temp_min,  sett_boil_temp_max,  {})){
			validation = false;
		}

		if (!validate($("#settings_boil_temp_comfort"), sett_boil_temp_min,  sett_boil_temp_max,  {})){
			validation = false;
		}

		if (validation){
			$("#sett_boil_save").css("background-color","");
			$("#sett_boil_save").css("color","#000000");
		}
		else{
			$("#sett_boil_save").css("background-color","#CCCCCC");
			$("#sett_boil_save").css("color","#D9D9D9");
		}
		
		return validation;
}
  
/* zapis ustawień po udanej walidacji i powrót do menu */  
  function save_settings_boil_temp() {

    var _boil_temp_economic = parseInt($("#settings_boil_temp_economic").val().replace(/[°]/, "").replace(/[,]/, ".")) * 10;
    var _boil_temp_comfort  = parseInt($("#settings_boil_temp_comfort").val().replace(/[°]/, "").replace(/[,]/, "."))  * 10;

    if(check_validation_sett_boil()) {
      setReg("0b66", regToHex(_boil_temp_economic) + ',' +regToHex(_boil_temp_comfort));
      window.location.href = "#settings"; 
    }
  }

/* załadowanie ustawień ze sterownika */  
  function get_settings_boil_temp() {
    var reg1 = getReg("0bbe", "2");
    var reg2 = getReg("0b66", "2");

    sett_boil_temp_min = regToInt(reg1['0bbe']) / 10;
    sett_boil_temp_max = regToInt(reg1['0bbf']) / 10;
    
    var text = "zakres: " + sett_boil_temp_min + " ÷ " + sett_boil_temp_max + " " + "[°C]";
    $("#sett_boil_info_1").text(text.replace(/\./g,","));    
    $("#sett_boil_info_2").text(text.replace(/\./g,","));
                        
    $("#settings_boil_temp_economic").val(parseInt(regToInt(reg2['0b66']) / 10));
    $("#settings_boil_temp_comfort").val(parseInt(regToInt(reg2['0b67']) / 10));
	
	check_validation_sett_boil();
  }</script>
<!-- page: #settings_co -->
<div data-role="page" id="settings_co" data-theme="a">

  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">settings_co_title</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#settings" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main">

    <div class="ui-body">
      <ul data-role="listview" data-inset="true">
        <li class="ui-body">
           <label for="settings_co_nr">settings_co_nr:</label>
           <input data-clear-btn="false" name="settings_co_nr" id="settings_co_nr" value="12.3" type="number">
        </li>

        <li class="ui-body">
           <label for="settings_co_move">settings_co_move:</label>
           <input data-clear-btn="false" name="settings_co_move" id="settings_co_move" value="12.3" type="number">
        </li>

        <li class="ui-body">
          <label for="settings_co_temp">settings_co_temp:</label>
          <select name="settings_co_temp" id="settings_co_temp">
            <option value="1">const_hand</option>
            <option value="2">curve</option>
          </select>
        </li>

        <li class="ui-body">
           <label for="settings_co_temp_max">settings_co_temp_max:</label>
           <input data-clear-btn="false" name="settings_co_temp_max" id="settings_co_temp_max" value="12.3" type="number">
        </li>

        <li class="ui-body">
           <label for="settings_co_temp_man">settings_co_temp_man:</label>
           <input data-clear-btn="false" name="settings_co_temp_man" id="settings_co_temp_man" value="12.3" type="number">
        </li>

        <li class="ui-body">
           <label for="settings_co_outside_off">settings_co_outside_off:</label>
           <input data-clear-btn="false" name="settings_co_outside_off" id="settings_co_outside_off" value="12.3" type="number">
        </li>

        <li class="ui-body">
          <label for="settings_co_antifrost">settings_co_antifrost:</label>
          <select name="settings_co_antifrost" id="settings_co_antifrost" data-role="flipswitch">
            <option value="off">Off</option>
            <option value="on">On</option>
          </select>
        </li>
      </ul>

      <a href="#settings" data-direction="reverse" class="ui-btn ui-shadow ui-corner-all ui-btn-b">zapisz i zamknij okno</a>

    </div>

  </div>

</div>
<!-- /page config_turbo -->

<!-- page: #settings_prg_co -->
<div data-role="page" id="settings_prg_co" data-theme="a">
  <div data-role="header">
    <h1><a id="settings_prog_co_title" onclick="showLoadingSpinner();" href="#about" style="display:yes; color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">programator co</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#settings" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main" class="ui-content">
    <div class="ui-corner-all custom-corners">
      <div class="ui-bar ui-bar-a" align="center"><h1>program tygodniowy</h1></div>
      <div class="ui-body ui-body-a">
        <table width="100%">
          <tr><td><label for="settings_prg_co_monday">poniedziałek:</label></td><td><select name="settings_prg_co_monday" id="settings_prg_co_monday" onchange="savePrgCO(1);" onclick="sett_prg_co_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
</select></td></tr>
          <tr><td><label for="settings_prg_co_tuesday">wtorek:</label></td><td><select name="settings_prg_co_tuesday" id="settings_prg_co_tuesday" onchange="savePrgCO(2);" onclick="sett_prg_co_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
</select></td></tr>
          <tr><td><label for="settings_prg_co_wednesday">środa:</label></td><td><select name="settings_prg_co_wednesday" id="settings_prg_co_wednesday" onchange="savePrgCO(3);" onclick="sett_prg_co_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
</select></td></tr>
          <tr><td><label for="settings_prg_co_thursday">czwartek:</label></td><td><select name="settings_prg_co_thursday" id="settings_prg_co_thursday" onchange="savePrgCO(4);" onclick="sett_prg_co_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
</select></td></tr>
          <tr><td><label for="settings_prg_co_friday">piątek:</label></td><td><select name="settings_prg_co_friday" id="settings_prg_co_friday" onchange="savePrgCO(5);" onclick="sett_prg_co_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
</select></td></tr>
          <tr><td><label for="settings_prg_co_saturday">sobota:</label></td><td><select name="settings_prg_co_saturday" id="settings_prg_co_saturday" onchange="savePrgCO(6);" onclick="sett_prg_co_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
</select></td></tr>
          <tr><td><label for="settings_prg_co_sunday">niedziela:</label></td><td><select name="settings_prg_co_sunday" id="settings_prg_co_sunday" onchange="savePrgCO(7);" onclick="sett_prg_co_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
</select></td></tr>
        </table>
      </div>
    </div>
    <p><a href="#settings_prg_co_daily" class="ui-btn ui-shadow ui-corner-all">programy dzienne</a></p>
  </div>
</div>
<!-- /page settings_prg_co -->
 
<!-- page: #settings_prg_co_daily -->
<div data-role="page" id="settings_prg_co_daily" data-theme="a">

  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">programy dzienne</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#settings_prg_co" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main" class="ui-content">
    <a href="#settings_prg_co_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_co_daily(1);">program 1</a>
    <a href="#settings_prg_co_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_co_daily(2);">program 2</a>
    <a href="#settings_prg_co_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_co_daily(3);">program 3</a>
    <a href="#settings_prg_co_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_co_daily(4);">program 4</a>
    <a href="#settings_prg_co_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_co_daily(5);">program 5</a>
    <a href="#settings_prg_co_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_co_daily(6);">program 6</a>
    <a href="#settings_prg_co_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_co_daily(7);">program 7</a>
    <a href="#settings_prg_co_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_co_daily(8);">program 8</a>
  </div>
</div><!-- /page settings_prg_co_daily -->

<!-- /page: #settings_prg_co_daily_edit -->
<!-- /start: prog daily -->
<div data-role="page" id="settings_prg_co_daily_edit" data-theme="a">
  <div id="aaaa" style="visibility: hidden; display:inline;"></div>
  <div data-role="header">
    <h1><a id="settings_prg_co_daily_edit_title" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">program co nr</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#settings_prg_co_daily" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

<style>
.ui-icon-tecon:after {
    background-image: url("img/teconw.svg");
    background-size: 18px 18px;
    background-repeat: no-repeat;
    background-position: center;
}
.ui-icon-tconf:after {
    background-image: url("img/tconfw.svg");
    background-size: 18px 18px;
    background-repeat: no-repeat;
    background-position: center;
}
.ui-icon-tconfp:after {
    background-image: url("img/tconfpw.svg");
    background-size: 18px 18px;
    background-repeat: no-repeat;
    background-position: center;
}
.ui-icon-tconfm:after {
    background-image: url("img/tconfmw.svg");
    background-size: 18px 18px;
    background-repeat: no-repeat;
    background-position: center;
}
.ui-icon-pzam:after {
    background-image: url("img/pzamw.svg");
    background-size: 18px 18px;
    background-repeat: no-repeat;
    background-position: center;
}
.inlineIcon {
    display: inline-block;
    position: relative;
    vertical-align: middle;
    width: auto !important;
}
</style>


<div role="main">
  <div class="ui-body">
    <ul data-role="listview" data-inset="true">
      <li class="ui-body" id="sett_day_prg_co_li1">
        <table width="100%" cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td width="0.1%" align="center"><a href="#m_prg_co__del_pos" class="ui-btn ui-icon-delete ui-btn-icon-notext ui-shadow" onclick="m_prg_co__idx = 1;"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_co_start1" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_co_stop1" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="0.1%" align="center"><a id="m_prg_co__sel_temp1" href="#m_prg_co__sel_temp" class="ui-btn ui-icon-tconf ui-btn-icon-notext ui-shadow" onclick="m_prg_co__idx = 1;">65535</a></td>
          <tr>
          <tr>
            <td width="0.1%" align="center"><a href="#m_prg_co__del_pos" class="ui-btn ui-icon-delete ui-btn-icon-notext ui-shadow" onclick="m_prg_co__idx = 2;"></a></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_co_start2" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_co_stop2" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="0.1%" align="center"><a id="m_prg_co__sel_temp2" href="#m_prg_co__sel_temp" class="ui-btn ui-icon-tconfp ui-btn-icon-notext ui-shadow" onclick="m_prg_co__idx = 2;">65535</a></td>
          <tr>
          <tr>
            <td width="0.1%" align="center"><a href="#m_prg_co__del_pos" class="ui-btn ui-icon-delete ui-btn-icon-notext ui-shadow" onclick="m_prg_co__idx = 3;"></a></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_co_start3" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_co_stop3" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="0.1%" align="center"><a id="m_prg_co__sel_temp3" href="#m_prg_co__sel_temp" class="ui-btn ui-icon-tconfm ui-btn-icon-notext ui-shadow" onclick="m_prg_co__idx = 3;">65535</a></td>
          <tr>
          <tr>
            <td width="0.1%" align="center"><a href="#m_prg_co__del_pos" class="ui-btn ui-icon-delete ui-btn-icon-notext ui-shadow" onclick="m_prg_co__idx = 4;"></a></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_co_start4" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_co_stop4" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="0.1%" align="center"><a id="m_prg_co__sel_temp4" href="#m_prg_co__sel_temp" class="ui-btn ui-icon-tecon ui-btn-icon-notext ui-shadow" onclick="m_prg_co__idx = 4;">65535</a></td>
          <tr>
          <tr>
            <td width="0.1%" align="center"><a href="#m_prg_co__del_pos" class="ui-btn ui-icon-delete ui-btn-icon-notext ui-shadow" onclick="m_prg_co__idx = 5;"></a></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_co_start5" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_co_stop5" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="0.1%" align="center"><a  id="m_prg_co__sel_temp5" href="#m_prg_co__sel_temp" class="ui-btn ui-icon-bars ui-btn-icon-notext ui-shadow" onclick="m_prg_co__idx = 5;">65535</a></td>
          <tr>
        </table>
      </li>
    </ul>
    <p><a id="m_prg_co__daily_edit_save" data-direction="reverse" class="ui-btn ui-shadow ui-corner-all ui-btn-b" onclick="set_prog_co_daily();">zapisz i zamknij okno</a></p>
    </div>
  </div>
</div>
<!-- /end: prog daily -->


<div data-role="dialog" id="m_prg_co__del_pos" data-close-btn="right">
  <div data-role="header"><h1>usuwanie</h1></div>
  <div data-role="content">
    <p class="sure-2">czy chcesz usunąć wybraną pozycję z harmonogramu dobowego?</p>
    <table width="100%">
      <tr>
        <td><a href="#" class="sure-do" data-role="button" data-theme="b" data-rel="back" onclick="m_prg_co__del_pos();">tak</a></td>
        <td><a href="#" data-role="button" data-theme="c" data-rel="back">nie</a></td>
      </tr>
    </table>
  </div>
</div>



<!-- /start: temp. type selector -->
<div data-role="dialog" id="m_prg_co__sel_temp" data-close-btn="right">
  <div data-role="header"><h1>temperatury</h1></div>
  <div data-role="content">
    <div data-role="controlgroup">

      <input name="m_prg_co__sel_temp_group" id="m_prg_co__sel_temp__mode_pzam" type="radio" value="1" data-iconpos="right" onclick="m_prg_co__set_temp(1)">
      <label for="m_prg_co__sel_temp__mode_pzam">
        <table cellspacing="0" cellpadding="0" width="100%">
          <tr>
            <td align="center"><span class="ui-btn-icon-notext ui-icon-pzam" style="position: relative"/></td>
            <td>&nbsp;</td>
            <td width="100%">przeciwzamrożeniowa</td>
          </tr>
        </table>
      </label>

      <input name="m_prg_co__sel_temp_group" id="m_prg_co__sel_temp__mode_conf" type="radio" value="2" data-iconpos="right" onclick="m_prg_co__set_temp(2)">
      <label for="m_prg_co__sel_temp__mode_conf">
        <table cellspacing="0" cellpadding="0" width="100%">
          <tr>
            <td align="center"><span class="ui-btn-icon-notext ui-icon-tconf" style="position: relative"/></td>
            <td>&nbsp;</td>
            <td width="100%">komfortowa</td>
          </tr>
        </table>
      </label>

      <input name="m_prg_co__sel_temp_group" id="m_prg_co__sel_temp__mode_confm" type="radio" value="3" data-iconpos="right" onclick="m_prg_co__set_temp(3)">
      <label for="m_prg_co__sel_temp__mode_confm">
        <table cellspacing="0" cellpadding="0" width="100%">
          <tr>
            <td align="center"><span class="ui-btn-icon-notext ui-icon-tconfm" style="position: relative"/></td>
            <td>&nbsp;</td>
            <td width="100%">komfortowa -</td>
          </tr>
        </table>
      </label>


      <input name="m_prg_co__sel_temp_group" id="m_prg_co__sel_temp__mode_confp" type="radio" value="4" data-iconpos="right" onclick="m_prg_co__set_temp(4)">
      <label for="m_prg_co__sel_temp__mode_confp">
        <table cellspacing="0" cellpadding="0" width="100%">
          <tr>
            <td align="center"><span class="ui-btn-icon-notext ui-icon-tconfp" style="position: relative"/></td>
            <td>&nbsp;</td>
            <td width="100%">komfortowa +</td>
          </tr>
        </table>
      </label>
    </div>
  </div>
</div>
<!-- /stop: temp. type selector -->

<script>$(document).on("pagechange", function () {
    if ($("#settings_prg_co").is(":visible")) 
    {
        refreshPrgCO();
		hideLoadingSpinner();
    }
    if ($("#m_prg_co__sel_temp").is(":visible"))
    {
        m_prg_co__set_temp_show();
		hideLoadingSpinner();
    }
    if ($("#settings_prg_co_daily_edit").is(":visible"))
    {
    // refreshPrgCOEdit();
	hideLoadingSpinner();
    }
});

/* zmienne parametryczne */
var sett_prg_co_modify               = false;
var m_prg_co__idx                    = 0;

/**
 *  @brief        m_prg_co_daily_check_time_conflicts(start, stop, temp, c_start, c_stop)
 *  @description  Funkcja walidująca zakres czasowy dla harmonogramu.
 *
 *  @param        start   <integer>, początek sprawdzanego zakresu czasowego.
 *  @param        koniec  <integer>, koniec sprawdzanego zakresu czasowego.
 *  @param        c_start <integer>, początek porównywanego okresu czasu.
 *  @param        c_stop  <integer>, koniec porównywanego okresu czasu.
 */
function m_prg_co_daily_check_time_conflicts(start, stop, c_start, c_stop) {
  if((stop - start) <= 0)                   { return 1; }
  if((start < c_start) & (stop  < c_start)) { return 0;  }
  if((stop  > c_stop)  & (start > c_stop))  { return 0;  }
  return 1;
}

function m_prg_co__sel_temp(nr) {
  console.log('set ' + nr);
  $('#m_prg_co__sel_temp').dialog('close');
}

/* eventy do walidacji programu dziennego */
$("#sett_day_prg_co_start1").on("change", function(){ m_prg_co_daily_check_each_validation(false); });
$("#sett_day_prg_co_start2").on("change", function(){ m_prg_co_daily_check_each_validation(false); });
$("#sett_day_prg_co_start3").on("change", function(){ m_prg_co_daily_check_each_validation(false); });
$("#sett_day_prg_co_start4").on("change", function(){ m_prg_co_daily_check_each_validation(false); });
$("#sett_day_prg_co_start5").on("change", function(){ m_prg_co_daily_check_each_validation(false); });
$("#sett_day_prg_co_stop1").on("change", function(){ m_prg_co_daily_check_each_validation(false); });
$("#sett_day_prg_co_stop2").on("change", function(){ m_prg_co_daily_check_each_validation(false); });
$("#sett_day_prg_co_stop3").on("change", function(){ m_prg_co_daily_check_each_validation(false); });
$("#sett_day_prg_co_stop4").on("change", function(){ m_prg_co_daily_check_each_validation(false); });
$("#sett_day_prg_co_stop5").on("change", function(){ m_prg_co_daily_check_each_validation(false); });

/* funkcja walidująca pola w harmonogramie dziennym */
function m_prg_co_daily_validate(start, stop, siteBool, mode){
	var validation = false;
	if ($("#settings_prg_co_daily_edit").is(":visible") || siteBool){
		validation = true;	
							
		/* sprawdzanie czy pola są puste oraz czy prawa część jest większa od lewej */
		if(start.val() && !stop.val()){	
			start.parent().attr("style", "color: black; font-weight: normal;");
			start.parent().css("background-color", "transparent");
			start.parent().css("border","2px solid transparent");				
			stop.parent().attr("style", "color: black; font-weight: bold;");
			stop.parent().css("background-color","#FF9999");
			stop.parent().css("border","2px solid red");
			m_prg_co_check_mode(mode);
			validation = false;
		}
		else if(!start.val() && stop.val()){	
			start.parent().attr("style", "color: black; font-weight: bold;");
			start.parent().css("background-color","#FF9999");
			start.parent().css("border","2px solid red");
			stop.parent().attr("style", "color: black; font-weight: normal;");
			stop.parent().css("background-color", "transparent");
			stop.parent().css("border","2px solid transparent");
			m_prg_co_check_mode(mode);
			validation = false;
		}
		else if(start.val() && stop.val()){
			if(start.val() >= stop.val()){	
				start.parent().attr("style", "color: black; font-weight: bold;");
				start.parent().css("background-color","#FF9999");
				start.parent().css("border","2px solid red");	
				stop.parent().attr("style", "color: black; font-weight: bold;");
				stop.parent().css("background-color","#FF9999");
				stop.parent().css("border","2px solid red");
				m_prg_co_check_mode(mode);
				validation = false;
			}
			else{
				start.parent().attr("style", "color: black; font-weight: normal;");
				start.parent().css("background-color", "transparent");
				start.parent().css("border","2px solid transparent");
				stop.parent().attr("style", "color: black; font-weight: normal;");
				stop.parent().css("background-color", "transparent");
				stop.parent().css("border","2px solid transparent");
							
				if(!(m_prg_co_check_mode(mode))){
					validation = false;	
				}
							
				/* sprawdzanie kolizji czasu */
				var actual_start = getMinute(start.attr("id"));
				var actual_stop = getMinute(stop.attr("id"));
				if(!isNaN(actual_start) && !isNaN(actual_stop)){
	
					var check_start; var check_stop;
					for(var i = 1; i <= 5; i++) {
						check_start = getMinute("sett_day_prg_co_start" + i);
						check_stop  = getMinute("sett_day_prg_co_stop"  + i);
						
						if(!isNaN(check_start) && !isNaN(check_stop)){ 
							if(start.attr("id") != ("sett_day_prg_co_start" + i) && stop.attr("id") != ("sett_day_prg_co_stop" + i)) {
								if(m_prg_co_daily_check_time_conflicts(actual_start,actual_stop,check_start,check_stop))
								{ 
									start.parent().attr("style", "color: black; font-weight: bold;");
									start.parent().css("background-color","#FF9999");
									start.parent().css("border","2px solid red");
									stop.parent().attr("style", "color: black; font-weight: bold;");
									stop.parent().css("background-color","#FF9999");
									stop.parent().css("border","2px solid red");
									validation = false;
								}
							}
						}
					}
				}				
			}
		}
		else if (!start.val() && !stop.val()){
				start.parent().attr("style", "color: black; font-weight: normal;");
				start.parent().css("background-color", "transparent");
				start.parent().css("border","2px solid transparent");
				stop.parent().attr("style", "color: black; font-weight: normal;");
				stop.parent().css("background-color", "transparent");
				stop.parent().css("border","2px solid transparent");
				mode.css("border","2px solid transparent");
				mode.css("background-color", "transparent");
		}			
    }
	return validation;
}

/* sprawdzanie przycisku trybu, czy nie jest "nieokreślony" */
function m_prg_co_check_mode(mode){
		if (mode.text() == "1" || mode.text() == "2" || mode.text() == "3" || mode.text() == "4"){
			mode.css("border","2px solid transparent");
			mode.css("background-color", "transparent");
			return true;
		}
		else{
			mode.css("border","2px solid red");
			mode.css("background-color","#FF9999");
			return false;
		}	
}

/* sprawdzanie każdego wiersza harmonogramu */
function m_prg_co_daily_check_each_validation(siteBool) {
	var validation = false;
	if ($("#settings_prg_co_daily_edit").is(":visible") || siteBool){
		validation = true;
		if (!m_prg_co_daily_validate($("#sett_day_prg_co_start1"),$("#sett_day_prg_co_stop1"),siteBool,$("#m_prg_co__sel_temp1"))) validation = false;
		if (!m_prg_co_daily_validate($("#sett_day_prg_co_start2"),$("#sett_day_prg_co_stop2"),siteBool,$("#m_prg_co__sel_temp2"))) validation = false;
		if (!m_prg_co_daily_validate($("#sett_day_prg_co_start3"),$("#sett_day_prg_co_stop3"),siteBool,$("#m_prg_co__sel_temp3"))) validation = false;
		if (!m_prg_co_daily_validate($("#sett_day_prg_co_start4"),$("#sett_day_prg_co_stop4"),siteBool,$("#m_prg_co__sel_temp4"))) validation = false;
		if (!m_prg_co_daily_validate($("#sett_day_prg_co_start5"),$("#sett_day_prg_co_stop5"),siteBool,$("#m_prg_co__sel_temp5"))) validation = false;
		
		if (validation){
			$("#m_prg_co__daily_edit_save").css("background-color","");
			$("#m_prg_co__daily_edit_save").css("color","#000000");
		}
		else{
			$("#m_prg_co__daily_edit_save").css("background-color","#CCCCCC");
			$("#m_prg_co__daily_edit_save").css("color","#D9D9D9");
		}
	}
	return validation;
}

/**
 *  pobranie programu dziennego 
 */
function get_prg_co_daily(nr) {
  var regs = getReg(regToHex(3100 + (15 * (nr - 1)), true), "0f");

  $("#aaaa").text(nr);

  buff = regToInt(getReg("0b8a", "1")["0b8a"]);
  if(buff == 2) {
	  $("#settings_prg_co_daily_edit_title").text('program bufora nr ' + nr);
  } else {
	  $("#settings_prg_co_daily_edit_title").text('program co nr ' + nr);
  }

  for(i = 0; i < 5; i++) {
    var start = regs[intToHex(3100 + (15 * (nr - 1)) + (i * 2))];
    var stop  = regs[intToHex(3100 + (15 * (nr - 1)) + (i * 2) + 1)];
    var idx   = regs[intToHex(3110 + (15 * (nr - 1)) + i)];

    start     = minutesToTime(regToInt(start));
    stop      = minutesToTime(regToInt(stop));
    idx       = regToInt(idx); if(idx == -1) { idx = 65535; }

    ctrl_start       = document.getElementById("sett_day_prg_co_start" + (i + 1));
    ctrl_stop        = document.getElementById("sett_day_prg_co_stop"  + (i + 1));
    ctrl_idx         = document.getElementById("m_prg_co__sel_temp"  + (i + 1));

    ctrl_start.value = start;
    ctrl_stop.value  = stop;
    ctrl_idx.text    = idx;

    switch(idx) {
      case 1: ctrl_idx.setAttribute("class", "ui-btn ui-icon-pzam ui-btn-icon-notext ui-shadow"); break;
      case 2: ctrl_idx.setAttribute("class", "ui-btn ui-icon-tconf ui-btn-icon-notext ui-shadow"); break;
      case 3: ctrl_idx.setAttribute("class", "ui-btn ui-icon-tconfm ui-btn-icon-notext ui-shadow"); break;
      case 4: ctrl_idx.setAttribute("class", "ui-btn ui-icon-tconfp ui-btn-icon-notext ui-shadow"); break;
      default: ctrl_idx.setAttribute("class", "ui-btn ui-icon-bars ui-btn-icon-notext ui-shadow");
    }
  }
  m_prg_co_daily_check_each_validation(true);
  hideLoadingSpinner();
}

/* ustawienie programu dziennego */
function set_prog_co_daily() {
		if (m_prg_co_daily_check_each_validation(false)){
		  nr = $("#aaaa").text();
		  var time = "";
		  var idx  = "";
		  var start;
		  var stop;
		  for(i = 0; i < 5; i++) {
			ctrl_start = document.getElementById("sett_day_prg_co_start" + (i + 1)).value.split(":");
			ctrl_stop  = document.getElementById("sett_day_prg_co_stop"  + (i + 1)).value.split(":");
			ctrl_idx   = document.getElementById("m_prg_co__sel_temp"  + (i + 1)).text;
			if(ctrl_start != "") { start = (parseInt(ctrl_start[0]) * 60) + parseInt(ctrl_start[1]); } else { start = 65535; }
			if(ctrl_stop  != "") { stop  = (parseInt(ctrl_stop[0]) * 60)  + parseInt(ctrl_stop[1]); }  else { stop  = 65535; }

			console.log(start + ',' + stop + ',' + ctrl_idx);


			time += regToHex(start) + "," + regToHex(stop) + ",";
			idx  += regToHex(parseInt(ctrl_idx)) + ',';
		  }

		  var addr = intToHex(3100 + (15 * (nr - 1)), true);
		  var regs = (time + idx).slice(0, -1);
		  setReg(addr, regs);
		  window.location.href = "#settings_prg_co_daily";
		}
		else{
			$("#m_prg_co__daily_edit_save").css("background-color","#CCCCCC");
			$("#m_prg_co__daily_edit_save").css("color","#D9D9D9");
		}
}

/* usunięcie pozycji z programu dziennego */
function m_prg_co__del_pos() {
  for(var i = m_prg_co__idx; i < 5; i++) {
    $("#sett_day_prg_co_start" + i).val($("#sett_day_prg_co_start" + (i + 1)).val());
    $("#sett_day_prg_co_stop" + i).val($("#sett_day_prg_co_stop" + (i + 1)).val());

    $("#m_prg_co__sel_temp" + i).text($("#m_prg_co__sel_temp" + (i + 1)).text());
    $("#m_prg_co__sel_temp" + i).attr("class", $("#m_prg_co__sel_temp" + (i + 1)).attr("class"));
  }
  $("#sett_day_prg_co_start" + i).val("");
  $("#sett_day_prg_co_stop" + i).val("");
  $("#m_prg_co__sel_temp" + i).text("65535");
  $("#m_prg_co__sel_temp" + i).attr("class", "ui-btn ui-icon-bars ui-btn-icon-notext ui-shadow");
  m_prg_co_daily_check_each_validation(true);
}

/**
 *  @brief        m_prg_co__set_temp(nr)
 *  @description  Ustawienie dla wybranej pozycji predefiniowanej temperatury
 *
 *  @param        nr <integer>, id predefiniowanej temperatury.
 */
function m_prg_co__set_temp(nr) {
  ctrl_idx      = document.getElementById("m_prg_co__sel_temp"  + m_prg_co__idx);
  ctrl_idx.text = nr;

  switch(nr) {
    case 1:  ctrl_idx.setAttribute("class", "ui-btn ui-icon-pzam ui-btn-icon-notext ui-shadow");   break;
    case 2:  ctrl_idx.setAttribute("class", "ui-btn ui-icon-tconf ui-btn-icon-notext ui-shadow");  break;
    case 3:  ctrl_idx.setAttribute("class", "ui-btn ui-icon-tconfm ui-btn-icon-notext ui-shadow"); break;
    case 4:  ctrl_idx.setAttribute("class", "ui-btn ui-icon-tconfp ui-btn-icon-notext ui-shadow"); break;
    default: ctrl_idx.setAttribute("class", "ui-btn ui-icon-bars ui-btn-icon-notext ui-shadow");
  }

  if (m_prg_co_daily_validate($("#sett_day_prg_co_start" + m_prg_co__idx),$("#sett_day_prg_co_stop" + m_prg_co__idx),true,$("#m_prg_co__sel_temp" + m_prg_co__idx))){
    $("#m_prg_co__daily_edit_save").css("background-color","");
	$("#m_prg_co__daily_edit_save").css("color","#000000");
  }
  
  $('#m_prg_co__sel_temp').dialog('close');
}

/**
 *  @brief        m_prg_co__set_temp_show()
 *  @description  Funkcja wywoływana po ustanowieniu widoczności okna z wyborem temepratur
 *
 */
function m_prg_co__set_temp_show() {
  nr         = document.getElementById("m_prg_co__sel_temp"  + m_prg_co__idx).text;
  ctrl_pzam  = $("#m_prg_co__sel_temp__mode_pzam");
  ctrl_conf  = $("#m_prg_co__sel_temp__mode_conf");
  ctrl_confm = $("#m_prg_co__sel_temp__mode_confm");
  ctrl_confp = $("#m_prg_co__sel_temp__mode_confp");

  ctrl_pzam.prop("checked", false).checkboxradio("refresh");
  ctrl_conf.prop("checked", false).checkboxradio("refresh");
  ctrl_confm.prop("checked", false).checkboxradio("refresh");
  ctrl_confp.prop("checked", false).checkboxradio("refresh");

//  switch(nr) {
//    case 1: ctrl_pzam.prop("checked", true).checkboxradio("refresh");  break;
//    case 2: ctrl_conf.prop("checked", true).checkboxradio("refresh");  break;
//    case 3: ctrl_confm.prop("checked", true).checkboxradio("refresh"); break;
//    case 4: ctrl_confp.prop("checked", true).checkboxradio("refresh"); break;
//  }
}




function refreshPrgCOEdit() {
//		var htm = '';
//		for(i = 1; i <= 5; i++) {
//			htm += '<option value=' + i + '>';
//			htm += 'Opcja ' + i;
//			htm += '</option>';
//			}
//			
//			var options = []; 
//			for (i = 0; i < 5; i++) {
//				options.push("<option value='" + i + "'>" + i + "</option>");
//			}			
//			
//			
//		$("#sett_day_prg_co_temp2").append(options.join("")).selectmenu();
}

/* read weak prog */
function refreshPrgCO() {
  res  = getReg("0c94", "7");
  buff = regToInt(getReg("0b8a", "1")["0b8a"]);

  if(buff == 2) {
    $("#settings_prog_co_title").text("programator bufora");
    $("#m_prg_co__sel_temp1").attr("style", "display:none;");
    $("#m_prg_co__sel_temp2").attr("style", "display:none;");
    $("#m_prg_co__sel_temp3").attr("style", "display:none;");
    $("#m_prg_co__sel_temp4").attr("style", "display:none;");
    $("#m_prg_co__sel_temp5").attr("style", "display:none;");
  } else {
    $("#settings_prog_co_title").text("programator co");
    $("#m_prg_co__sel_temp1").attr("style", "display:yes;");
    $("#m_prg_co__sel_temp2").attr("style", "display:yes;");
    $("#m_prg_co__sel_temp3").attr("style", "display:yes;");
    $("#m_prg_co__sel_temp4").attr("style", "display:yes;");
    $("#m_prg_co__sel_temp5").attr("style", "display:yes;");
  }


  $("#settings_prg_co_monday").val(parseInt(res['0c94'].substring(-2, 2))).change();
  $("#settings_prg_co_tuesday").val(parseInt(res['0c95'].substring(-2, 2))).change();
  $("#settings_prg_co_wednesday").val(parseInt(res['0c96'].substring(-2, 2))).change();
  $("#settings_prg_co_thursday").val(parseInt(res['0c97'].substring(-2, 2))).change();
  $("#settings_prg_co_friday").val(parseInt(res['0c98'].substring(-2, 2))).change();
  $("#settings_prg_co_saturday").val(parseInt(res['0c99'].substring(-2, 2))).change();
  $("#settings_prg_co_sunday").val(parseInt(res['0c9a'].substring(-2, 2))).change();
  sett_prg_co_modify = false;
}

/* save weak prog */
function savePrgCO(id) {
  if(sett_prg_co_modify) {
    switch(id) {
     case 1: setReg("0c94", regToHex(parseInt($("#settings_prg_co_monday").val()))); break;
     case 2: setReg("0c95", regToHex(parseInt($("#settings_prg_co_tuesday").val()))); break;
     case 3: setReg("0c96", regToHex(parseInt($("#settings_prg_co_wednesday").val()))); break;
     case 4: setReg("0c97", regToHex(parseInt($("#settings_prg_co_thursday").val()))); break;
     case 5: setReg("0c98", regToHex(parseInt($("#settings_prg_co_friday").val()))); break;
     case 6: setReg("0c99", regToHex(parseInt($("#settings_prg_co_saturday").val()))); break;
     case 7: setReg("0c9a", regToHex(parseInt($("#settings_prg_co_sunday").val()))); break;
    }
  }
}
</script>
<!-- page: #settings_prg_boil -->
<div data-role="page" id="settings_prg_boil" data-theme="a">

  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">programator cwu</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#settings" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main" class="ui-content">
    <div class="ui-corner-all custom-corners">
      <div class="ui-bar ui-bar-a" align="center"><h1>program tygodniowy</h1></div>
      <div class="ui-body ui-body-a">
        <table width="100%">
          <tr><td><label for="settings_prg_boil_monday">poniedziałek:</label></td><td><select name="settings_prg_boil_monday" id="settings_prg_boil_monday" onchange="savePrgBoil(1);" onclick="sett_prg_boil_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
<option value="9">program eco</option>
</select></td></tr>
          <tr><td><label for="settings_prg_boil_tuesday">wtorek:</label></td><td><select name="settings_prg_boil_tuesday" id="settings_prg_boil_tuesday" onchange="savePrgBoil(2);" onclick="sett_prg_boil_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
<option value="9">program eco</option>
</select></td></tr>
          <tr><td><label for="settings_prg_boil_wednesday">środa:</label></td><td><select name="settings_prg_boil_wednesday" id="settings_prg_boil_wednesday" onchange="savePrgBoil(3);" onclick="sett_prg_boil_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
<option value="9">program eco</option>
</select></td></tr>
          <tr><td><label for="settings_prg_boil_thursday">czwartek:</label></td><td><select name="settings_prg_boil_thursday" id="settings_prg_boil_thursday" onchange="savePrgBoil(4);" onclick="sett_prg_boil_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
<option value="9">program eco</option>
</select></td></tr>
          <tr><td><label for="settings_prg_boil_friday">piątek:</label></td><td><select name="settings_prg_boil_friday" id="settings_prg_boil_friday" onchange="savePrgBoil(5);" onclick="sett_prg_boil_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
<option value="9">program eco</option>
</select></td></tr>
          <tr><td><label for="settings_prg_boil_saturday">sobota:</label></td><td><select name="settings_prg_boil_saturday" id="settings_prg_boil_saturday" onchange="savePrgBoil(6);" onclick="sett_prg_boil_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
<option value="9">program eco</option>
</select></td></tr>
          <tr><td><label for="settings_prg_boil_sunday">niedziela:</label></td><td><select name="settings_prg_boil_sunday" id="settings_prg_boil_sunday" onchange="savePrgBoil(7);" onclick="sett_prg_boil_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
<option value="9">program eco</option>
</select></td></tr>
        </table>
      </div>
    </div>

    <p><a href="#settings_prg_boil_daily" class="ui-btn ui-shadow ui-corner-all">programy dzienne</a></p>

  </div>

</div><!-- /page settings_prg_boil -->

<!-- page: #settings_prg_boil_daily -->
<div data-role="page" id="settings_prg_boil_daily" data-theme="a">

  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">programy dzienne</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#settings_prg_boil" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main" class="ui-content">
    <a href="#settings_prg_boil_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_boil_daily(1);">program 1</a>
    <a href="#settings_prg_boil_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_boil_daily(2);">program 2</a>
    <a href="#settings_prg_boil_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_boil_daily(3);">program 3</a>
    <a href="#settings_prg_boil_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_boil_daily(4);">program 4</a>
    <a href="#settings_prg_boil_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_boil_daily(5);">program 5</a>
    <a href="#settings_prg_boil_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_boil_daily(6);">program 6</a>
    <a href="#settings_prg_boil_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_boil_daily(7);">program 7</a>
    <a href="#settings_prg_boil_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_boil_daily(8);">program 8</a>
  </div>

</div><!-- /page settings_prg_boil_daily -->

<!-- page: #settings_prg_boil_daily_edit -->
<div data-role="page" id="settings_prg_boil_daily_edit" data-theme="a">
  <div id="settings_prg_boil_daily_nr"></div>
  <div data-role="header">
    <h1><a id="settings_prg_boil_daily_edit_title" onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">program zasobnika nr</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#settings_prg_boil_daily" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main" class="ui-content">
    <ul data-role="listview" data-inset="true" id="aaaa">
      <li class="ui-body">
        <table width="100%" cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td width="0.1%" align="center"><a href="#m_prg_boil__del_pos" class="ui-btn ui-icon-delete ui-btn-icon-notext ui-shadow" onclick="m_prg_boil__idx = 1;"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_boil_start1" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_boil_stop1" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="0.1%" align="center"><a id="m_prg_boil__sel_temp1" href="#m_prg_boil__sel_temp" class="ui-btn ui-icon-tconf ui-btn-icon-notext ui-shadow" onclick="m_prg_boil__idx = 1;">65535</a></td>
          <tr>
          <tr>
            <td width="0.1%" align="center"><a href="#m_prg_boil__del_pos" class="ui-btn ui-icon-delete ui-btn-icon-notext ui-shadow" onclick="m_prg_boil__idx = 2;"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_boil_start2" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_boil_stop2" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="0.1%" align="center"><a id="m_prg_boil__sel_temp2" href="#m_prg_boil__sel_temp" class="ui-btn ui-icon-tconf ui-btn-icon-notext ui-shadow" onclick="m_prg_boil__idx = 2;">65535</a></td>
          <tr>
          <tr>
            <td width="0.1%" align="center"><a href="#m_prg_boil__del_pos" class="ui-btn ui-icon-delete ui-btn-icon-notext ui-shadow" onclick="m_prg_boil__idx = 3;"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_boil_start3" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_boil_stop3" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="0.1%" align="center"><a id="m_prg_boil__sel_temp3" href="#m_prg_boil__sel_temp" class="ui-btn ui-icon-tconf ui-btn-icon-notext ui-shadow" onclick="m_prg_boil__idx = 3;">65535</a></td>
          <tr>
          <tr>
            <td width="0.1%" align="center"><a href="#m_prg_boil__del_pos" class="ui-btn ui-icon-delete ui-btn-icon-notext ui-shadow" onclick="m_prg_boil__idx = 4;"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_boil_start4" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_boil_stop4" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="0.1%" align="center"><a id="m_prg_boil__sel_temp4" href="#m_prg_boil__sel_temp" class="ui-btn ui-icon-tconf ui-btn-icon-notext ui-shadow" onclick="m_prg_boil__idx = 4;">65535</a></td>
          <tr>
          <tr>
            <td width="0.1%" align="center"><a href="#m_prg_boil__del_pos" class="ui-btn ui-icon-delete ui-btn-icon-notext ui-shadow" onclick="m_prg_boil__idx = 5;"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_boil_start5" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_boil_stop5" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="0.1%" align="center"><a id="m_prg_boil__sel_temp5" href="#m_prg_boil__sel_temp" class="ui-btn ui-icon-tconf ui-btn-icon-notext ui-shadow" onclick="m_prg_boil__idx = 5;">65535</a></td>
          <tr>
        </table>
      </li>
    </ul>
    <p><a id="m_prg_boil__daily_edit_save" data-direction="reverse" class="ui-btn ui-shadow ui-corner-all ui-btn-b" onclick="set_prog_boil_daily()">zapisz i zamknij okno</a></p>
  </div>
</div><!-- /page settings_prg_boil_daily_edit -->


<div data-role="dialog" id="m_prg_boil__del_pos" data-close-btn="right">
  <div data-role="header"><h1>program dobowy</h1></div>
  <div data-role="content">
    <p class="sure-2">czy chcesz usunąć wybraną pozycję z harmonogramu dobowego?</p>
    <table width="100%">
      <tr>
        <td><a href="#" class="sure-do" data-role="button" data-theme="b" data-rel="back" onclick="m_prg_boil__del_pos();">tak</a></td>
        <td><a href="#" data-role="button" data-theme="c" data-rel="back">nie</a></td>
      </tr>
    </table>
  </div>
</div>


<!-- /start: temp. type selector -->
<div data-role="dialog" id="m_prg_boil__sel_temp" data-close-btn="right">
  <div data-role="header"><h1>temperatury</h1></div>
  <div data-role="content">
    <div data-role="controlgroup">

      <input name="m_prg_boil__sel_temp_group" id="m_prg_boil__sel_temp__mode_pzam" type="radio" value="1" data-iconpos="right" onclick="m_prg_boil__set_temp(1)">
      <label for="m_prg_boil__sel_temp__mode_pzam">
        <table cellspacing="0" cellpadding="0" width="100%">
          <tr>
            <td align="center"><span class="ui-btn-icon-notext ui-icon-pzam" style="position: relative"/></td>
            <td>&nbsp;</td>
            <td width="100%">przeciwzamrożeniowa</td>
          </tr>
        </table>
      </label>

      <input name="m_prg_boil__sel_temp_group" id="m_prg_boil__sel_temp__mode_conf" type="radio" value="2" data-iconpos="right" onclick="m_prg_boil__set_temp(2)">
      <label for="m_prg_boil__sel_temp__mode_conf">
        <table cellspacing="0" cellpadding="0" width="100%">
          <tr>
            <td align="center"><span class="ui-btn-icon-notext ui-icon-tconf" style="position: relative"/></td>
            <td>&nbsp;</td>
            <td width="100%">komfortowa</td>
          </tr>
        </table>
      </label>
    </div>
  </div>
</div>
<!-- /stop: temp. type selector -->


<script>$(document).on("pagechange", function () { if($("#settings_prg_boil").is(":visible")) { refreshPrgBoil(); hideLoadingSpinner();}});

/* zmienne parametryczne */
var sett_prg_boil_modify     = false;
var m_prg_boil__idx;

/* pobranie programu dziennego */
function get_prg_boil_daily(nr) {
  $("#settings_prg_boil_daily_edit_title").text('program zasobnika nr ' + nr);
  $("#settings_prg_boil_daily_nr").text(nr);
  $("#settings_prg_boil_daily_nr").hide();
  
  var regs = getReg(regToHex(3230 + (15 * (nr - 1)), true), "0f");

  console.log(regs);

  for(i = 0; i < 5; i++) {
    var start = regs[intToHex(3230 + (15 * (nr - 1)) + (i * 2))];
    var stop  = regs[intToHex(3230 + (15 * (nr - 1)) + (i * 2) + 1)];
    var idx   = regs[intToHex(3240 + (15 * (nr - 1)) + i)];

    start     = minutesToTime(parseInt(start.substring(2) + start.substring(-2, 2), 16));
    stop      = minutesToTime(parseInt(stop.substring(2)  + stop.substring(-2, 2), 16));
    idx       = parseInt(idx.substring(2)   + idx.substring(-2, 2), 16);

    console.log(start + ',' + stop + ',' + idx);

    ctrl_start       = document.getElementById("sett_day_prg_boil_start" + (i + 1));
    ctrl_stop        = document.getElementById("sett_day_prg_boil_stop"  + (i + 1));
    ctrl_idx         = document.getElementById("m_prg_boil__sel_temp"  + (i + 1));

    ctrl_start.value = start;
    ctrl_stop.value  = stop;
    ctrl_idx.value   = idx;
    $(ctrl_idx).change();
   }
   m_prg_boil_daily_check_each_validation(true);
   hideLoadingSpinner();
}

/* usunięcie pozycji z programu dziennego */
function m_prg_boil__del_pos() {
  for(var i = m_prg_boil__idx; i < 5; i++) {
    $("#sett_day_prg_boil_start" + i).val($("#sett_day_prg_boil_start" + (i + 1)).val());
    $("#sett_day_prg_boil_stop" + i).val($("#sett_day_prg_boil_stop" + (i + 1)).val());

    $("#m_prg_boil__sel_temp" + i).text($("#m_prg_boil__sel_temp" + (i + 1)).text());
    $("#m_prg_boil__sel_temp" + i).attr("class", $("#m_prg_boil__sel_temp" + (i + 1)).attr("class"));
  }
  $("#sett_day_prg_boil_start" + i).val("");
  $("#sett_day_prg_boil_stop" + i).val("");
  $("#m_prg_boil__sel_temp" + i).text("65535");
  $("#m_prg_boil__sel_temp" + i).attr("class", "ui-btn ui-icon-bars ui-btn-icon-notext ui-shadow");
  m_prg_boil_daily_check_each_validation(true);
}

/**
 *  @brief        m_prg_co__set_temp(nr)
 *  @description  Ustawienie dla wybranej pozycji predefiniowanej temperatury
 *
 *  @param        nr <integer>, id predefiniowanej temperatury.
 */
function m_prg_boil__set_temp(nr) {
  ctrl_idx      = document.getElementById("m_prg_boil__sel_temp"  + m_prg_boil__idx);
  ctrl_idx.text = nr;

  switch(nr) {
    case 1:  ctrl_idx.setAttribute("class", "ui-btn ui-icon-pzam ui-btn-icon-notext ui-shadow");   break;
    case 2:  ctrl_idx.setAttribute("class", "ui-btn ui-icon-tconf ui-btn-icon-notext ui-shadow");  break;
    default: ctrl_idx.setAttribute("class", "ui-btn ui-icon-bars ui-btn-icon-notext ui-shadow");
  }

  $('#m_prg_boil__sel_temp').dialog('close');
}

/* eventy do walidacji programu dziennego */
$("#sett_day_prg_boil_start1").on("change", function(){ m_prg_boil_daily_check_each_validation(false); });
$("#sett_day_prg_boil_start2").on("change", function(){ m_prg_boil_daily_check_each_validation(false); });
$("#sett_day_prg_boil_start3").on("change", function(){ m_prg_boil_daily_check_each_validation(false); });
$("#sett_day_prg_boil_start4").on("change", function(){ m_prg_boil_daily_check_each_validation(false); });
$("#sett_day_prg_boil_start5").on("change", function(){ m_prg_boil_daily_check_each_validation(false); });
$("#sett_day_prg_boil_stop1").on("change", function(){ m_prg_boil_daily_check_each_validation(false); });
$("#sett_day_prg_boil_stop2").on("change", function(){ m_prg_boil_daily_check_each_validation(false); });
$("#sett_day_prg_boil_stop3").on("change", function(){ m_prg_boil_daily_check_each_validation(false); });
$("#sett_day_prg_boil_stop4").on("change", function(){ m_prg_boil_daily_check_each_validation(false); });
$("#sett_day_prg_boil_stop5").on("change", function(){ m_prg_boil_daily_check_each_validation(false); });

/* funkcja walidująca pola w harmonogramie dziennym */
function m_prg_boil_daily_validate(start, stop, siteBool){
	var validation = false;
	if ($("#settings_prg_boil_daily_edit").is(":visible") || siteBool){
		validation = true;	
		
		/* sprawdzanie czy pola są puste oraz czy prawa część jest większa od lewej */
		if(start.val() && !stop.val()){	
			start.parent().attr("style", "color: black; font-weight: normal;");
			start.parent().css("background-color", "transparent");
			start.parent().css("border","2px solid transparent");				
			stop.parent().attr("style", "color: black; font-weight: bold;");
			stop.parent().css("background-color","#FF9999");
			stop.parent().css("border","2px solid red");
			validation = false;
		}
		else if(!start.val() && stop.val()){	
			start.parent().attr("style", "color: black; font-weight: bold;");
			start.parent().css("background-color","#FF9999");
			start.parent().css("border","2px solid red");
			stop.parent().attr("style", "color: black; font-weight: normal;");
			stop.parent().css("background-color", "transparent");
			stop.parent().css("border","2px solid transparent");
			validation = false;
		}
		else if(start.val() && stop.val()){
			if(start.val() >= stop.val()){	
				start.parent().attr("style", "color: black; font-weight: bold;");
				start.parent().css("background-color","#FF9999");
				start.parent().css("border","2px solid red");	
				stop.parent().attr("style", "color: black; font-weight: bold;");
				stop.parent().css("background-color","#FF9999");
				stop.parent().css("border","2px solid red");
				validation = false;
			}
			else{
				start.parent().attr("style", "color: black; font-weight: normal;");
				start.parent().css("background-color", "transparent");
				start.parent().css("border","2px solid transparent");
				stop.parent().attr("style", "color: black; font-weight: normal;");
				stop.parent().css("background-color", "transparent");
				stop.parent().css("border","2px solid transparent");
							
				/* sprawdzanie kolizji czasu */
				var actual_start = getMinute(start.attr("id"));
				var actual_stop = getMinute(stop.attr("id"));
				if(!isNaN(actual_start) && !isNaN(actual_stop)){
	
					var check_start; var check_stop;
					for(var i = 1; i <= 5; i++) {
						check_start = getMinute("sett_day_prg_boil_start" + i);
						check_stop  = getMinute("sett_day_prg_boil_stop"  + i);
						
						if(!isNaN(check_start) && !isNaN(check_stop)){ 
							if(start.attr("id") != ("sett_day_prg_boil_start" + i) && stop.attr("id") != ("sett_day_prg_boil_stop" + i)) {
								if(m_prg_boil_daily_check_time_conflicts(actual_start,actual_stop,check_start,check_stop))
								{ 
									start.parent().attr("style", "color: black; font-weight: bold;");
									start.parent().css("background-color","#FF9999");
									start.parent().css("border","2px solid red");
									stop.parent().attr("style", "color: black; font-weight: bold;");
									stop.parent().css("background-color","#FF9999");
									stop.parent().css("border","2px solid red");
									validation = false;
								}
							}
						}
					}
				}				
			}
		}
		else if (!start.val() && !stop.val()){
				start.parent().attr("style", "color: black; font-weight: normal;");
				start.parent().css("background-color", "transparent");
				start.parent().css("border","2px solid transparent");
				stop.parent().attr("style", "color: black; font-weight: normal;");
				stop.parent().css("background-color", "transparent");
				stop.parent().css("border","2px solid transparent");
		}			
    }
	return validation;
}

/* metoda sprawdzania ram czasowych */
function m_prg_boil_daily_check_time_conflicts(start, stop, c_start, c_stop) {
  if((stop - start) <= 0)                   { return 1; }
  if((start < c_start) & (stop  < c_start)) { return 0;  }
  if((stop  > c_stop)  & (start > c_stop))  { return 0;  }
  return 1;
}

/* sprawdzanie każdego wiersza harmonogramu */
function m_prg_boil_daily_check_each_validation(siteBool) {
	var validation = false;
	if ($("#settings_prg_boil_daily_edit").is(":visible") || siteBool){
		validation = true;
		if (!m_prg_boil_daily_validate($("#sett_day_prg_boil_start1"),$("#sett_day_prg_boil_stop1"),siteBool)) validation = false;
		if (!m_prg_boil_daily_validate($("#sett_day_prg_boil_start2"),$("#sett_day_prg_boil_stop2"),siteBool)) validation = false;
		if (!m_prg_boil_daily_validate($("#sett_day_prg_boil_start3"),$("#sett_day_prg_boil_stop3"),siteBool)) validation = false;
		if (!m_prg_boil_daily_validate($("#sett_day_prg_boil_start4"),$("#sett_day_prg_boil_stop4"),siteBool)) validation = false;
		if (!m_prg_boil_daily_validate($("#sett_day_prg_boil_start5"),$("#sett_day_prg_boil_stop5"),siteBool)) validation = false;
		
		if (validation){
			$("#m_prg_boil__daily_edit_save").css("background-color","");
			$("#m_prg_boil__daily_edit_save").css("color","#000000");
		}
		else{
			$("#m_prg_boil__daily_edit_save").css("background-color","#CCCCCC");
			$("#m_prg_boil__daily_edit_save").css("color","#D9D9D9");
		}
	}
	return validation;
}

/* zapis programu dziennego */
function set_prog_boil_daily() {
	if (m_prg_boil_daily_check_each_validation(false)){
		var nr   = $("#settings_prg_boil_daily_nr").text();

		console.log(nr);

		var time = "";
		var idx  = "";
		var start;
		var stop;
		for(i = 0; i < 5; i++) {
			ctrl_start = document.getElementById("sett_day_prg_boil_start" + (i + 1)).value.split(":");
			ctrl_stop  = document.getElementById("sett_day_prg_boil_stop"  + (i + 1)).value.split(":");
			ctrl_idx   = document.getElementById("m_prg_boil__sel_temp"  + (i + 1)).text;
			if(ctrl_start != "") { start = (parseInt(ctrl_start[0]) * 60) + parseInt(ctrl_start[1]); } else { start = 65535; }
			if(ctrl_stop  != "") { stop  = (parseInt(ctrl_stop[0]) * 60)  + parseInt(ctrl_stop[1]); }  else { stop  = 65535; }
			time += regToHex(start) + "," + regToHex(stop) + ",";
			idx  += regToHex(parseInt(ctrl_idx)) + ',';
		}

		var addr = intToHex(3230 + (15 * (nr - 1)), true);
		var regs = (time + idx).slice(0, -1);
		setReg(addr, regs);
  
		window.location.href = "#settings_prg_boil_daily";
	}
	else{
		$("#m_prg_boil__daily_edit_save").css("background-color","#CCCCCC");
		$("#m_prg_boil__daily_edit_save").css("color","#D9D9D9");
	}
}


/* odświeżenie aktualnego programu */
function refreshPrgBoil() {
  res = getReg("0d16", "7");
  $("#settings_prg_boil_monday").val(parseInt(res['0d16'].substring(-2, 2))).change();
  $("#settings_prg_boil_tuesday").val(parseInt(res['0d17'].substring(-2, 2))).change();
  $("#settings_prg_boil_wednesday").val(parseInt(res['0d18'].substring(-2, 2))).change();
  $("#settings_prg_boil_thursday").val(parseInt(res['0d19'].substring(-2, 2))).change();
  $("#settings_prg_boil_friday").val(parseInt(res['0d1a'].substring(-2, 2))).change();
  $("#settings_prg_boil_saturday").val(parseInt(res['0d1b'].substring(-2, 2))).change();
  $("#settings_prg_boil_sunday").val(parseInt(res['0d1c'].substring(-2, 2))).change();
  sett_prg_co_modify = false;
}

/* ustawienie programu */
function savePrgBoil(id) {
  if(sett_prg_boil_modify) { 
    switch(id) {
      case 1: setReg("0d16", regToHex(parseInt($("#settings_prg_boil_monday").val()))); break;
      case 2: setReg("0d17", regToHex(parseInt($("#settings_prg_boil_tuesday").val()))); break;
      case 3: setReg("0d18", regToHex(parseInt($("#settings_prg_boil_wednesday").val()))); break;
      case 4: setReg("0d19", regToHex(parseInt($("#settings_prg_boil_thursday").val()))); break;
      case 5: setReg("0d1a", regToHex(parseInt($("#settings_prg_boil_friday").val()))); break;
      case 6: setReg("0d1b", regToHex(parseInt($("#settings_prg_boil_saturday").val()))); break;
      case 7: setReg("0d1c", regToHex(parseInt($("#settings_prg_boil_sunday").val()))); break;
    }
  }
}
</script>
<!-- page: #settings_prg_circ -->
<div data-role="page" id="settings_prg_circ" data-theme="a">

  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">programator cyrkulacji</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#settings" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main" class="ui-content">
    <div class="ui-corner-all custom-corners">
      <div class="ui-bar ui-bar-a" align="center"><h1>program tygodniowy</h1></div>
      <div class="ui-body ui-body-a">
        <table width="100%">
          <tr><td><label for="settings_prg_circ_monday">poniedziałek:</label></td><td><select name="settings_prg_circ_monday" id="settings_prg_circ_monday" onchange="savePrgCirc(1);" onclick="sett_prg_circ_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
</select></td></tr>
          <tr><td><label for="settings_prg_circ_tuesday">wtorek:</label></td><td><select name="settings_prg_circ_tuesday" id="settings_prg_circ_tuesday" onchange="savePrgCirc(2);" onclick="sett_prg_circ_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
</select></td></tr>
          <tr><td><label for="settings_prg_circ_wednesday">środa:</label></td><td><select name="settings_prg_circ_wednesday" id="settings_prg_circ_wednesday" onchange="savePrgCirc(3);" onclick="sett_prg_circ_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
</select></td></tr>
          <tr><td><label for="settings_prg_circ_thursday">czwartek:</label></td><td><select name="settings_prg_circ_thursday" id="settings_prg_circ_thursday" onchange="savePrgCirc(4);" onclick="sett_prg_circ_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
</select></td></tr>
          <tr><td><label for="settings_prg_circ_friday">piątek:</label></td><td><select name="settings_prg_circ_friday" id="settings_prg_circ_friday" onchange="savePrgCirc(5);" onclick="sett_prg_circ_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
</select></td></tr>
          <tr><td><label for="settings_prg_circ_saturday">sobota:</label></td><td><select name="settings_prg_circ_saturday" id="settings_prg_circ_saturday" onchange="savePrgCirc(6);" onclick="sett_prg_circ_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
</select></td></tr>
          <tr><td><label for="settings_prg_circ_sunday">niedziela:</label></td><td><select name="settings_prg_circ_sunday" id="settings_prg_circ_sunday" onchange="savePrgCirc(7);" onclick="sett_prg_circ_modify = true;"><option value="1">program 1</option>
<option value="2">program 2</option>
<option value="3">program 3</option>
<option value="4">program 4</option>
<option value="5">program 5</option>
<option value="6">program 6</option>
<option value="7">program 7</option>
<option value="8">program 8</option>
</select></td></tr>
        </table>
      </div>
    </div>

    <p><a href="#settings_prg_circ_daily" class="ui-btn ui-shadow ui-corner-all">programy dzienne</a></p>

  </div>
</div><!-- /page settings -->

<!-- page: #settings_prg_circ_daily -->
<div data-role="page" id="settings_prg_circ_daily" data-theme="a">

  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">program dzienny cyrkulacji</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#settings_prg_circ" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main" class="ui-content">
    <a href="#settings_prg_circ_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_circ_daily(1);">program 1</a>
    <a href="#settings_prg_circ_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_circ_daily(2);">program 2</a>
    <a href="#settings_prg_circ_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_circ_daily(3);">program 3</a>
    <a href="#settings_prg_circ_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_circ_daily(4);">program 4</a>
    <a href="#settings_prg_circ_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_circ_daily(5);">program 5</a>
    <a href="#settings_prg_circ_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_circ_daily(6);">program 6</a>
    <a href="#settings_prg_circ_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_circ_daily(7);">program 7</a>
    <a href="#settings_prg_circ_daily_edit" class="ui-btn ui-icon-clock ui-btn-icon-left" onclick="showLoadingSpinner(); get_prg_circ_daily(8);">program 8</a>
  </div>

</div><!-- /page settings_prg_circ_daily -->

<!-- page: #settings_prg_circ_daily_edit -->
<div data-role="page" id="settings_prg_circ_daily_edit" data-theme="a">

  <div data-role="header">
    <h1><a id="settings_prg_circ_daily_edit_title" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">prog. cyrk.</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#settings_prg_circ_daily" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main" class="ui-content">
    <div id="settings_prg_circ_daily_nr"></div>
    <ul data-role="listview" data-inset="true">
      <li class="ui-body">
        <table width="100%" cellspacing="0" cellpadding="0" border="0">
          <tr>
            <td width="0.1%" align="center"><a href="#m_prg_circ__del_pos" class="ui-btn ui-icon-delete ui-btn-icon-notext ui-shadow" onclick="m_prg_circ__idx = 1;"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_circ_start1" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_circ_stop1" type="time"></td>
          <tr>
          <tr>
            <td width="0.1%" align="center"><a href="#m_prg_circ__del_pos" class="ui-btn ui-icon-delete ui-btn-icon-notext ui-shadow" onclick="m_prg_circ__idx = 2;"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_circ_start2" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_circ_stop2" type="time"></td>
          <tr>
          <tr>
            <td width="0.1%" align="center"><a href="#m_prg_circ__del_pos" class="ui-btn ui-icon-delete ui-btn-icon-notext ui-shadow" onclick="m_prg_circ__idx = 3;"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_circ_start3" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_circ_stop3" type="time"></td>
          <tr>
          <tr>
            <td width="0.1%" align="center"><a href="#m_prg_circ__del_pos" class="ui-btn ui-icon-delete ui-btn-icon-notext ui-shadow" onclick="m_prg_circ__idx = 4;"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_circ_start4" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_circ_stop4" type="time"></td>
          <tr>
          <tr>
            <td width="0.1%" align="center"><a href="#m_prg_circ__del_pos" class="ui-btn ui-icon-delete ui-btn-icon-notext ui-shadow" onclick="m_prg_circ__idx = 5;"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_circ_start5" type="time"></td>
            <td width="0.1%">&nbsp;</td>
            <td width="40%"><input id="sett_day_prg_circ_stop5" type="time"></td>
          <tr>
        </table>
      </li>
    </ul>
    <p><a id="m_prg_circ__daily_edit_save" data-direction="reverse" class="ui-btn ui-shadow ui-corner-all ui-btn-b" onclick="set_prog_circ_daily();">zapisz i zamknij okno</a></p>
  </div>
</div><!-- /page settings_prg_circ_daily_edit -->

<div data-role="dialog" id="m_prg_circ__del_pos" data-close-btn="right">
  <div data-role="header"><h1>uwaga</h1></div>
  <div data-role="content">
    <p class="sure-2">czy chcesz usunąć wybraną pozycję z harmonogramu dobowego?</p>
    <table width="100%">
      <tr>
        <td><a href="#" class="sure-do" data-role="button" data-theme="b" data-rel="back" onclick="m_prg_circ__del_pos();">tak</a></td>
        <td><a href="#" data-role="button" data-theme="c" data-rel="back">nie</a></td>
      </tr>
    </table>
  </div>
</div>



<script>$(document).on("pagechange", function () { if($("#settings_prg_circ").is(":visible")) { refreshPrgCirc(); hideLoadingSpinner();}});

/* zmienne parametryczne */
var sett_prg_circ_modify     = false;
var m_prg_circ__idx = 0;

/* pobranie programu dziennego */
function get_prg_circ_daily(nr) {
  $("#settings_prg_circ_daily_edit_title").text('prog. cyrk. ' + nr);
  $("#settings_prg_circ_daily_nr").text(nr);
  $("#settings_prg_circ_daily_nr").hide();


  var regs = getReg(regToHex(3360 + (15 * (nr - 1)), true), "0f");

  for(i = 0; i < 5; i++) {
    var start = regs[intToHex(3360 + (15 * (nr - 1)) + (i * 2))];
    var stop  = regs[intToHex(3360 + (15 * (nr - 1)) + (i * 2) + 1)];

    start     = minutesToTime(parseInt(start.substring(2) + start.substring(-2, 2), 16));
    stop      = minutesToTime(parseInt(stop.substring(2)  + stop.substring(-2, 2), 16));

    ctrl_start       = document.getElementById("sett_day_prg_circ_start" + (i + 1));
    ctrl_stop        = document.getElementById("sett_day_prg_circ_stop"  + (i + 1));

    ctrl_start.value = start;
    ctrl_stop.value  = stop;
  }
  m_prg_circ_daily_check_each_validation(true);
  hideLoadingSpinner();
}

/* usunięcie pozycji z programu dziennego */
function m_prg_circ__del_pos() {
  for(var i = m_prg_circ__idx; i < 5; i++) {
    $("#sett_day_prg_circ_start" + i).val($("#sett_day_prg_circ_start" + (i + 1)).val());
    $("#sett_day_prg_circ_stop" + i).val($("#sett_day_prg_circ_stop" + (i + 1)).val());

    $("#m_prg_circ__sel_temp" + i).text($("#m_prg_circ__sel_temp" + (i + 1)).text());
    $("#m_prg_circ__sel_temp" + i).attr("class", $("#m_prg_circ__sel_temp" + (i + 1)).attr("class"));
  }
  $("#sett_day_prg_circ_start" + i).val("");
  $("#sett_day_prg_circ_stop" + i).val("");
  $("#m_prg_circ__sel_temp" + i).text("65535");
  $("#m_prg_circ__sel_temp" + i).attr("class", "ui-btn ui-icon-bars ui-btn-icon-notext ui-shadow");
  m_prg_circ_daily_check_each_validation(true);
}

/* eventy do walidacji programu dziennego */
$("#sett_day_prg_circ_start1").on("change", function(){ m_prg_circ_daily_check_each_validation(false); });
$("#sett_day_prg_circ_start2").on("change", function(){ m_prg_circ_daily_check_each_validation(false); });
$("#sett_day_prg_circ_start3").on("change", function(){ m_prg_circ_daily_check_each_validation(false); });
$("#sett_day_prg_circ_start4").on("change", function(){ m_prg_circ_daily_check_each_validation(false); });
$("#sett_day_prg_circ_start5").on("change", function(){ m_prg_circ_daily_check_each_validation(false); });
$("#sett_day_prg_circ_stop1").on("change", function(){ m_prg_circ_daily_check_each_validation(false); });
$("#sett_day_prg_circ_stop2").on("change", function(){ m_prg_circ_daily_check_each_validation(false); });
$("#sett_day_prg_circ_stop3").on("change", function(){ m_prg_circ_daily_check_each_validation(false); });
$("#sett_day_prg_circ_stop4").on("change", function(){ m_prg_circ_daily_check_each_validation(false); });
$("#sett_day_prg_circ_stop5").on("change", function(){ m_prg_circ_daily_check_each_validation(false); });


/* funkcja walidująca pola w harmonogramie dziennym */
function m_prg_circ_daily_validate(start, stop, siteBool){
	var validation = false;
	if ($("#settings_prg_circ_daily_edit").is(":visible") || siteBool){
		validation = true;	
		
		/* sprawdzanie czy pola są puste oraz czy prawa część jest większa od lewej */
		if(start.val() && !stop.val()){	
			start.parent().attr("style", "color: black; font-weight: normal;");
			start.parent().css("background-color", "transparent");
			start.parent().css("border","2px solid transparent");				
			stop.parent().attr("style", "color: black; font-weight: bold;");
			stop.parent().css("background-color","#FF9999");
			stop.parent().css("border","2px solid red");
			validation = false;
		}
		else if(!start.val() && stop.val()){	
			start.parent().attr("style", "color: black; font-weight: bold;");
			start.parent().css("background-color","#FF9999");
			start.parent().css("border","2px solid red");
			stop.parent().attr("style", "color: black; font-weight: normal;");
			stop.parent().css("background-color", "transparent");
			stop.parent().css("border","2px solid transparent");
			validation = false;
		}
		else if(start.val() && stop.val()){
			if(start.val() >= stop.val()){	
				start.parent().attr("style", "color: black; font-weight: bold;");
				start.parent().css("background-color","#FF9999");
				start.parent().css("border","2px solid red");	
				stop.parent().attr("style", "color: black; font-weight: bold;");
				stop.parent().css("background-color","#FF9999");
				stop.parent().css("border","2px solid red");
				validation = false;
			}
			else{
				start.parent().attr("style", "color: black; font-weight: normal;");
				start.parent().css("background-color", "transparent");
				start.parent().css("border","2px solid transparent");
				stop.parent().attr("style", "color: black; font-weight: normal;");
				stop.parent().css("background-color", "transparent");
				stop.parent().css("border","2px solid transparent");
							
				/* sprawdzanie kolizji czasu */
				var actual_start = getMinute(start.attr("id"));
				var actual_stop = getMinute(stop.attr("id"));
				if(!isNaN(actual_start) && !isNaN(actual_stop)){
	
					var check_start; var check_stop;
					for(var i = 1; i <= 5; i++) {
						check_start = getMinute("sett_day_prg_circ_start" + i);
						check_stop  = getMinute("sett_day_prg_circ_stop"  + i);
						
						if(!isNaN(check_start) && !isNaN(check_stop)){ 
							if(start.attr("id") != ("sett_day_prg_circ_start" + i) && stop.attr("id") != ("sett_day_prg_circ_stop" + i)) {
								if(m_prg_circ_daily_check_time_conflicts(actual_start,actual_stop,check_start,check_stop))
								{ 
									start.parent().attr("style", "color: black; font-weight: bold;");
									start.parent().css("background-color","#FF9999");
									start.parent().css("border","2px solid red");
									stop.parent().attr("style", "color: black; font-weight: bold;");
									stop.parent().css("background-color","#FF9999");
									stop.parent().css("border","2px solid red");
									validation = false;
								}
							}
						}
					}
				}				
			}
		}
		else if (!start.val() && !stop.val()){
				start.parent().attr("style", "color: black; font-weight: normal;");
				start.parent().css("background-color", "transparent");
				start.parent().css("border","2px solid transparent");
				stop.parent().attr("style", "color: black; font-weight: normal;");
				stop.parent().css("background-color", "transparent");
				stop.parent().css("border","2px solid transparent");
		}			
    }
	return validation;
}

/* sprawdzanie każdego wiersza harmonogramu */
function m_prg_circ_daily_check_each_validation(siteBool) {
	var validation = false;
	if ($("#settings_prg_circ_daily_edit").is(":visible") || siteBool){
		validation = true;
		if (!m_prg_circ_daily_validate($("#sett_day_prg_circ_start1"),$("#sett_day_prg_circ_stop1"),siteBool)) validation = false;
		if (!m_prg_circ_daily_validate($("#sett_day_prg_circ_start2"),$("#sett_day_prg_circ_stop2"),siteBool)) validation = false;
		if (!m_prg_circ_daily_validate($("#sett_day_prg_circ_start3"),$("#sett_day_prg_circ_stop3"),siteBool)) validation = false;
		if (!m_prg_circ_daily_validate($("#sett_day_prg_circ_start4"),$("#sett_day_prg_circ_stop4"),siteBool)) validation = false;
		if (!m_prg_circ_daily_validate($("#sett_day_prg_circ_start5"),$("#sett_day_prg_circ_stop5"),siteBool)) validation = false;
		
		if (validation){
			$("#m_prg_circ__daily_edit_save").css("background-color","");
			$("#m_prg_circ__daily_edit_save").css("color","#000000");
		}
		else{
			$("#m_prg_circ__daily_edit_save").css("background-color","#CCCCCC");
			$("#m_prg_circ__daily_edit_save").css("color","#D9D9D9");
		}
	}
	return validation;
}

/* metoda sprawdzania ram czasowych */
function m_prg_circ_daily_check_time_conflicts(start, stop, c_start, c_stop) {
  if((stop - start) <= 0)                   { return 1; }
  if((start < c_start) & (stop  < c_start)) { return 0;  }
  if((stop  > c_stop)  & (start > c_stop))  { return 0;  }
  return 1;
}

/* zapis programu dziennego */
function set_prog_circ_daily() {
	if (m_prg_circ_daily_check_each_validation(false)){
	  var nr   = $("#settings_prg_circ_daily_nr").text();

	  var time = "";
	  var start;
	  var stop;
	  for(i = 0; i < 5; i++) {
		ctrl_start = document.getElementById("sett_day_prg_circ_start" + (i + 1)).value.split(":");
		ctrl_stop  = document.getElementById("sett_day_prg_circ_stop"  + (i + 1)).value.split(":");
		if(ctrl_start != "") { start = (parseInt(ctrl_start[0]) * 60) + parseInt(ctrl_start[1]); } else { start = 65535; }
		if(ctrl_stop  != "") { stop  = (parseInt(ctrl_stop[0]) * 60)  + parseInt(ctrl_stop[1]); }  else { stop  = 65535; }
		time += regToHex(start) + "," + regToHex(stop) + ",";
	  }

	  var addr = intToHex(3360 + (15 * (nr - 1)), true);
	  var regs = (time).slice(0, -1);
	  setReg(addr, regs);
	  
	  window.location.href = "#settings_prg_circ_daily";
	}
	else{
		$("#m_prg_circ__daily_edit_save").css("background-color","#CCCCCC");
		$("#m_prg_circ__daily_edit_save").css("color","#D9D9D9");
	}
}

/* odświeżenie aktualnego programu */
function refreshPrgCirc() {
  res = getReg("0d98", "7");
  $("#settings_prg_circ_monday").val(parseInt(res['0d98'].substring(-2, 2))).change();
  $("#settings_prg_circ_tuesday").val(parseInt(res['0d99'].substring(-2, 2))).change();
  $("#settings_prg_circ_wednesday").val(parseInt(res['0d9a'].substring(-2, 2))).change();
  $("#settings_prg_circ_thursday").val(parseInt(res['0d9b'].substring(-2, 2))).change();
  $("#settings_prg_circ_friday").val(parseInt(res['0d9c'].substring(-2, 2))).change();
  $("#settings_prg_circ_saturday").val(parseInt(res['0d9d'].substring(-2, 2))).change();
  $("#settings_prg_circ_sunday").val(parseInt(res['0d9e'].substring(-2, 2))).change();
  sett_prg_co_modify = false;
}

/* ustawienie programu */
function savePrgCirc(id) {
  if(sett_prg_circ_modify) {
    switch(id) {
      case 1: setReg("0d98", regToHex(parseInt($("#settings_prg_circ_monday").val())));    break;
      case 2: setReg("0d99", regToHex(parseInt($("#settings_prg_circ_tuesday").val())));   break;
      case 3: setReg("0d9a", regToHex(parseInt($("#settings_prg_circ_wednesday").val()))); break;
      case 4: setReg("0d9b", regToHex(parseInt($("#settings_prg_circ_thursday").val())));  break;
      case 5: setReg("0d9c", regToHex(parseInt($("#settings_prg_circ_friday").val())));    break;
      case 6: setReg("0d9d", regToHex(parseInt($("#settings_prg_circ_saturday").val())));  break;
      case 7: setReg("0d9e", regToHex(parseInt($("#settings_prg_circ_sunday").val())));    break;
    }
  }
}
</script>


<!-- page: #config -->
<div data-role="page" id="config" data-theme="a">

  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">konfiguracja</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
  </div>

  <div role="main" class="ui-body">
    <a onclick="showLoadingSpinner();" id="config_buffer" href="#_config_buffer" class="ui-btn ui-shadow ui-corner-all" style="display:none;">bufor</a>
    <a onclick="showLoadingSpinner();" href="#config_co_win" class="ui-btn ui-shadow ui-corner-all">obieg co</a>
    <a onclick="showLoadingSpinner();" href="#config_boil_win" class="ui-btn ui-shadow ui-corner-all">zasobnik cwu</a>
    <a onclick="showLoadingSpinner();" href="#config_circ" class="ui-btn ui-shadow ui-corner-all">cyrkulacja cwu</a>
    <a onclick="showLoadingSpinner();" href="#config_room" class="ui-btn ui-shadow ui-corner-all">temperatura pokojowa</a>
    <a onclick="showLoadingSpinner();" href="#config_turbo_win" class="ui-btn ui-shadow ui-corner-all">tryb turbo</a>
    <a onclick="showLoadingSpinner();" href="#config_pump" class="ui-btn ui-shadow ui-corner-all">pompa</a>
    <a onclick="showLoadingSpinner();" href="#config_power_win" class="ui-btn ui-shadow ui-corner-all">moc kotła</a>
    <a onclick="showLoadingSpinner();" href="#config_fun" class="ui-btn ui-shadow ui-corner-all">wejście funkcyjne</a>
    <a onclick="showLoadingSpinner();" href="#config_preasure_control" class="ui-btn ui-shadow ui-corner-all">kontrola ciśnienia</a>
    <a onclick="showLoadingSpinner();" id="config_mode__a" href="#config_mode" class="ui-btn ui-shadow ui-corner-all" style="display:none;">tryb pracy</a>
  </div>

</div>
<script>$(document).on("pagechange", function () { if($("#config").is(":visible")) { m_config__set(); hideLoadingSpinner();}});

function m_config__set() {
  buff     = regToInt(getReg("0b8a", "1")["0b8a"]);
  mode_min = regToInt(getReg("0be5", "1")["0be5"])
  mode_max = regToInt(getReg("0be6", "1")["0be6"])

  if(mode_max == 0) { $("#config_mode__a").attr("style", "display:none;"); } else { $("#config_mode__a").attr("style", "display:yes;"); }
  if(buff == 2)     { $("#config_buffer").attr("style", "display:yes;");   } else { $("#config_buffer").attr("style", "display:none;"); }
}
</script>
<!-- /page config -->
<!-- page: #config_buffer -->
<div data-role="page" id="_config_buffer" data-theme="a">
  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">bufor</a></h1>
    <a href="#start"  class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#config" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>
  <div role="main">
    <div class="ui-body">
      <ul data-role="listview" data-inset="true">
        <li class="ui-body" id="config_buffer__power_temp_li">
			<label>temperatura zasilania</label>
			<label id="config_buffer_info_1" style="display:none;">zakres: </label>
			<input data-clear-btn="false" id="config_buffer__power_temp" type="number"></li>
        <li class="ui-body" id="config_buffer__out_of_schedule_li"><label><input id="config_buffer__out_of_schedule" type="checkbox">ładowanie poza programem</label></li>
      </ul>
      <a data-direction="reverse" id="config_buffer_save" class="ui-btn ui-shadow ui-corner-all ui-btn-b" onclick="m_config_buffer__set();">zapisz i zamknij</a>
    </div>
  </div>
</div>

<script>$(document).on("pagechange", function () { if($("#_config_buffer").is(":visible")) { m_config_buffer__get(); hideLoadingSpinner(); }});

/* zakresy walidacyjne */
var temp_zas_min = 0;
var temp_zas_max = 0;

/* eventy na inputach - pokazanie zakresu oraz dynamiczna walidacja */
$("#config_buffer__power_temp").on("focusin", function(){
    if ($("#_config_buffer").is(":visible")){
	$("#config_buffer_info_1").show();
    }
});

$("#config_buffer__power_temp").on("focusout", function(){
    if ($("#_config_buffer").is(":visible")){
	$("#config_buffer_info_1").hide();
    }
});

$("#config_buffer__power_temp").on("input", function(){
    if ($("#_config_buffer").is(":visible")){
		if (!validate($("#config_buffer__power_temp"), temp_zas_min,  temp_zas_max,  {})){
			$("#config_buffer_save").css("background-color","#CCCCCC");
			$("#config_buffer_save").css("color","#D9D9D9");
		}else{
			$("#config_buffer_save").css("background-color","");
			$("#config_buffer_save").css("color","#000000");
		}
    }
});

/* ładowanie zmiennych i zakresów walidacyjnych */
function m_config_buffer__get() {
  var reg_val  = getReg("0bba", "2")
  var temp_zas = regToInt(getReg("0b8e", "1")["0b8e"]);
  var outsched = getBit(regToInt(getReg("0b55", "1")["0b55"]), 13);

  temp_zas_min = parseInt(regToInt(reg_val["0bba"])) / 10;
  temp_zas_max = parseInt(regToInt(reg_val["0bbb"])) / 10;

  var text = "zakres: " + temp_zas_min + " ÷ " + temp_zas_max + " " + "[°C]";
  $("#config_buffer_info_1").text(text.replace(/\./g,","));
    
  $("#config_buffer__power_temp").val(parseInt(temp_zas / 10));
  $("#config_buffer__out_of_schedule").prop("checked", outsched).checkboxradio("refresh");
  
    if (!validate($("#config_buffer__power_temp"), temp_zas_min,  temp_zas_max,  {})){
		$("#config_buffer_save").css("background-color","#CCCCCC");
		$("#config_buffer_save").css("color","#D9D9D9");
	}else{
		$("#config_buffer_save").css("background-color","");
		$("#config_buffer_save").css("color","#000000");
	}
}

/* ustawienie stanu bufora po dokonaniu walidacji, po sukcesie powrót do menu opcji */
function m_config_buffer__set() {
  var validation = true;

  if(!validate($("#config_buffer__power_temp"), temp_zas_min, temp_zas_max, {})) { validation = false; }

  if(validation) {
    temp_zas = parseInt($("#config_buffer__power_temp").val())* 10;
    outsched = $("#config_buffer__out_of_schedule").prop("checked");

    setReg("0b8e", regToHex(temp_zas, false));
    reg = regToInt(getReg("0b55", "1")["0b55"]);
    reg = setBit(reg, 13, outsched);
    setReg("0b55", regToHex(reg));

    window.location.href = "#config";
  } 
}
</script>
<!-- /page config_buffer -->

<!-- page: #config_co -->
<div data-role="page" id="config_co_win" data-theme="a">
  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">obieg co</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#config" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main">
    <div class="ui-body">
      <ul data-role="listview" data-inset="true">
        <li id="config_co_temp_max_li" class="ui-body" style="display: none;">
		<label>temp. zasilania max</label>
		<label id="config_co_win_info_1" style="display:none;">zakres: </label>
		<input data-clear-btn="false" id="config_co_temp_max" type="number">
		</li>
        <li id="config_co_temp_man_li" class="ui-body" style="display: none;">
		<label>temp. zasilania ręczna</label>
		<label id="config_co_win_info_2" style="display:none;">zakres: </label>
		<input data-clear-btn="false" id="config_co_temp_man" type="number">
		</li>
        <li class="ui-body">
		<label>temp. zewnętrznego wyłączenia</label>
		<label id="config_co_win_info_3" style="display:none;">zakres: </label>
		<input data-clear-btn="false" id="config_co_temp_out" type="number">
		</li>
        <li id="config_co_set_li" class="ui-body" style="display: none;">
          <label>regulacja</label>
          <select id="config_co_set" onchange="reg_config_co()">
            <option value="0">krzywa grzania</option>
            <option value="1">nastawa ręczna</option>
          </select>
        </li>
        <li class="ui-body" id="config_co_nr_li" style="display: none;">
		<label>numer krzywej grzania</label>
		<label id="config_co_win_info_4" style="display:none;">zakres: </label>
		<input data-clear-btn="false" id="config_co_nr" type="number">
		</li>
        <li class="ui-body" id="config_co_mv_li" style="display: none;">
		<label>przesunięcie krzywej</label>
		<label id="config_co_win_info_5" style="display:none;">zakres: </label>
		<input data-clear-btn="false" id="config_co_mv" type="number">
		</li>
        <li class="ui-body" id="config_co_frozen_on_off_li"><label><input id="config_co_frozen_on_off" type="checkbox">ochrona przeciwzamrożeniowa budynku</label></li>
      </ul>
      <a data-direction="reverse" id="config_co_win_save" class="ui-btn ui-shadow ui-corner-all ui-btn-b" onclick="set_config_co();">zapisz i zamknij okno</a>
    </div>
  </div>
</div>

<script>$(document).on("pagechange", function () { if($("#config_co_win").is(":visible")) { get_config_co(); hideLoadingSpinner(); }});

/* zakresy walidacyjne */
var krzywa_grzania_min = 0;  var krzywa_grzania_max = 0;
var przesuniecie_min = 0;    var przesuniecie_max = 0;
var temp_zas_min = 0;        var temp_zas_max = 0;
var temp_zas_reczna_min = 0; var temp_zas_reczna_max = 0;
var temp_wyl_min = 0;        var temp_wyl_max = 0;
var mode_conf_co;
var msk_version = 0;         var msk_type = 0;

/* ustawienie początkowego wyświetlania */
$(function () {
    $("#config_co_temp_max_li").attr("style", "display:none");
    $("#config_co_temp_man_li").attr("style", "display:none");
    $("#config_co_set_li").attr("style", "display:none");
    $("#config_co_nr_li").attr("style", "display:none");
    $("#config_co_mv_li").attr("style", "display:none");
})
 
/* eventy na inputach - wyświetlanie zakresu oraz dynamiczna walidacja */
$("#config_co_temp_max").on("focusin", function(){
    if ($("#config_co_win").is(":visible")){
	$("#config_co_win_info_1").show();
    }
});

$("#config_co_temp_max").on("focusout", function(){
    if ($("#config_co_win").is(":visible")){
	$("#config_co_win_info_1").hide();
    }
});

$("#config_co_temp_man").on("focusin", function(){
    if ($("#config_co_win").is(":visible")){
	$("#config_co_win_info_2").show();
    }
});

$("#config_co_temp_man").on("focusout", function(){
    if ($("#config_co_win").is(":visible")){
	$("#config_co_win_info_2").hide();
    }
});

$("#config_co_temp_out").on("focusin", function(){
    if ($("#config_co_win").is(":visible")){
	$("#config_co_win_info_3").show();
    }
});

$("#config_co_temp_out").on("focusout", function(){
    if ($("#config_co_win").is(":visible")){
	$("#config_co_win_info_3").hide();
    }
});

$("#config_co_nr").on("focusin", function(){
    if ($("#config_co_win").is(":visible")){
	$("#config_co_win_info_4").show();
    }
});

$("#config_co_nr").on("focusout", function(){
    if ($("#config_co_win").is(":visible")){
	$("#config_co_win_info_4").hide();
    }
});

$("#config_co_mv").on("focusin", function(){
    if ($("#config_co_win").is(":visible")){
	$("#config_co_win_info_5").show();
    }
});

$("#config_co_mv").on("focusout", function(){
    if ($("#config_co_win").is(":visible")){
	$("#config_co_win_info_5").hide();
    }
});

$("#config_co_temp_max").on("input", function(){
    if ($("#config_co_win").is(":visible")){
        temp_zas_reczna_max = parseInt($("#config_co_temp_max").val());
        if (temp_zas_reczna_max > temp_zas_max) temp_zas_reczna_max = temp_zas_max;
        else if (temp_zas_reczna_max < temp_zas_min) temp_zas_reczna_max = temp_zas_min;
        var text = "zakres: " + temp_zas_reczna_min + " ÷ " + temp_zas_reczna_max + " " + "[°C]";
		$("#config_co_win_info_2").text(text.replace(/\./g,","));
		validate_config_co();
    }
});

$("#config_co_temp_man").on("input", function(){
    if ($("#config_co_win").is(":visible")){
		validate_config_co();
    }
});

$("#config_co_temp_out").on("input", function(){
    if ($("#config_co_win").is(":visible")){
		validate_config_co();
    }
});

$("#config_co_nr").on("input", function(){
    if ($("#config_co_win").is(":visible")){
		validate_config_co();
    }
});

$("#config_co_mv").on("input", function(){
    if ($("#config_co_win").is(":visible")){
		validate_config_co();
    }
});

/* funkcja walidująca każdą z kontrolek w wybranym trybie pracy */
function validate_config_co(){
	var validation = true;

    switch(mode_conf_co) {
        case 1:
            if(!validate($("#config_co_temp_max"), temp_zas_min,        temp_zas_max,        {})) { validation = false; }
			if(!validate($("#config_co_temp_out"), temp_wyl_min,        temp_wyl_max,        {})) { validation = false; }
            break;
        case 2:
			if(!validate($("#config_co_temp_out"), temp_wyl_min,        temp_wyl_max,        {})) { validation = false; }
            break;
        default:
			if(!validate($("#config_co_temp_max"), temp_zas_min,        temp_zas_max,        {})) { validation = false; }
			if(!validate($("#config_co_temp_out"), temp_wyl_min,        temp_wyl_max,        {})) { validation = false; }
			if(!validate($("#config_co_nr"),       krzywa_grzania_min,  krzywa_grzania_max,  {})) { validation = false; }
			if(!validate($("#config_co_mv"),       przesuniecie_min,    przesuniecie_max,    {})) { validation = false; }   
			if(!validate($("#config_co_temp_man"), temp_zas_reczna_min, temp_zas_reczna_max, {})) { validation = false; }
    }
	
	if (!validation){
		$("#config_co_win_save").css("background-color","#CCCCCC");
		$("#config_co_win_save").css("color","#D9D9D9");
	}else{
		$("#config_co_win_save").css("background-color","");
		$("#config_co_win_save").css("color","#000000");
	}
	
	return validation;
}

/* ładowanie zmiennych i zakresów walidacyjnych oraz ustawienie interfejsu zależnie od trybu */ 
  function get_config_co() {
    var reg_val = getReg("0bba", "12");
    var mode_conf_co = regToInt(getReg("0b8a", "1")["0b8a"]);  
    var reg1 = getReg("0b71", "4");
    var reg2 = getReg("0b7b", "1");
    var reg3 = getReg("0b55", "1");
    
    /* wersja MSK */
    $.ajax({
      type: 'GET',
      url: "api/dev/" + id + "/info",
      timeout: 5000,
      dataType: 'json',
      async: false,
      success: function(data) {
         msk_version = parseInt(data["info"]["prg_msk_ver"]);
         msk_type = parseInt(data["info"]["prg_msk_type"]);
      },
        error: function() {
            window.location.href = "#api_error_dlg"; 
            hideLoadingSpinner();
        }
    });  
        
    if (msk_version < 44 && msk_type == 1){
        przesuniecie_min    = parseInt(regToInt(reg_val["0bca"])/10);      przesuniecie_max    = parseInt(regToInt(reg_val["0bcb"])/10);
        cp   = parseInt(regToInt(reg1["0b72"])/10);
    }
    else{
        przesuniecie_min    = parseInt(regToInt(reg_val["0bca"]));      przesuniecie_max    = parseInt(regToInt(reg_val["0bcb"]));
        cp   = regToInt(reg1["0b72"]);
    }
                
    krzywa_grzania_min  = parseInt(regToInt(reg_val["0bc8"]));      krzywa_grzania_max  = parseInt(regToInt(reg_val["0bc9"])); 
    temp_zas_min        = parseInt(regToInt(reg_val["0bba"])) / 10; temp_zas_max        = parseInt(regToInt(reg_val["0bbb"])) / 10;
    temp_zas_reczna_min = parseInt(regToInt(reg_val["0bba"])) / 10; temp_zas_reczna_max = parseInt(regToInt(reg_val["0bbb"])) / 10;
    temp_wyl_min        = parseInt(regToInt(reg_val["0bc2"])) / 10; temp_wyl_max        = parseInt(regToInt(reg_val["0bc3"])) / 10;
    
    var text = "zakres: " + temp_zas_min + " ÷ " + temp_zas_max + " " + "[°C]";
    $("#config_co_win_info_1").text(text.replace(/\./g,","));    
    $("#config_co_win_info_2").text(text.replace(/\./g,","));    
    text = "zakres: " + temp_wyl_min + " ÷ " + temp_wyl_max + " " + "[°C]";
    $("#config_co_win_info_3").text(text.replace(/\./g,","));    
    text = "zakres: " + krzywa_grzania_min + " ÷ " + krzywa_grzania_max;
    $("#config_co_win_info_4").text(text.replace(/\./g,","));    
    text = "zakres: " + przesuniecie_min + " ÷ " + przesuniecie_max + " " + "[°C]";
	$("#config_co_win_info_5").text(text.replace(/\./g,","));    

    cv   = regToInt(reg1["0b71"]);
    tman = regToInt(reg1["0b73"]) / 10;
    toff = regToInt(reg1["0b74"]) / 10;
    tmax = regToInt(reg2["0b7b"]) / 10;
    fp   = getBit(regToInt(reg3["0b55"]), 12);
    re   = getBit(regToInt(reg3["0b55"]), 14);

    $("#config_co_nr").val(cv);
    $("#config_co_mv").val(cp);
    $("#config_co_temp_max").val(tmax);
    $("#config_co_temp_man").val(tman);
    $("#config_co_temp_out").val(toff);
    $("#config_co_frozen_on_off").prop("checked", fp).checkboxradio("refresh");
    if(re) { $("#config_co_set").val(0).change(); } else { $("#config_co_set").val(1).change(); }

    if(setBit(reg3, 1)) {
        $("#config_co_frozen_on_off_li").attr("style", "display:none");
    } else { 
        $("#config_co_frozen_on_off_li").attr("style", "display:yes");
    }
 
    switch(mode_conf_co) {
        case 1:
            $("#config_co_temp_max_li").attr("style", "display:yes");
            $("#config_co_temp_man_li").attr("style", "display:none");
            $("#config_co_set_li").attr("style", "display:none");
            $("#config_co_nr_li").attr("style", "display:none");
            $("#config_co_mv_li").attr("style", "display:none");
            break;
        case 2:
            $("#config_co_temp_max_li").attr("style", "display:none");
            $("#config_co_temp_man_li").attr("style", "display:none");
            $("#config_co_set_li").attr("style", "display:none");
            $("#config_co_nr_li").attr("style", "display:none");
            $("#config_co_mv_li").attr("style", "display:none");
            break;
        default:
          $("#config_co_temp_max_li").attr("style", "display:yes");
          $("#config_co_temp_man_li").attr("style", "display:yes");
          $("#config_co_set_li").attr("style", "display:yes");
          $("#config_co_nr_li").attr("style", "display:yes");
          $("#config_co_mv_li").attr("style", "display:yes");
    }
    reg_config_co();
	validate_config_co()
}

/* ustawianie parametrów po dokonaniu walidacji, po sukcesie powrót do menu opcji */ 
  function set_config_co() {
    if(validate_config_co()) {
      krzywa_grzania = parseInt($("#config_co_nr").val());
      
      if (msk_version < 44 && msk_type == 1){
          przesuniecie   = parseInt($("#config_co_mv").val() * 10);
      }
      else{
          przesuniecie   = parseInt($("#config_co_mv").val());
      }      
      
      regulacja      = parseInt($("#config_co_set").val());
      temp_max       = parseInt($("#config_co_temp_max").val() * 10);
      temp_zas       = parseInt($("#config_co_temp_man").val() * 10);
      temp_zew       = parseInt($("#config_co_temp_out").val() * 10);
      ochrona        = $("#config_co_frozen_on_off").prop("checked");

      setReg("0b71", regToHex(krzywa_grzania, false));
      setReg("0b72", regToHex(przesuniecie, false));
      setReg("0b73", regToHex(temp_zas, false));
      setReg("0b74", regToHex(temp_zew, false));
      setReg("0b7b", regToHex(temp_max, false));
      reg = regToInt(getReg("0b55", "1")["0b55"]);
      reg = setBit(reg, 12, ochrona);
      reg = setBit(reg, 14, (regulacja != 1));
      setReg("0b55", regToHex(reg));

      window.location.href = "#config";
    }
  }

/* funckja przełączająca interfejs zależnie wartości config_co_set */
  function reg_config_co() {
    if(parseInt($("#config_co_set").val())) {
        $("#config_co_nr_li").attr("style", "display:none");
        $("#config_co_mv_li").attr("style", "display:none");
    } else { 
        $("#config_co_nr_li").attr("style", "display:yes");
        $("#config_co_mv_li").attr("style", "display:yes");
    }
  }
</script>
<!-- /page config_boil -->

<!-- page: #config_boil -->
<div data-role="page" id="config_boil_win" data-theme="a">
  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">zasobnik cwu</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#config" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main">
    <div class="ui-body">
      <ul data-role="listview" data-inset="true">
        <li class="ui-body"><label><input id="config_boil_on_off" type="checkbox" onchange="zas_config_boil();">zasobnik włączony</label></li>
        <li class="ui-body" id="config_boil_reg_li">
          <label>regulacja</label>
          <select id="config_boil_reg">
            <option value="0">wewnętrzna</option>
            <option value="1">zewnętrzna</option>
          </select>
        </li>
        <li class="ui-body" id="config_boil_temp_li">
			<label>temperatura zasilania</label>
			<label id="config_boil_info_1" style="display:none;">zakres: </label>
			<input data-clear-btn="false" id="config_boil_temp" type="number"></li>
      </ul>
      <a id="config_boil_save" data-direction="reverse" class="ui-btn ui-shadow ui-corner-all ui-btn-b" onclick="set_config_boil();">zapisz i zamknij okno</a>
    </div>
  </div>
</div>

<script>$(document).on("pagechange", function () { if($("#config_boil_win").is(":visible")) { get_config_boil(); hideLoadingSpinner(); }});

/* zakresy walidacyjne */
	var temp_zas_min = 0;
	var temp_zas_max = 0;

/* eventy na inputach - wyświetlanie zakresu oraz dynamiczna walidacja */		
$("#config_boil_temp").on("focusin", function(){
    if ($("#config_boil_win").is(":visible")){
	$("#config_boil_info_1").show();
    }
});

$("#config_boil_temp").on("focusout", function(){
    if ($("#config_boil_win").is(":visible")){
	$("#config_boil_info_1").hide();
    }
});

$("#config_boil_temp").on("input", function(){
    if ($("#config_boil_win").is(":visible")){
		if (!validate($("#config_boil_temp"), temp_zas_min,  temp_zas_max,  {})){
			$("#config_boil_save").css("background-color","#CCCCCC");
			$("#config_boil_save").css("color","#D9D9D9");
		}else{
			$("#config_boil_save").css("background-color","");
			$("#config_boil_save").css("color","#000000");
		}
    }
});

/* ładowanie zmiennych i zakresów walidacyjnych */
  function get_config_boil() {
	var reg_val = getReg("0bbc", "2");
    var reg1 = getReg("0b8c", "1");
    var reg2 = getReg("0b55", "1");
	
	temp_zas_min = parseInt(regToInt(reg_val["0bbc"])) / 10;
	temp_zas_max = parseInt(regToInt(reg_val["0bbd"])) / 10;
	
	var text = "zakres: " + temp_zas_min + " ÷ " + temp_zas_max + " " + "[°C]";
	$("#config_boil_info_1").text(text.replace(/\./g,","));
    
    tz  = regToInt(reg1["0b8c"]);
    reg = getBit(regToInt(reg2["0b55"]), 2);
    wl  = getBit(regToInt(reg2["0b55"]), 4);

    $("#config_boil_temp").val(parseInt(tz / 10));
    if(!reg) { $("#config_boil_reg").val(0).change(); } else { $("#config_boil_reg").val(1).change(); }
    $("#config_boil_on_off").prop("checked", wl).checkboxradio("refresh");
	
	if (!validate($("#config_boil_temp"), temp_zas_min,  temp_zas_max,  {})){
		$("#config_boil_save").css("background-color","#CCCCCC");
		$("#config_boil_save").css("color","#D9D9D9");
	}else{
		$("#config_boil_save").css("background-color","");
		$("#config_boil_save").css("color","#000000");
	}
  }

/* ustawienie stanu zasobnika po dokonaniu walidacji, po sukcesie powrót do menu opcji */  
  function set_config_boil() {
	var validation = true;
    if(!validate($("#config_boil_temp"), temp_zas_min,  temp_zas_max,  {})) { validation = false; }

	if (validation){
		temperatura_zasilania = parseInt($("#config_boil_temp").val()) * 10;
		regulacja             = parseInt($("#config_boil_reg").val());
		zasobnik_on_off       = $("#config_boil_on_off").prop("checked");
		
		setReg("0b8c", regToHex(temperatura_zasilania, false));
		reg = regToInt(getReg("0b55", "1")["0b55"]);
		reg = setBit(reg, 4, zasobnik_on_off);
		reg = setBit(reg, 2, (regulacja == 1));
		setReg("0b55", regToHex(reg));
		
		window.location.href = "#config";
	}
  }

  /* reakcja na włączenie/wyłączenie zasobnika cwu */
  function zas_config_boil() {
    zasobnik_on_off  = $("#config_boil_on_off").prop("checked");

    if(zasobnik_on_off) {
        $("#config_boil_reg_li").attr("style", "display:yes");
        $("#config_boil_temp_li").attr("style", "display:yes");
		
		if (!validate($("#config_boil_temp"), temp_zas_min,  temp_zas_max,  {})){
			$("#config_boil_save").css("background-color","#CCCCCC");
			$("#config_boil_save").css("color","#D9D9D9");
		}else{
			$("#config_boil_save").css("background-color","");
			$("#config_boil_save").css("color","#000000");
		}
    } else { 
        $("#config_boil_reg_li").attr("style", "display:none");
        $("#config_boil_temp_li").attr("style", "display:none");
		$("#config_boil_save").css("background-color","");
		$("#config_boil_save").css("color","#000000");
    }

  }
</script>
<!-- /page config_boil -->

<!-- page: #config_room -->
<div data-role="page" id="config_room" data-theme="a">
  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">temperatura pokojowa</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#config" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main">
    <div class="ui-body">
      <ul data-role="listview" data-inset="true">
        <li id="config_room_reg" class="ui-body">
          <label>regulator</label>
          <select id="config_room_reg_selector">
            <option value="0">wewnętrzny</option>
            <option value="1">zewnetrzny</option>
          </select>
        </li>
        <li class="ui-body" id="config_room_temp_hysteresis_li">
	    <label>histereza</label>
	    <label id="config_room_info_1" style="display:none;">zakres: </label>
	    <input data-clear-btn="false" id="config_room_temp_hysteresis" type="number" step="0.1">
	</li>
        <li class="ui-body" id="config_room_temp_on_off_li"><label><input id="config_room_temp_on_off" type="checkbox">kontrola temp. pokojowej</label></li>
      </ul>
      <a data-direction="reverse" id="config_room_save"  class="ui-btn ui-shadow ui-corner-all ui-btn-b" onclick="set_config_room();">zapisz i zamknij okno</a>
    </div>
  </div>
</div>

<script>$(document).on("pagechange", function () { 
	if($("#config_room").is(":visible")) 
	{
		get_config_room();
		hideLoadingSpinner();
	}
});
  
/* zmienne walidacyjne */
  var histereza_min = 0;
  var histereza_max = 0;

/* eventy na inputach - wyświetlanie zakresu oraz dynamiczna walidacja */

/* zmiana interfejsu zależnie od trybu */
$("#config_room_reg").on("change", function(){
    if ($("#config_room").is(":visible")){
        switch(parseInt($("#config_room_reg_selector").val())){
            case 0:
                $("#config_room_temp_hysteresis_li").attr("style", "display:yes");
                $("#config_room_temp_on_off_li").attr("style", "display:yes");
                if (!validate($("#config_room_temp_hysteresis"), histereza_min,  histereza_max,  {})){
                    $("#config_room_save").css("background-color","#CCCCCC");
                    $("#config_room_save").css("color","#D9D9D9");
                }else{
                    $("#config_room_save").css("background-color","");
                    $("#config_room_save").css("color","#000000");
                }                
                break;
            case 1:
                $("#config_room_temp_hysteresis_li").attr("style", "display:none");
                $("#config_room_temp_on_off_li").attr("style", "display:none")
                $("#config_room_save").css("background-color","");
                $("#config_room_save").css("color","#000000");
                break;
        }
    }
});
	  
$("#config_room_temp_hysteresis").on("focusin", function(){
    if ($("#config_room").is(":visible")){
	$("#config_room_info_1").show();
    }
});

$("#config_room_temp_hysteresis").on("focusout", function(){
    if ($("#config_room").is(":visible")){
	$("#config_room_info_1").hide();
    }
});

$("#config_room_temp_hysteresis").on("input", function(){
    if ($("#config_room").is(":visible")){
		if (!validate($("#config_room_temp_hysteresis"), histereza_min,  histereza_max,  {})){
			$("#config_room_save").css("background-color","#CCCCCC");
			$("#config_room_save").css("color","#D9D9D9");
		}else{
			$("#config_room_save").css("background-color","");
			$("#config_room_save").css("color","#000000");
		}
    }
});

/* ładowanie zmiennych i zakresów walidacyjnych */
  function get_config_room() {
    var reg_val = getReg("0bc6", "2");
    var reg1    = getReg("0b75", "1");
    var reg2    = getReg("0b55", "1");

    histereza_min = parseInt(regToInt(reg_val["0bc6"])) / 10;
    histereza_max = parseInt(regToInt(reg_val["0bc7"])) / 10;
    var text = "zakres: " + histereza_min + " ÷ " + histereza_max + " " + "[°C]";
    $("#config_room_info_1").text(text.replace(/\./g,","));
    
    his = regToInt(reg1["0b75"]);
    reg = getBit(regToInt(reg2["0b55"]), 1);
    kn  = getBit(regToInt(reg2["0b55"]), 15);

    $("#config_room_temp_on_off").prop("checked", kn).checkboxradio("refresh");
    $("#config_room_temp_hysteresis").val((his / 10).toFixed(1));
    if(!reg) { $("#config_room_reg").val(0).change(); } else { $("#config_room_reg").val(1).change(); }

    buff = regToInt(getReg("0b8a", "1")["0b8a"]);

    if(buff == 2) {
      $("#config_room_reg").attr("style", "display:none");
    } else {
      $("#config_room_reg").attr("style", "display:yes");
    }
	
	if (!validate($("#config_room_temp_hysteresis"), histereza_min,  histereza_max,  {})){
		$("#config_room_save").css("background-color","#CCCCCC");
		$("#config_room_save").css("color","#D9D9D9");
	}else{
		$("#config_room_save").css("background-color","");
		$("#config_room_save").css("color","#000000");
	}
  }

/* zapis ustawień po dokonaniu walidacji i powrót do menu opcji */ 
  function set_config_room() {
    var validation = true;
    
    if (parseInt($("#config_room_reg_selector").val()) == 0){
        if(!validate($("#config_room_temp_hysteresis"), histereza_min,  histereza_max,  {})) { validation = false; } 
    }    
    
    if(validation) {
      kontrola_on_off = $("#config_room_temp_on_off").prop("checked");
      histereza       = parseInt($("#config_room_temp_hysteresis").val() * 10);
      regulator       = parseInt($("#config_room_reg").val());

      setReg("0b75", regToHex(histereza, false));
      reg = regToInt(getReg("0b55", "1")["0b55"]);
      reg = setBit(reg, 1, (regulator == 1));
      reg = setBit(reg, 15, kontrola_on_off);
      setReg("0b55", regToHex(reg));

      window.location.href = "#config";
    }
  }

</script>

<!-- /page config_room -->


<!-- page: #config_turbo -->
<div data-role="page" id="config_turbo_win" data-theme="a">
  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">tryb turbo</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#config" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main">
    <div class="ui-body">
      <ul data-role="listview" data-inset="true">
        <li class="ui-body"><label><input id="_config_turbo_on_off_" type="checkbox" onchange="aut_config_turbo();">automatycznie</label></li>
        <li class="ui-body" id="config_turbo_boil_on_off_li"><label><input id="config_turbo_boil_on_off" type="checkbox">priorytet zasobnika cwu</label></li>
        <li class="ui-body" id="config_turbo_hysteresis_li">
		<label>histereza trybu turbo</label>
		<label id="config_turbo_info_1" style="display:none;">zakres: </label>
		<input data-clear-btn="false" id="config_turbo_hysteresis" type="number">
		</li>
      </ul>
      <a id="config_turbo_save" data-direction="reverse" class="ui-btn ui-shadow ui-corner-all ui-btn-b" onclick="set_config_turbo();">zapisz i zamknij okno</a>
    </div>
  </div>
</div>

<script>$(document).on("pagechange", function () { if($("#config_turbo_win").is(":visible")) { get_config_turbo(); hideLoadingSpinner();}});

/* zakresy walidacyjne */
  var histereza_min = 0;
  var histereza_max = 0;

/* eventy na inputach - wyświetlanie zakresu oraz dynamiczna walidacja */
$("#config_turbo_hysteresis").on("focusin", function(){
    if ($("#config_turbo_win").is(":visible")){
	$("#config_turbo_info_1").show();
    }
});

$("#config_turbo_hysteresis").on("focusout", function(){
    if ($("#config_turbo_win").is(":visible")){
	$("#config_turbo_info_1").hide();
    }
});

$("#config_turbo_hysteresis").on("input", function(){
    if ($("#config_turbo_win").is(":visible")){
		if (!validate($("#config_turbo_hysteresis"), histereza_min,  histereza_max,  {})){
			$("#config_turbo_save").css("background-color","#CCCCCC");
			$("#config_turbo_save").css("color","#D9D9D9");
		}else{
			$("#config_turbo_save").css("background-color","");
			$("#config_turbo_save").css("color","#000000");
		}
    }
});
  
/* ładowanie zmiennych i zakresów walidacyjnych */
  function get_config_turbo() {
    var reg_val = getReg("0be0", "2");
    var reg1 = getReg("0b81", "1");
    var reg2 = getReg("0b55", "1");

    histereza_min = parseInt(regToInt(reg_val["0be0"])) / 10;
    histereza_max = parseInt(regToInt(reg_val["0be1"])) / 10;
    var text = "zakres: " + histereza_min + " ÷ " + histereza_max + " " + "[°C]";
    $("#config_turbo_info_1").text(text.replace(/\./g,","));
    
    his   = regToInt(reg1["0b81"]);
    tcwu  = getBit(regToInt(reg2["0b55"]), 0);
    tauto = getBit(regToInt(reg2["0b55"]), 11);

    $("#config_turbo_hysteresis").val((parseInt(his/10)));
    $("#config_turbo_boil_on_off").prop("checked", tcwu).checkboxradio("refresh");
    $("#config_turbo_on_off").prop("checked", tauto).checkboxradio("refresh");

    if(getBit(reg2, 4)) {
        $("#config_turbo_boil_on_off_li").attr("style", "display:none");
    } else {
        $("#config_turbo_boil_on_off_li").attr("style", "display:yes");
    }

	validate($("#config_turbo_hysteresis"), histereza_min,  histereza_max,  {});
    aut_config_turbo()
  }

 /* ustawienie parametrów w trybie turbo po dokonaniu walidacji i powrót do menu opcji */  
  function set_config_turbo() {
	if ($("#_config_turbo_on_off_").prop("checked")){
		var validation = true;
		
		if(!validate($("#config_turbo_hysteresis"), histereza_min,  histereza_max,  {})) { validation = false; }
		
		if(validation) {
			histereza = parseInt($("#config_turbo_hysteresis").val()) * 10;
			priorytet = $("#config_turbo_boil_on_off").prop("checked");
			turbo     = $("#_config_turbo_on_off_").prop("checked");
			
			setReg("0b81", regToHex(histereza, false));	
			reg = regToInt(getReg("0b55", "1")["0b55"]);
			reg = setBit(reg, 0, priorytet);
			reg = setBit(reg, 11, turbo);
			setReg("0b55", regToHex(reg));
			
			window.location.href = "#config";	
		}
	}
	else{
		    var reg1 = getReg("0b81", "1");
			histereza = parseInt(regToInt(reg1["0b81"]));
			priorytet = $("#config_turbo_boil_on_off").prop("checked");
			turbo     = $("#_config_turbo_on_off_").prop("checked");
			
			setReg("0b81", regToHex(histereza, false));	
			reg = regToInt(getReg("0b55", "1")["0b55"]);
			reg = setBit(reg, 0, priorytet);
			reg = setBit(reg, 11, turbo);
			setReg("0b55", regToHex(reg));
			
			window.location.href = "#config";	
	}
  }

  /* przełączanie interfejsu zależnie od stanu checkboxa */
  function aut_config_turbo() {
    if($("#_config_turbo_on_off_").prop("checked")) {
      $("#config_turbo_hysteresis_li").attr("style", "display:yes");
	  	if (!validate($("#config_turbo_hysteresis"), histereza_min,  histereza_max,  {})){
			$("#config_turbo_save").css("background-color","#CCCCCC");
			$("#config_turbo_save").css("color","#D9D9D9");
		}else{
			$("#config_turbo_save").css("background-color","");
			$("#config_turbo_save").css("color","#000000");
		}
    } else {
      $("#config_turbo_hysteresis_li").attr("style", "display:none");
	  $("#config_turbo_save").css("background-color","");
	  $("#config_turbo_save").css("color","#000000");
    }
  }</script>
<!-- /page config_turbo -->

<!-- page: #config_pump -->
<div data-role="page" id="config_pump" data-theme="a">
  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">pompa</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#config" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main">
    <div class="ui-body">
      <ul data-role="listview" data-inset="true">
        <li>
          <label>typ</label>
          <select id="config_pump_type" onchange="">
            <option value="0">Wilo</option>
            <option value="1">Grundfos</option>
          </select>
        </li>
        <li id="config_pump_lift_li" class="ui-body">
          <label>wysokość podnoszenia [m]</label>
          <select id="config_pump_lift">
          </select>
        </li>
        <li id="config_pump_reg_li">
          <label>regulacja</label>
          <select id="config_pump_reg">
            <option value="0">delta p-zmienne</option>
            <option value="1">delta p-stale</option>
          </select>
        </li>
        <li class="ui-body"><label><input id="config_pump_auto" type="checkbox">praca automatyczna</label></li>
        <li class="ui-body"><label><input id="config_pump_venting" type="checkbox">odpowietrzanie teraz</label></li>
        <li>
		<label>godzina ochrony pompy</label>
		<input data-clear-btn="true" id="config_pump_protect_time" type="time">	
		</li>
      </ul>
      <a id="config_pump_save" data-direction="reverse" class="ui-btn ui-shadow ui-corner-all ui-btn-b" onclick="set_config_pump();">zapisz i zamknij okno</a>
    </div>
  </div>
</div>

<script>$(document).on("pagechange", function () { if($("#config_pump").is(":visible")) { get_config_pump(); hideLoadingSpinner(); }});

/* event do sprawdzania stanu zegara na kontrolce przy zmianie */
$("#config_pump_protect_time").on("change", function(){
    if ($("#config_pump").is(":visible")){
		validate_config_pump();
    }
});

/* funkcja walidująca stan zegara na kontrolce */
  function validate_config_pump(){
	  var validation = true;
	  
	  	if ($("#config_pump_protect_time").val()){
			$("#config_pump_save").css("background-color","");
			$("#config_pump_save").css("color","#000000");
			$("#config_pump_protect_time").attr("style", "color: black; font-weight: normal;");
			$("#config_pump_protect_time").css("background-color", "transparent");
			$("#config_pump_protect_time").css("border","2px solid transparent");
		}else{
			$("#config_pump_save").css("background-color","#CCCCCC");
			$("#config_pump_save").css("color","#D9D9D9");		
			$("#config_pump_protect_time").attr("style", "color: black; font-weight: bold;");
			$("#config_pump_protect_time").css("background-color","#FF9999");
			$("#config_pump_protect_time").css("border","2px solid red");
			validation = false;
		}
	  
	  return validation;
  }

  /* pobieranie aktualnych ustawień */
  function get_config_pump() {
    var tryb_pracy = regToInt(getReg("0b8a", "1")["0b8a"]); 
    if (tryb_pracy == 2){
        $("#config_pump_lift_li").hide();  
        $("#config_pump_reg_li").hide();    
    }
    else{
        $("#config_pump_lift_li").show();  
        $("#config_pump_reg_li").show();          
    }

    var reg_idx     = getReg("0b82", "2");
    var reg_idx_val = getReg("0b25", "7");
    var reg_protect = getReg("0b58", "2");
    var config1     = getReg("0b54", "2");

    idx     = parseInt(regToInt(reg_idx["0b83"]));
    idx_bor = parseInt(regToInt(reg_idx_val["0b25"]));

    var sel = document.getElementById("config_pump_lift");
    sel.innerHTML = "";
    for(i = 0; i <= idx_bor; i++) {
      var option   = document.createElement("option");
      option.text  = (regToInt(reg_idx_val[regToHex(2854 + i, true)]) / 10).toFixed(1);
      option.value = i;
      sel.add(option, sel[i]);
    }
    $("#config_pump_lift").val(idx).change();

    $("#config_pump_protect_time").val(minutesToTime(regToInt(reg_protect["0b59"])));
    $("#config_pump_auto").prop("checked", getBit(regToInt(config1["0b55"]), 8)).checkboxradio("refresh");
    $("#config_pump_venting").prop("checked", getBit(regToInt(config1["0b54"]), 13)).checkboxradio("refresh");
    $("#config_pump_type").val(regToInt(reg_protect["0b58"])).change();
    $("#config_pump_reg").val(regToInt(reg_idx["0b82"])).change();
	
	validate_config_pump();
  }

  /* zapisywanie ustawień pod warunkiem sukcesu walidacji, a następnie powrót do menu opcji */
  function set_config_pump() {
	 
	var validation = validate_config_pump();
	
	if (validation){
	     wys_podnoszenia    = parseInt($("#config_pump_lift").val());
		ochrona_pompy      = (parseInt($("#config_pump_protect_time").val().split(":")[0]) * 60) + parseInt($("#config_pump_protect_time").val().split(":")[1]);
		praca_automatyczna = $("#config_pump_auto").prop("checked");
		odpowietrzanie     = $("#config_pump_venting").prop("checked");
		typ                = parseInt($("#config_pump_type").val());
		regulacja          = parseInt($("#config_pump_reg").val());
		
		setReg("0b83", regToHex(wys_podnoszenia, false));
		setReg("0b59", regToHex(ochrona_pompy, false));
		setReg("0b58", regToHex(typ, false));
		setReg("0b82", regToHex(regulacja, false));
		reg = regToInt(getReg("0b55", "1")["0b55"]);
		reg = setBit(reg, 8, praca_automatyczna);
		setReg("0b55", regToHex(reg));
		reg = regToInt(getReg("0b54", "1")["0b54"]);
		reg = setBit(reg, 13, odpowietrzanie);
		setReg("0b54", regToHex(reg));

		window.location.href = "#config";
	}
  }</script>
<!-- /page config_pump -->

<!-- page: #config_circ -->
<div data-role="page" id="config_circ" data-theme="a">
  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">cyrkulacja cwu</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#config" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main">
    <div class="ui-body">
      <ul data-role="listview" data-inset="true">
        <li class="ui-body"><label><input id="config_circ_on_off" type="checkbox">cyrkulacja włączona</label></li></li>
      </ul>
      <a href="#config" data-direction="reverse" class="ui-btn ui-shadow ui-corner-all ui-btn-b" onclick="set_config_circ();">zapisz i zamknij okno</a>
    </div>
  </div>
</div>

<script>$(document).on("pagechange", function () { if($("#config_circ").is(":visible")) { get_config_circ(); hideLoadingSpinner();}});

  /* pobranie aktualnych ustawień */
  function get_config_circ() {
    var reg1 = getReg("0b54", "1");

    circ = getBit(regToInt(reg1["0b54"]), 2);
    $("#config_circ_on_off").prop("checked", circ).checkboxradio("refresh");
  }

  /* ustawienie cyrkulacji cwu */
  function set_config_circ() {
    cyrkulacja = $("#config_circ_on_off").prop("checked");

    reg = regToInt(getReg("0b54", "1")["0b54"]);
    reg = setBit(reg, 2, cyrkulacja);
    setReg("0b54", regToHex(reg));
  }
</script>
<!-- /page config_circ -->

<!-- page: #config_power -->
<div data-role="page" id="config_power_win" data-theme="a">
  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">moc kotła</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#config" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main">
    <div class="ui-body">
      <ul data-role="listview" data-inset="true">
        <li class="ui-body">
          <label for="config_power">moc kotła [kW]:</label>
          <select name="config_power" id="config_power">
          </select>
        </li>
      </ul>
      <a href="#config" data-direction="reverse" class="ui-btn ui-shadow ui-corner-all ui-btn-b" onclick="set_config_power();">zapisz i zamknij okno</a>
    </div>
  </div>
</div>

<script>$(document).on("pagechange", function () { if($("#config_power_win").is(":visible")) { get_config_power(); hideLoadingSpinner(); }});

  /* pobranie aktualnej mocy kotła */
  function get_config_power() {
    var reg_idx     = getReg("0b62", "1");
    var reg_idx_bor = getReg("0b35", "6");

    idx     = parseInt(regToInt(reg_idx["0b62"]));
    idx_bor = parseInt(regToInt(reg_idx_bor["0b35"]));

    var sel = document.getElementById("config_power");
    sel.innerHTML = "";
    for(i = 0; i < idx_bor; i++) {
      var option   = document.createElement("option");
      option.text  = (regToInt(reg_idx_bor[regToHex(2870 + i, true)]) / 10).toFixed(1);
      option.value = i;
      sel.add(option, sel[i]);
    }
    $("#config_power").val(idx).change();
  }

  /* ustawienie mocy kotła */
  function set_config_power() {
    setReg("0b62", regToHex(parseInt($("#config_power").val()), false));
  }
</script>
<!-- /page config_power -->

<!-- page: #config_fun -->
<div data-role="page" id="config_fun" data-theme="a">
  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">wejście funkcyjne</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#config" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main">
    <div class="ui-body">
       <div data-role="controlgroup">
        <input name="radio-choice-v-2" id="radio-choice-v-2a" value="on" checked="checked" type="radio">
        <label for="radio-choice-v-2a">wejście nieaktywne</label>
        <input name="radio-choice-v-2" id="radio-choice-v-2b" value="off" type="radio">
        <label for="radio-choice-v-2b">temperatura przeciwzamrożeniowa</label>
        <input name="radio-choice-v-2" id="radio-choice-v-2c" value="other" type="radio">
        <label for="radio-choice-v-2c">temperatura ekonomiczna</label>
      </div>
      <a href="#config" data-direction="reverse" class="ui-btn ui-shadow ui-corner-all ui-btn-b" onclick="set_config_fun();">zapisz i zamknij okno</a>
    </div>
  </div>
</div>

<script>$(document).on("pagechange", function () { if($("#config_fun").is(":visible")) { get_config_fun(); hideLoadingSpinner();}});

/* eventy do zmiany checkboxów */
$("#radio-choice-v-2a").on("click", function(){
    if ($("#config_fun").is(":visible")){
		$("#radio-choice-v-2a").prop("checked", true).checkboxradio("refresh");
		$("#radio-choice-v-2b").prop("checked", false).checkboxradio("refresh");
		$("#radio-choice-v-2c").prop("checked", false).checkboxradio("refresh");
    }
});

$("#radio-choice-v-2b").on("click", function(){
    if ($("#config_fun").is(":visible")){
		$("#radio-choice-v-2a").prop("checked", false).checkboxradio("refresh");
		$("#radio-choice-v-2b").prop("checked", true).checkboxradio("refresh");
		$("#radio-choice-v-2c").prop("checked", false).checkboxradio("refresh");
    }
});

$("#radio-choice-v-2c").on("click", function(){
    if ($("#config_fun").is(":visible")){
		$("#radio-choice-v-2a").prop("checked", false).checkboxradio("refresh");
		$("#radio-choice-v-2b").prop("checked", false).checkboxradio("refresh");
		$("#radio-choice-v-2c").prop("checked", true).checkboxradio("refresh");
    }
});

/* pobieranie aktualnych ustawień */
  function get_config_fun() {
    var reg1 = getReg("0b7f", "1");

    $("#radio-choice-v-2a").prop("checked", false).checkboxradio("refresh");
    $("#radio-choice-v-2b").prop("checked", false).checkboxradio("refresh");
    $("#radio-choice-v-2c").prop("checked", false).checkboxradio("refresh");

    switch(regToInt(reg1["0b7f"])) {
      case 0: $("#radio-choice-v-2a").prop("checked", true).checkboxradio("refresh"); break;
      case 1: $("#radio-choice-v-2b").prop("checked", true).checkboxradio("refresh"); break;
      case 2: $("#radio-choice-v-2c").prop("checked", true).checkboxradio("refresh"); break;
    }
  }

/* ustawianie na bazie aktualnego stanu checkboxów */
  function set_config_fun() {
    sel1 = $("#radio-choice-v-2a").prop("checked");
    sel2 = $("#radio-choice-v-2b").prop("checked");
    sel3 = $("#radio-choice-v-2c").prop("checked");

    if(sel1) { setReg("0b7f", regToHex(0, false)); }
    if(sel2) { setReg("0b7f", regToHex(1, false)); }
    if(sel3) { setReg("0b7f", regToHex(2, false)); }
  }</script>
<!-- /page config_fun -->

<!-- page: #config_preasure_control -->
<div data-role="page" id="config_preasure_control" data-theme="a">
  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">kontrola ciśnienia</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#config" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main">
    <div class="ui-body">
      <ul data-role="listview" data-inset="true">
        <li class="ui-body"><label><input id="config_preasure" type="checkbox">kontrola ciśnienia</label></li>
      </ul>
      <a href="#config" data-direction="reverse" class="ui-btn ui-shadow ui-corner-all ui-btn-b" onclick="set_config_preasure_control();">zapisz i zamknij okno</a>
    </div>
  </div>
</div>

<script>$(document).on("pagechange", function () { if($("#config_preasure_control").is(":visible")) { get_config_preasure_control(); hideLoadingSpinner(); }});

  /* pobranie aktualnego stanu kontroli ciśnienia */
  function get_config_preasure_control() {
    var reg1 = getReg("0b54", "1");
    $("#config_preasure").prop("checked", getBit(regToInt(reg1["0b54"]), 8)).checkboxradio("refresh");
  }

  /* ustawienie stanu kontroli ciśnienia */
  function set_config_preasure_control() {
    reg = regToInt(getReg("0b54", "1")["0b54"]);
    reg = setBit(reg, 8, $("#config_preasure").prop("checked"));
    setReg("0b54", regToHex(reg));
  }
</script>
<!-- /page config_preasure_control -->

<!-- page: #config_mode -->
<div data-role="page" id="config_mode" data-theme="a">
  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">tryb pracy</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#config" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline">&nbsp;</a>
  </div>

  <div role="main">
    <div class="ui-body">
      <ul data-role="listview" data-inset="true">
        <li id="config_mode__li" class="ui-body">
          <label>tryb pracy</label>
          <select id="config_mode__select" onchange="">
            <option value="0">podstawowy</option>
            <option value="1">źródło ciepła</option>
            <option id="config_mode__select__buffer" value="2" style="display:none;">bufor</option>
          </select>
        </li>
      </ul>
      <a data-direction="reverse" class="ui-btn ui-shadow ui-corner-all ui-btn-b" onclick="config_mode__save()">zapisz i zamknij</a>
    </div>
  </div>
</div>

<script>$(document).on("pagechange", function () { if($("#config_mode").is(":visible")) { config_mode__start(); hideLoadingSpinner();}});

/* zakresy walidacyjne */
var mode_min         = -1
var mode_max         = -1

/* ładowanie zmiennych i zakresów walidacyjnych */
function config_mode__start() {
  var mode = regToInt(getReg("0b8a", "1")["0b8a"])
  mode_min = regToInt(getReg("0be5", "1")["0be5"])
  mode_max = regToInt(getReg("0be6", "1")["0be6"])

  if(mode_max == 2) { $("#config_mode__select__buffer").attr("style", "display:yes")  }
               else { $("#config_mode__select__buffer").attr("style", "display:none") }

  $("#config_mode__select").val(mode).change()
}

/* ustawienie trybu pracy */
function config_mode__save() {
  setReg("0b8a", regToHex(parseInt($("#config_mode__select").val()), false));
  window.location.href = "#config";
  showLoadingSpinner();
}</script>
<!-- /page config_mode -->


<!-- page: #params -->
<div data-role="page" id="params" data-theme="a">
  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">podgląd parametrów</a></h1>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-home ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
    <a href="#start" class="ui-btn ui-shadow ui-corner-all ui-icon-carat-r ui-btn-icon-notext ui-btn-inline" onclick="showLoadingSpinner();">&nbsp;</a>
  </div>

  <div role="main">
    <div class="ui-body">
      <ul data-role="listview" data-inset="true">
        <li class="ui-body"><label><table width="100%"><tr><td>temperatura wlotowa</td><td align="right" id="params_temp_in" style="font-weight: bold;"></td></tr></table></label></li>
        <li class="ui-body"><label><table width="100%"><tr><td>temperatura wylotowa</td><td align="right" id="params_temp_out" style="font-weight: bold;"></td></tr></table></label></li>
        <li class="ui-body"><label><table width="100%"><tr><td>nastawa czynnika</td><td align="right" id="params_temp_factor" style="font-weight: bold;"></td></tr></table></label></li>
        <li class="ui-body"><label><table width="100%"><tr><td>temperatura pokojowa</td><td align="right" id="params_temp_room" style="font-weight: bold;"></td></tr></table></label></li>
        <li class="ui-body"><label><table width="100%"><tr><td>temperatura zewnętrzna</td><td align="right" id="params_temp_outside" style="font-weight: bold;"></td></tr></table></label></li>
        <li class="ui-body" id="_params_cwu_"><label><table width="100%"><tr><td>temperatura zasobnika</td><td align="right" id="params_temp_boil" style="font-weight: bold;"></td></tr></table></label></li>
        <li class="ui-body"><label><table width="100%"><tr><td>moc załączona</td><td align="right" id="params_power" style="font-weight: bold;"></td></tr></table></label></li>
        <li class="ui-body"><label><table width="100%"><tr><td>ciśnienie</td><td align="right" id="params_preasure" style="font-weight: bold;"><b></b></td></tr></table></label></li>
        <li class="ui-body"><label><table width="100%"><tr><td>przepływ</td><td align="right" id="params_flow" style="font-weight: bold;"></td></tr></table></label></li>
        <li class="ui-body"><label><table width="100%"><tr><td>pompa obiegowa</td><td align="right"><input type="checkbox" data-role="flipswitch" data-on-text="wł." data-off-text="wył." data-wrapper-class="custom-label-flipswitch" disabled="disabled" id="params_pump"></td></tr></table></label></li>
        <li class="ui-body" id="_params_circ_"><label><table width="100%"><tr><td>pompa cyrkulacyjna cwu</td><td align="right"><input type="checkbox" data-role="flipswitch" data-on-text="wł." data-off-text="wył." data-wrapper-class="custom-label-flipswitch" disabled="disabled" id="params_circ"></td></tr></table></label></li>
        <li class="ui-body" id="_params_valve_"><label><table width="100%"><tr><td>zawór trójdrogowy</td><td align="right"><input type="checkbox" data-role="flipswitch" data-on-text="cwu" data-off-text="co" data-wrapper-class="custom-label-flipswitch" disabled="disabled" id="params_valve"></td></tr></table></label></li>
        <li class="ui-body"><label><table width="100%"><tr><td>wejście NA</td><td align="right"><input type="checkbox" data-role="flipswitch" data-on-text="wł." data-off-text="wył." data-wrapper-class="custom-label-flipswitch" disabled="disabled" id="params_na"></td></tr></table></label></li>
        <li class="ui-body"><label><table width="100%"><tr><td>wejście RP</td><td align="right"><input type="checkbox" data-role="flipswitch" data-on-text="wł." data-off-text="wył." data-wrapper-class="custom-label-flipswitch" disabled="disabled" id="params_rp"></td></tr></table></label></li>
        <li class="ui-body"><label><table width="100%"><tr><td>wejście FUN</td><td align="right"><input type="checkbox" data-role="flipswitch" data-on-text="wł." data-off-text="wył." data-wrapper-class="custom-label-flipswitch" disabled="disabled" id="params_fun"></td></tr></table></label></li>
    </div>
  </div>
</div>
<!-- /page params -->
<style>
.ui-state-disabled { opacity: 1.0; }
</style>
<script>
$(document).on("pagechange", function () { if($("#params").is(":visible")) { ref_params(); hideLoadingSpinnerWithDelay(); }});

$(function () { setInterval(vis_params_const, 5000); })

function vis_params_const() { if($("#params").is(":visible")) { ref_params(); } }

/* odświeżenie wyświetlanych parametrów */
function ref_params() {
  var regs = getReg("0b54", "2");
  var reg1 = regToInt(regs["0b55"]);
  var reg2 = regToInt(regs["0b54"]);
  termostat = getBit(reg1, 2);
  cwu       = getBit(reg1, 4);
  circ      = getBit(reg2, 2);

  if(!cwu)      { $("#_params_valve_").hide();  }
  if(!cwu)      { $("#_params_cwu_").hide();  }
  if(termostat) { $("#_params_cwu_").hide();  }
  if(!circ)     { $("#_params_circ_").hide(); }

  var data         = getReg("0b2f", "30");
  var temp_in      = regToInt(data["0b48"]) / 10;
  var temp_out     = regToInt(data["0b49"]) / 10;
  var temp_factor  = regToInt(data["0b44"]) / 10;
  var temp_room    = regToInt(data["0b4b"]) / 10;
  var temp_outside = regToInt(data["0b4c"]) / 10;
  var temp_boil    = regToInt(data["0b4a"]) / 10;
  var power        = regToInt(data["0b46"]) / 10;;
  var preasure     = regToInt(data["0b4e"]) / 100;
  var flow         = regToInt(data["0b4f"]) / 10;
  var pump         = getBit(regToInt(data["0b51"]), 0);
  var circ         = getBit(regToInt(data["0b51"]), 1);
  var valve        = getBit(regToInt(data["0b51"]), 2);
  var na           = getBit(regToInt(data["0b51"]), 3);
  var rp           = getBit(regToInt(data["0b51"]), 4);
  var fun          = getBit(regToInt(data["0b51"]), 6);

  if (temp_in <= -100){
      $("#params_temp_in").text("Serwis");
      $("#params_temp_in").css("color","rgb(232, 123, 30)");
  }else{
      $("#params_temp_in").text(temp_in.toFixed(0) + " °C");
      $("#params_temp_in").css("color","");
  }
  if (temp_out <= -100){
      $("#params_temp_out").text("Serwis");
      $("#params_temp_out").css("color","rgb(232, 123, 30)");
  }else{
      $("#params_temp_out").text(temp_out.toFixed(0) + " °C");
      $("#params_temp_out").css("color","");
  }
  if (temp_factor <= -100){
      $("#params_temp_factor").text("Serwis");
      $("#params_temp_factor").css("color","rgb(232, 123, 30)");
  }else{
      $("#params_temp_factor").text(temp_factor.toFixed(0) + " °C");
      $("#params_temp_factor").css("color","");
  }  
  if (temp_room <= -100){
      $("#params_temp_room").text("Serwis");
      $("#params_temp_room").css("color","rgb(232, 123, 30)");
  }else{
      $("#params_temp_room").text(temp_room.toFixed(1) + " °C");
      $("#params_temp_room").css("color","");
  }   
  if (temp_outside <= -100){
      $("#params_temp_outside").text("Serwis");
      $("#params_temp_outside").css("color","rgb(232, 123, 30)");
  }else{
      $("#params_temp_outside").text(temp_outside.toFixed(1) + " °C");
      $("#params_temp_outside").css("color","");
  }
  if (temp_boil <= -100){
      $("#params_temp_boil").text("Serwis");
      $("#params_temp_boil").css("color","rgb(232, 123, 30)");
  }else{
      $("#params_temp_boil").text(temp_boil.toFixed(0) + " °C");
      $("#params_temp_boil").css("color","");
  }    
//  setTemp(data["0b4a"], "params_temp_boil", 0);
  $("#params_power").text(power.toFixed(1) + " kW");
  $("#params_preasure").text(preasure.toFixed(2) + " bar");
  $("#params_flow").text(flow.toFixed(1) + " l/min");
  $("#params_pump").prop("checked", pump).flipswitch("refresh");
  $("#params_circ").prop("checked", circ).flipswitch("refresh");
  $("#params_valve").prop("checked", valve).flipswitch("refresh");
  $("#params_na").prop("checked", na).flipswitch("refresh");
  $("#params_rp").prop("checked", rp).flipswitch("refresh");
  $("#params_fun").prop("checked", fun).flipswitch("refresh");
}

</script>
<!-- Start of third page: #about -->
<div data-role="page" id="about" data-close-btn="right">
    
  <div data-role="header" data-theme="b">
    <h1>Informacja</h1>
  </div>
  
  <div role="main" class="ui-body">
    <h2 id="ekd_about_message_title">MI.01</h2>
    <p id="ekd_about_message">Moduł Internetowy do zarządzania wyposażeniem systemowym firmy KOSPEL S.A.</p>
  </div>

  <div data-role="footer">
    <h1 id="ekd_about_footer">wer. </h1>
  </div>
</div>

<script>$(document).on("pagechange", function () {
    if($("#about").is(":visible")) {
        getInfo();
    }
});

$("#about").off("pagehide").on("pagehide",function(){
    if ($("#start").is(":visible"))
    {
        showLoadingSpinner();
    }      
});

function getInfo() {
  $.ajax({
    complete: function() { hideLoadingSpinner();},
    type: 'GET',
    url: "api/cmi/info",
    timeout: 5000,
    dataType: 'json',
	async: false,
    success: function(data) {
		if(data["sn"] != "mi01_no_key"){
			$("#ekd_about_footer").html("identyfikator: " + data["sn"] + " <br/> ");
		}
		else{
			$("#ekd_about_footer").html("Niezdefiniowany numer seryjny" + " <br/> ");
		}
		if(data["version"] != null){
			$("#ekd_about_footer").html($("#ekd_about_footer").html() + "wer. " + data["version"]);
		}
		else{
			$("#ekd_about_footer").html($("#ekd_about_footer").html() + "Nieznana wersja oprogramowania");
		}
		if(data["desc"] != null){
			$("#ekd_about_message_title").text(data["desc"]);
		}
		else{
			$("#ekd_about_message_title").html("Error");
		}
    },
    error: function() {
		$("#ekd_about_footer").html("Niezdefiniowany numer seryjny" + " <br/> ");
		$("#ekd_about_footer").html($("#ekd_about_footer").html() + "Nieznana wersja oprogramowania");
		$("#ekd_about_message_title").html("Error");
	}
  });
}


</script>
<!-- /page about -->
<!-- page: #error -->
<div data-role="page" id="error" data-theme="a" data-close-btn="right">

  <div data-role="header">
    <h1><a onclick="showLoadingSpinner();" href="#about" style="color:inherit; text-decoration:none;" data-rel="dialog" data-transition="pop">błędy</a></h1>
  </div>

  <div role="main">
    <div class="ui-body">
      <ul data-role="listview" data-inset="true">
        <li class="ui-body">
          <table>
            <tr id="error_eeprom" style="display: none;"><td><font color="black">błąd pamięci EEPROM</font></td></tr>
            <tr id="error_t_in" style="display: none;"><td><font color="black">błąd czujnika temp. wejściowej</font></td></tr>
            <tr id="error_t_out" style="display: none;"><td><font color="black">błąd czujnika temp. wyjściowej</font></td></tr>
            <tr id="error_t_zas" style="display: none;"><td><font color="black">błąd czujnika temp. zasobnika</font></td></tr>
            <tr id="error_t_int" style="display: none;"><td><font color="black">błąd czujnika temp. wewnętrznej</font></td></tr>
            <tr id="error_t_zew" style="display: none;"><td><font color="black">błąd czujnika temperatury zewnętrznej</font></td></tr>
            <tr id="error_t_pok" style="display: none;"><td><font color="black">błąd czujnika temperatury pokojowej</font></td></tr>
            <tr id="error_low_bat" style="display: none;"><td><font color="black">niski poziom baterii</font></td></tr>
            <tr id="error_preasure" style="display: none;"><td><font color="black">błąd niskiego ciśnienia</font></td></tr>
            <tr id="error_pump_co" style="display: none;"><td><font color="black">błąd pompy co</font></td></tr>
            <tr id="error_valve_co" style="display: none;"><td><font color="black">błąd zaworu co</font></td></tr>
            <tr id="error_valve_cwu" style="display: none;"><td><font color="black">błąd zaworu cwu</font></td></tr>
			<tr id="error_unknown" style="display: none;"><td><font color="black">nieznany błąd</font></td></tr>
          </table>
        </li>
      </ul>
    </div>
  </div>

</div>
<script>$("#error").off("pagehide").on("pagehide",function(){
    if ($("#start").is(":visible"))
    {
        showLoadingSpinner();
    }
});

function getErrorInfo(errorCode){
	var errorCounter = 0;
	hideAllErrors();

	if (errorCode & 1){ //bit 0
		errorCounter++;
		$("#error_eeprom").show();
	}
	if (errorCode & 2){ //bit 1
		errorCounter++;
		$("#error_t_in").show();
	}
    if (errorCode & 4){ //bit 2
        errorCounter++;
        $("#error_t_out").show();
    }
	if (errorCode & 8){ //bit 3
		errorCounter++;
		$("#error_t_zas").show();
	}
	if (errorCode & 16){ //bit 4
		errorCounter++;
		$("#error_t_int").show();
	}
    if ((getBit((regToInt(getReg("0b55", "1")['0b55'])), 14)) == true){
        if (errorCode & 32){ //bit 5
            errorCounter++;
            $("#error_t_zew").show();
        }
    }
	if (errorCode & 64){ //bit 6
		errorCounter++;
		$("#error_t_pok").show();
	}
	if (errorCode & 128){ //bit 7
		errorCounter++;
		$("#error_low_bat").show();
	}
	if (errorCode & 256){ //bit 8
		errorCounter++;
		$("#error_preasure").show();
	}
	if (errorCode & 512){ //bit 9
		errorCounter++;
		$("#error_pump_co").show();
	}
	if (errorCode & 1024){ //bit 10
		errorCounter++;
		$("#error_valve_co").show();
	}
	if (errorCode & 2048){ //bit 11
		errorCounter++;
		$("#error_valve_cwu").show();
	}
	
	if (errorCounter == 0){
		$("#error_unknown").show();
	}
	
	hideLoadingSpinner();
}

function hideAllErrors(){
	$("#error_eeprom").hide();
	$("#error_t_in").hide();
	$("#error_t_out").hide();
	$("#error_t_zas").hide();
	$("#error_t_int").hide();
	$("#error_t_zew").hide();
	$("#error_t_pok").hide();
	$("#error_low_bat").hide();
	$("#error_preasure").hide();
	$("#error_pump_co").hide();
	$("#error_valve_co").hide();
	$("#error_valve_cwu").hide();
	$("#error_unknown").hide();
}
</script>
<!-- /page error -->



</body>
</html>

